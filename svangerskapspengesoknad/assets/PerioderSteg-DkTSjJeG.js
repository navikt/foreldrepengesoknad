import{j as o}from"./jsx-runtime-Cw0GR0a5.js";import{u as D,C as M,b as se,c as ie,a as q}from"./routes-Cd7jN6RC.js";import{c as u,T as X,i as J,j as oe,l as ae,q as ne,u as de,a as me,h as le,k as ge,m as fe}from"./useSvpNavigator-C5YMNV-6.js";import{d as pe,e as ce,c as C,a as ve,b as $,g as ue,u as Te,R as ye,E as Se,S as Me}from"./ErrorSummaryHookForm-CGcLQ_gz.js";import{e as R,q as he,f as d,k as Ee,I as Q,R as h,u as Y,V as A,O as je,a as z,B as U,K as De,M as v,d as _e,A as ke,H as Z,F as xe,c as Ie}from"./VeiviserPage-DFVY7kb3.js";import{g as Ae,b as H,a as Fe}from"./dateUtils-BGbHTzzn.js";import{r as ee,R as K}from"./index-CTjT7uj6.js";import{n as F,i as V,a as W,l as L,e as Re}from"./minMax-D8GIpsYl.js";import{B as be}from"./Bedriftsbanner-DXhRELG1.js";import{g as y}from"./numberUtils-DCxWcr3S.js";import{h as b,b as w}from"./validationUtils-C3FKos_c.js";import{R as Oe}from"./ReadMore-BTjxB3Iz.js";import{S as Ne}from"./Plus-verAfoen.js";var Ge=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(r[a[i]]=e[a[i]]);return r};const Ve=ee.forwardRef((e,t)=>{var{children:r,className:a,variant:i,size:m="medium",icon:l}=e,n=Ge(e,["children","className","variant","size","icon"]);return K.createElement(R,Object.assign({},n,{ref:t,as:"span",size:m==="medium"?"medium":"small",className:he("navds-tag",a,`navds-tag--${i}`,`navds-tag--${m}`)}),l&&K.createElement("span",{className:"navds-tag__icon--left"},l),r)}),Le=(e,t)=>d(e.fom).isBetween(t.fom,t.tom,"day","[]")||d(e.tom).isBetween(t.fom,t.tom,"day","[]")||d(t.fom).isBetween(e.fom,e.tom,"day","[]")||d(t.tom).isBetween(e.fom,e.tom,"day","[]"),we=(e,t,r)=>!!e&&b(t.fom)&&b(t.stillingsprosent)&&d(t.fom).isAfter(e.fom,"day")&&(r>0&&y(t.stillingsprosent)<r||r===0&&y(t.stillingsprosent)<100),Be=(e,t)=>e?e.find(r=>t>0?b(r.stillingsprosent)&&y(r.stillingsprosent)===t:b(r.stillingsprosent)&&y(r.stillingsprosent)===100):void 0,Pe=(e,t)=>e&&Ee(e)?e:t,qe=(e,t,r,a,i)=>{var l;const m=i&&i[e].tomType===u.SISTE_DAG_MED_SVP;if((l=i==null?void 0:i[e])!=null&&l.fom&&(m||i[e].tom)){const n=i[e].fom,s=i[e].tomType===u.SISTE_DAG_MED_SVP?t:d(i[e].tom).format(Q),g=d(s).diff(n,"days")+1,f=Math.floor(g/7),S=g-f*7;let T=h(s);return m&&(T=a?r.formatMessage({id:"PerioderStep.TreUkerFørTermin"}):r.formatMessage({id:"PerioderStep.Fødsel"})),`${h(n)} - ${T} (${r.formatMessage({id:"PerioderStep.tidsperiode"},{ukeAntall:f,dagAntall:S})})`}return r.formatMessage({id:"ny.periode"})},Ce=(e,t)=>{if(!t||t.length===0)return"";const r=t.filter(i=>i.tom||i.tomType===u.SISTE_DAG_MED_SVP).map(i=>i.tomType===u.SISTE_DAG_MED_SVP?d(e).add(1,"d"):d(i.tom)),a=r.length>0?d.max(r):void 0;return a?a.add(1,"d").format(Q):""},$e=(e,t)=>({fom:Ce(e,t),tom:"",stillingsprosent:"",tomType:void 0,type:X.DELVIS}),ze=(e,t)=>!t||t.trim()===""?e.formatMessage({id:"valideringsfeil.stillingsprosent.required"}):y(t)===void 0?e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreEtTall"}):void 0,Ue=(e,t,r,a,i)=>m=>{const l=ze(e,m);if(l)return l;const n=y(m);if(n&&i>0&&n>i)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLikOpprinneligStillingsprosent"},{prosent:i});if(n&&i===0&&n>100)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLik100Prosent"},{prosent:i});if(i>0&&(a!=null&&a.every(s=>s.stillingsprosent&&y(s.stillingsprosent)===i)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kunFullTilrettelegging"},{prosent:i});if(i===0&&(a!=null&&a.every(s=>s.stillingsprosent&&y(s.stillingsprosent)===100)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kun100Prosent"},{prosent:i});if(t&&r)return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.nySøknad"},{fom:h(r.fom)})},He=(e,t,r,a,i,m,l)=>n=>{const s=r&&r.length>0?r[t].tom:void 0,g=r&&r.length>0?r[t].tomType:void 0;if(n&&a&&d(n).isBefore(d(a),"d"))return e.formatMessage({id:"valideringsfeil.periode.fom.førBehovForTilretteleggingFom"});if(l&&d(n).isAfter(d(l),"d")){const S=w(l,e);return e.formatMessage({id:"valideringsfeil.periode.fom.etterSluttDatoArbeid"},{dato:h(l),navn:m,slutteTekst:S})}const f=Xe(n,s,g,r,t,e,i);return f||Je(n,r,i,e)},Ke=(e,t,r)=>a=>{if(r&&d(a).isAfter(d(r),"d")){const i=w(r,e);return e.formatMessage({id:"valideringsfeil.periode.tom.etterSluttDatoArbeid"},{dato:h(r),navn:t,slutteTekst:i})}},We=(e,t,r,a)=>i=>{if(a&&i===u.SISTE_DAG_MED_SVP&&d(t).isAfter(d(a),"d")){const m=w(a,e);return e.formatMessage({id:"valideringsfeil.periode.tomType.etterSluttDatoArbeid"},{navn:r,slutteTekst:m})}},Xe=(e,t,r,a,i,m,l)=>{if((t||r)&&e&&a&&a.length>0){const s=a.filter((g,f)=>f>i).filter(g=>{let f;return g.tomType&&g.tomType===u.SISTE_DAG_MED_SVP&&(f=l),g.tom&&(f=g.tom),f?Le({fom:e,tom:t||l},{fom:g.fom,tom:f}):!1});if(s.length>0){const g=s[0].tom?s[0].tom:l;return m.formatMessage({id:"valideringsfeil.periode.overlapper"},{fom:h(s[0].fom),tom:h(g)})}}},Je=(e,t,r,a)=>{const i=t?t.filter(s=>s.fom).map(s=>d(s.fom)):void 0,m=i?d.min(i):void 0;if(m&&d(e).isSameOrBefore(m,"day"))return;const l=t?t.filter(s=>s.tom||s.tomType===u.SISTE_DAG_MED_SVP).map(s=>s.tomType===u.SISTE_DAG_MED_SVP?d(r):d(s.tom)):void 0;if(!(l?l.find(s=>d(e).subtract(1,"d").isSame(d(s),"day")):void 0))return a.formatMessage({id:"valideringsfeil.periode.ikkeSammenhengende"})},Qe={type:X.DELVIS,fom:"",tom:"",stillingsprosent:"",tomType:void 0},te=({barn:e,valgtTilretteleggingId:t,kanHaSVPFremTilTreUkerFørTermin:r,behovForTilretteleggingFom:a,arbeidsforhold:i,egenNæring:m,frilans:l})=>{const n=xe("perioderStep"),s=Y(),g=Ae(e),f=J(s,t,i),S=oe(e.termindato,t,i,m,l),T=ae(e.termindato,t,i,m,l),E=pe(),{fields:O,append:k,remove:N}=ce({name:"varierendePerioder",control:E.control}),p=E.watch("varierendePerioder"),j=T.tom?F(d.min(d(g),d(T.tom))):g,_=ne(p,S),x=Be(p,_),G=$e(g,p);return o.jsx(o.Fragment,{children:O.map((I,c)=>{const B=we(x,p[c],_),P=Pe(p[c].fom,a),re=H(P,j);return o.jsxs(ee.Fragment,{children:[o.jsxs(A,{gap:"1",children:[o.jsx(je,{}),o.jsxs(z,{justify:"space-between",align:"center",children:[o.jsx(Ve,{variant:"info-moderate",className:n.element("tag"),children:qe(c,g,s,r,p)}),c!==0&&o.jsx(U,{icon:o.jsx(De,{"aria-hidden":!0}),type:"button",variant:"tertiary",onClick:()=>N(c),children:o.jsx(v,{id:"perioder.varierende.slett"})})]})]}),o.jsx(C,{name:`varierendePerioder.${c}.fom`,label:s.formatMessage({id:"perioder.varierende.fom.label"}),minDate:a,maxDate:j,validate:[V(s.formatMessage({id:"valideringsfeil.periode.fom.påkrevd"})),W(s.formatMessage({id:"valideringsfeil.periode.fom.gyldigDato"})),L(s.formatMessage({id:"valideringsfeil.periode.fom.førTilDato"}),p[c].tom),L(r?s.formatMessage({id:"valideringsfeil.periode.fom.etterTreUkerFørTermin"}):s.formatMessage({id:"valideringsfeil.periode.fom.etterFødsel"}),g),He(s,c,p,a,g,f||"",T.tom)],defaultMonth:H(a,j)}),o.jsxs(ve,{name:`varierendePerioder.${c}.tomType`,label:o.jsx(v,{id:"perioder.varierende.tomType.label"}),validate:[V(r?s.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.termin"}):s.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.fødsel"})),We(s,g,f||"",T.tom)],children:[o.jsx($,{value:u.VALGFRI_DATO,children:o.jsx(v,{id:"perioder.varierende.tomType.valgfriDato"})}),o.jsx($,{value:u.SISTE_DAG_MED_SVP,children:r?o.jsx(v,{id:"perioder.varierende.tomType.treUkerFørTermin"}):o.jsx(v,{id:"perioder.varierende.tomType.dagenFørFødsel"})})]}),p[c].tomType===u.VALGFRI_DATO&&o.jsx(C,{name:`varierendePerioder.${c}.tom`,label:s.formatMessage({id:"perioder.varierende.tom.label"}),validate:[V(s.formatMessage({id:"valideringsfeil.periode.tom.påkrevd"})),W(s.formatMessage({id:"valideringsfeil.periode.tom.gyldigDato"})),Re(s.formatMessage({id:"valideringsfeil.periode.tom.etterTilDato"}),p[c].fom),L(r?s.formatMessage({id:"valideringsfeil.periode.tom.etterTreUkerFørTermin"}):s.formatMessage({id:"valideringsfeil.periode.tom.etterFødsel"}),g),Ke(s,f||"",T.tom)],minDate:P,maxDate:j,defaultMonth:re}),o.jsxs("div",{children:[o.jsx(ue,{name:`varierendePerioder.${c}.stillingsprosent`,label:s.formatMessage({id:"perioder.varierende.stillingsprosent.label"}),className:n.element("stillingsprosent"),description:s.formatMessage({id:"tilrettelegging.tilrettelagtArbeidType.description"}),validate:[Ue(s,B,x,p,_)]}),o.jsx(Oe,{onOpenChange:_e("Svangerskapspenger","Ikke_har_100%_stilling"),size:"medium",header:s.formatMessage({id:"tilrettelegging.varierendePerioderStillingsprosent.info.tittel"}),children:o.jsxs(A,{gap:"2",children:[o.jsx(R,{children:o.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del1"})}),o.jsx(R,{children:o.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del2"})})]})})]}),B&&o.jsx(ke,{variant:"warning",children:o.jsxs(A,{gap:"4",children:[o.jsx(Z,{size:"small",children:o.jsx(v,{id:"perioder.alert.nySøknad.title"})}),o.jsx("div",{children:o.jsx(v,{id:"perioder.alert.nySøknad.del1"})}),o.jsx(v,{id:"perioder.alert.nySøknad.del2"})]})}),p&&c===p.length-1&&o.jsx(z,{children:o.jsx(U,{icon:o.jsx(Ne,{"aria-hidden":!0}),type:"button",variant:"secondary",onClick:()=>k(G),children:o.jsx(v,{id:"perioder.varierende.leggTil"})})})]},I.id)})})};te.__docgenInfo={description:"",methods:[],displayName:"PerioderFieldArray"};const Ye=({mellomlagreSøknadOgNaviger:e,avbrytSøknad:t,arbeidsforhold:r})=>{const a=Y(),i=de(r),m=me(e,r),l=le(),n=F(l.tilretteleggingId),s=D(M.TILRETTELEGGINGER_PERIODER),g=F(D(M.TILRETTELEGGINGER)),f=F(D(M.OM_BARNET)),S=D(M.EGEN_NÆRING),T=D(M.FRILANS),E=D(M.VALGTE_ARBEIDSFORHOLD),O=se(M.TILRETTELEGGINGER_PERIODER),k=Fe(f),N=ge(n,r),p=J(a,n,r),j=g[n],_=G=>{O({...s,[n]:G.varierendePerioder});const I=fe(n,E);return m.goToStep(I?ie(q.SKJEMA,I):q.OPPSUMMERING)},x=Te({shouldUnregister:!0,defaultValues:{varierendePerioder:(s==null?void 0:s[n])??[Qe]}});return o.jsx(Ie,{bannerTitle:a.formatMessage({id:"søknad.pageheading"}),onCancel:t,steps:i,onContinueLater:m.fortsettSøknadSenere,onStepChange:m.goToStep,children:o.jsx(ye,{formMethods:x,onSubmit:_,children:o.jsxs(A,{gap:"10",children:[o.jsx(Se,{}),!!E&&E.length>1&&o.jsx(be,{arbeidsforholdType:N,arbeidsforholdNavn:p}),o.jsxs("div",{children:[o.jsx(Z,{size:"small",children:o.jsx(v,{id:"perioder.varierende.heading"})}),o.jsx(R,{children:k?o.jsx(v,{id:"perioder.varierende.description.termin"}):o.jsx(v,{id:"perioder.varierende.description.fødsel"})})]}),o.jsx(te,{valgtTilretteleggingId:n,barn:f,kanHaSVPFremTilTreUkerFørTermin:k,arbeidsforhold:r,egenNæring:S,frilans:T,behovForTilretteleggingFom:j.behovForTilretteleggingFom}),o.jsx(Me,{goToPreviousStep:m.goToPreviousDefaultStep})]})})})};Ye.__docgenInfo={description:"",methods:[],displayName:"PerioderSteg",props:{mellomlagreSøknadOgNaviger:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},avbrytSøknad:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},arbeidsforhold:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    arbeidsgiverNavn: string;
    arbeidsgiverId: string;
    arbeidsgiverIdType: string;
    fom: string;
    tom?: string;
    stillingsprosent: number;
}`,signature:{properties:[{key:"arbeidsgiverNavn",value:{name:"string",required:!0}},{key:"arbeidsgiverId",value:{name:"string",required:!0}},{key:"arbeidsgiverIdType",value:{name:"string",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!1}},{key:"stillingsprosent",value:{name:"number",required:!0}}]}}],raw:"Arbeidsforhold[]"},description:""}}};export{Ye as P};
