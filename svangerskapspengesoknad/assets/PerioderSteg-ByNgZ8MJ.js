import{G as d,aJ as te,aQ as W,aU as E,f as Y,a9 as ie,aa as se,e as x,j as i,r as ne,Z as A,ar as ae,a6 as P,a7 as C,$ as v,ae as oe,ai as $,ad as R,ak as U,aM as G,an as de,ao as z,aG as ge,af as le,aD as me,l as pe,a1 as V,a4 as ue,_ as J,as as fe,au as ve,av as ce,aw as ye,ax as Te,ay as ke}from"./iframe-BSp1CvC8.js";import{e as M,C as S,d as Se,f as H,S as L}from"./routes-CXQ4cg5P.js";import{i as Q,T as y,l as X,a as Ee,o as he,p as Me,d as je,e as De,j as be,g as Ie,k as xe}from"./useSvpNavigator-ChfwGIwN.js";import{g as Ae,b as K,a as Fe}from"./dateUtils-0WTq_E6P.js";import{B as _e}from"./Bedriftsbanner-BiNfp86U.js";import{g as T}from"./numberUtils-DCxWcr3S.js";import{h as F,a as B}from"./validationUtils-Df8YZX1H.js";import{T as qe}from"./Tag-C6-vFPDq.js";const Ne=(e,r)=>d(e.fom).isBetween(r.fom,r.tom,"day","[]")||d(e.tom).isBetween(r.fom,r.tom,"day","[]")||d(r.fom).isBetween(e.fom,e.tom,"day","[]")||d(r.tom).isBetween(e.fom,e.tom,"day","[]"),Re=(e,r,t)=>!!e&&F(r.fom)&&F(r.stillingsprosent)&&d(r.fom).isAfter(e.fom,"day")&&(t>0&&T(r.stillingsprosent)<t||t===0&&T(r.stillingsprosent)<100),Ge=(e,r)=>e?e.find(t=>r>0?F(t.stillingsprosent)&&T(t.stillingsprosent)===r:F(t.stillingsprosent)&&T(t.stillingsprosent)===100):void 0,Le=(e,r)=>e&&te(e)?e:r,Ve=(e,r,t,o,n)=>{var l;const g=n&&n[e].tomType===y.SISTE_DAG_MED_SVP;if((l=n==null?void 0:n[e])!=null&&l.fom&&(g||n[e].tom)){const s=n[e].fom,a=n[e].tomType===y.SISTE_DAG_MED_SVP?r:d(n[e].tom).format(W),m=d(a).diff(s,"days")+1,p=Math.floor(m/7),c=m-p*7;let k=E(a);return g&&(k=o?t.formatMessage({id:"PerioderStep.TreUkerFørTermin"}):t.formatMessage({id:"PerioderStep.Fødsel"})),`${E(s)} - ${k} (${t.formatMessage({id:"PerioderStep.tidsperiode"},{ukeAntall:p,dagAntall:c})})`}return t.formatMessage({id:"ny.periode"})},Be=(e,r)=>{if(!r||r.length===0)return"";const t=r.filter(n=>n.tom||n.tomType===y.SISTE_DAG_MED_SVP).map(n=>n.tomType===y.SISTE_DAG_MED_SVP?d(e).add(1,"d"):d(n.tom)),o=t.length>0?d.max(t):void 0;return o?o.add(1,"d").format(W):""},Oe=(e,r)=>({fom:Be(e,r),tom:"",stillingsprosent:"",tomType:void 0,type:Q.DELVIS}),we=(e,r)=>!r||r.trim()===""?e.formatMessage({id:"valideringsfeil.stillingsprosent.required"}):T(r)===void 0?e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreEtTall"}):void 0,Pe=(e,r,t,o,n)=>g=>{const l=we(e,g);if(l)return l;const s=T(g);if(s&&n>0&&s>n)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLikOpprinneligStillingsprosent"},{prosent:n});if(s&&n===0&&s>100)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLik100Prosent"},{prosent:n});if(n>0&&(o!=null&&o.every(a=>a.stillingsprosent&&T(a.stillingsprosent)===n)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kunFullTilrettelegging"},{prosent:n});if(n===0&&(o!=null&&o.every(a=>a.stillingsprosent&&T(a.stillingsprosent)===100)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kun100Prosent"},{prosent:n});if(r&&t)return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.nySøknad"},{fom:E(t.fom)})},Ce=(e,r,t,o,n,g,l)=>s=>{const a=t&&t.length>0?t[r].tom:void 0,m=t&&t.length>0?t[r].tomType:void 0;if(s&&o&&d(s).isBefore(d(o),"d"))return e.formatMessage({id:"valideringsfeil.periode.fom.førBehovForTilretteleggingFom"});if(l&&d(s).isAfter(d(l),"d")){const c=B(l,e);return e.formatMessage({id:"valideringsfeil.periode.fom.etterSluttDatoArbeid"},{dato:E(l),navn:g,slutteTekst:c})}const p=ze(s,a,m,t,r,e,n);return p||He(s,t,n,e)},$e=(e,r,t)=>o=>{if(t&&d(o).isAfter(d(t),"d")){const n=B(t,e);return e.formatMessage({id:"valideringsfeil.periode.tom.etterSluttDatoArbeid"},{dato:E(t),navn:r,slutteTekst:n})}},Ue=(e,r,t,o)=>n=>{if(o&&n===y.SISTE_DAG_MED_SVP&&d(r).isAfter(d(o),"d")){const g=B(o,e);return e.formatMessage({id:"valideringsfeil.periode.tomType.etterSluttDatoArbeid"},{navn:t,slutteTekst:g})}},ze=(e,r,t,o,n,g,l)=>{if((r||t)&&e&&o&&o.length>0){const a=o.filter((m,p)=>p>n).filter(m=>{let p;return m.tomType&&m.tomType===y.SISTE_DAG_MED_SVP&&(p=l),m.tom&&(p=m.tom),p?Ne({fom:e,tom:r||l},{fom:m.fom,tom:p}):!1});if(a.length>0){const m=a[0].tom?a[0].tom:l;return g.formatMessage({id:"valideringsfeil.periode.overlapper"},{fom:E(a[0].fom),tom:E(m)})}}},He=(e,r,t,o)=>{const n=r?r.filter(a=>a.fom).map(a=>d(a.fom)):void 0,g=n?d.min(n):void 0;if(g&&d(e).isSameOrBefore(g,"day"))return;const l=r?r.filter(a=>a.tom||a.tomType===y.SISTE_DAG_MED_SVP).map(a=>a.tomType===y.SISTE_DAG_MED_SVP?d(t):d(a.tom)):void 0;if(!(l?l.find(a=>d(e).subtract(1,"d").isSame(d(a),"day")):void 0))return o.formatMessage({id:"valideringsfeil.periode.ikkeSammenhengende"})},Ke={type:Q.DELVIS,fom:"",tom:"",stillingsprosent:"",tomType:void 0},Z=({barn:e,valgtTilretteleggingId:r,kanHaSVPFremTilTreUkerFørTermin:t,behovForTilretteleggingFom:o,arbeidsforhold:n,egenNæring:g,frilans:l})=>{const s=Y(),a=Ae(e),m=X(s,r,n),p=Ee(e.termindato,r,n,g,l),c=he(e.termindato,r,n,g,l),k=ie(),{fields:j,append:_,remove:b}=se({name:"varierendePerioder",control:k.control}),u=k.watch("varierendePerioder"),h=c.tom?x(d.min(d(a),d(c.tom))):a,D=Me(u,p),I=Ge(u,D),q=Oe(a,u);return i.jsx(i.Fragment,{children:j.map((N,f)=>{const O=Re(I,u[f],D),w=Le(u[f].fom,o),ee=K(w,h);return i.jsxs(ne.Fragment,{children:[i.jsxs(A,{gap:"1",children:[i.jsx(ae,{}),i.jsxs(P,{justify:"space-between",align:"center",children:[i.jsx(qe,{variant:"info-moderate",children:Ve(f,a,s,t,u)}),f!==0&&i.jsx(C,{icon:i.jsx(oe,{"aria-hidden":!0}),type:"button",variant:"tertiary",onClick:()=>b(f),children:i.jsx(v,{id:"perioder.varierende.slett"})})]})]}),i.jsx($,{name:`varierendePerioder.${f}.fom`,label:s.formatMessage({id:"perioder.varierende.fom.label"}),minDate:o,maxDate:h,validate:[R(s.formatMessage({id:"valideringsfeil.periode.fom.påkrevd"})),U(s.formatMessage({id:"valideringsfeil.periode.fom.gyldigDato"})),G(s.formatMessage({id:"valideringsfeil.periode.fom.førTilDato"}),u[f].tom),G(t?s.formatMessage({id:"valideringsfeil.periode.fom.etterTreUkerFørTermin"}):s.formatMessage({id:"valideringsfeil.periode.fom.etterFødsel"}),a),Ce(s,f,u,o,a,m||"",c.tom)],defaultMonth:K(o,h)}),i.jsxs(de,{name:`varierendePerioder.${f}.tomType`,label:i.jsx(v,{id:"perioder.varierende.tomType.label"}),validate:[R(t?s.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.termin"}):s.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.fødsel"})),Ue(s,a,m||"",c.tom)],children:[i.jsx(z,{value:y.VALGFRI_DATO,children:i.jsx(v,{id:"perioder.varierende.tomType.valgfriDato"})}),i.jsx(z,{value:y.SISTE_DAG_MED_SVP,children:t?i.jsx(v,{id:"perioder.varierende.tomType.treUkerFørTermin"}):i.jsx(v,{id:"perioder.varierende.tomType.dagenFørFødsel"})})]}),u[f].tomType===y.VALGFRI_DATO&&i.jsx($,{name:`varierendePerioder.${f}.tom`,label:s.formatMessage({id:"perioder.varierende.tom.label"}),validate:[R(s.formatMessage({id:"valideringsfeil.periode.tom.påkrevd"})),U(s.formatMessage({id:"valideringsfeil.periode.tom.gyldigDato"})),ge(s.formatMessage({id:"valideringsfeil.periode.tom.etterTilDato"}),u[f].fom),G(t?s.formatMessage({id:"valideringsfeil.periode.tom.etterTreUkerFørTermin"}):s.formatMessage({id:"valideringsfeil.periode.tom.etterFødsel"}),a),$e(s,m||"",c.tom)],minDate:w,maxDate:h,defaultMonth:ee}),i.jsxs("div",{children:[i.jsx(le,{name:`varierendePerioder.${f}.stillingsprosent`,label:s.formatMessage({id:"perioder.varierende.stillingsprosent.label"}),style:{maxWidth:"450px"},description:s.formatMessage({id:"tilrettelegging.tilrettelagtArbeidType.description"}),validate:[Pe(s,O,I,u,D)]}),i.jsx(me,{onOpenChange:re=>pe({origin:"svangerskapspengesoknad",eventName:re?"readmore åpnet":"readmore lukket",eventData:{tittel:"tilrettelegging.varierendePerioderStillingsprosent.info.tittel"}}),size:"medium",header:s.formatMessage({id:"tilrettelegging.varierendePerioderStillingsprosent.info.tittel"}),children:i.jsxs(A,{gap:"2",children:[i.jsx(V,{children:i.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del1"})}),i.jsx(V,{children:i.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del2"})})]})})]}),O&&i.jsx(ue,{variant:"warning",children:i.jsxs(A,{gap:"4",children:[i.jsx(J,{size:"small",children:i.jsx(v,{id:"perioder.alert.nySøknad.title"})}),i.jsx("div",{children:i.jsx(v,{id:"perioder.alert.nySøknad.del1"})}),i.jsx(v,{id:"perioder.alert.nySøknad.del2"})]})}),u&&f===u.length-1&&i.jsx(P,{children:i.jsx(C,{icon:i.jsx(fe,{"aria-hidden":!0}),type:"button",variant:"secondary",onClick:()=>_(q),children:i.jsx(v,{id:"perioder.varierende.leggTil"})})})]},N.id)})})};Z.__docgenInfo={description:"",methods:[],displayName:"PerioderFieldArray",props:{barn:{required:!0,tsType:{name:"Barn"},description:""},valgtTilretteleggingId:{required:!0,tsType:{name:"string"},description:""},kanHaSVPFremTilTreUkerFørTermin:{required:!0,tsType:{name:"boolean"},description:""},behovForTilretteleggingFom:{required:!0,tsType:{name:"string"},description:""},arbeidsforhold:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    arbeidsgiverId: string;
    arbeidsgiverIdType: string;
    arbeidsgiverNavn: string;
    stillingsprosent: number;
    fom: string;
    tom?: string;
}`,signature:{properties:[{key:"arbeidsgiverId",value:{name:"string",required:!0}},{key:"arbeidsgiverIdType",value:{name:"string",required:!0}},{key:"arbeidsgiverNavn",value:{name:"string",required:!0}},{key:"stillingsprosent",value:{name:"number",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!1}}]}}],raw:"Arbeidsforhold[]"},description:""},egenNæring:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    næringstype: Næringstype;
    fom: string;
    tom: string;
    næringsinntekt?: number;
    pågående: boolean; // Brukes ikke backend
    navnPåNæringen?: string;
    organisasjonsnummer?: string;
    registrertINorge: boolean;
    registrertILand?: string;
    harBlittYrkesaktivILøpetAvDeTreSisteFerdigliknedeÅrene?: boolean;
    oppstartsdato?: string;
    hattVarigEndringAvNæringsinntektSiste4Kalenderår?: boolean;
    varigEndringDato?: string;
    varigEndringInntektEtterEndring?: string;
    varigEndringBeskrivelse?: string;
}`,signature:{properties:[{key:"næringstype",value:{name:"Næringstype",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!0}},{key:"næringsinntekt",value:{name:"number",required:!1}},{key:"pågående",value:{name:"boolean",required:!0}},{key:"navnPåNæringen",value:{name:"string",required:!1}},{key:"organisasjonsnummer",value:{name:"string",required:!1}},{key:"registrertINorge",value:{name:"boolean",required:!0}},{key:"registrertILand",value:{name:"string",required:!1}},{key:"harBlittYrkesaktivILøpetAvDeTreSisteFerdigliknedeÅrene",value:{name:"boolean",required:!1}},{key:"oppstartsdato",value:{name:"string",required:!1}},{key:"hattVarigEndringAvNæringsinntektSiste4Kalenderår",value:{name:"boolean",required:!1}},{key:"varigEndringDato",value:{name:"string",required:!1}},{key:"varigEndringInntektEtterEndring",value:{name:"string",required:!1}},{key:"varigEndringBeskrivelse",value:{name:"string",required:!1}}]}},description:""},frilans:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    jobberFremdelesSomFrilans: boolean;
    oppstart: string;
}`,signature:{properties:[{key:"jobberFremdelesSomFrilans",value:{name:"boolean",required:!0}},{key:"oppstart",value:{name:"string",required:!0}}]}},description:""}}};const We=({mellomlagreSøknadOgNaviger:e,avbrytSøknad:r,arbeidsforhold:t})=>{const o=Y(),n=je(t),g=De(e,t),l=be(),s=x(l.tilretteleggingId),a=M(S.TILRETTELEGGINGER_PERIODER),m=x(M(S.TILRETTELEGGINGER)),p=x(M(S.OM_BARNET)),c=M(S.EGEN_NÆRING),k=M(S.FRILANS),j=M(S.VALGTE_ARBEIDSFORHOLD),_=Se(S.TILRETTELEGGINGER_PERIODER),b=Fe(p),u=Ie(s,t),h=X(o,s,t),D=m[s],I=N=>{if(_({...a,[s]:N.varierendePerioder}),u==="virksomhet"||u==="privat")return g.goToStep(H(L.FERIE,s));const f=xe(s,j);return g.goToStep(f?H(L.SKJEMA,f):L.OPPSUMMERING)},q=ve({shouldUnregister:!0,defaultValues:{varierendePerioder:(a==null?void 0:a[s])??[Ke]}});return i.jsx(ce,{bannerTitle:o.formatMessage({id:"søknad.pageheading"}),onCancel:r,steps:n,onContinueLater:g.fortsettSøknadSenere,onStepChange:g.goToStep,children:i.jsx(ye,{formMethods:q,onSubmit:I,children:i.jsxs(A,{gap:"10",children:[i.jsx(Te,{}),!!j&&j.length>1&&i.jsx(_e,{arbeidsforholdType:u,arbeidsforholdNavn:h}),i.jsxs("div",{children:[i.jsx(J,{size:"small",children:i.jsx(v,{id:"perioder.varierende.heading"})}),i.jsx(V,{children:b?i.jsx(v,{id:"perioder.varierende.description.termin"}):i.jsx(v,{id:"perioder.varierende.description.fødsel"})})]}),i.jsx(Z,{valgtTilretteleggingId:s,barn:p,kanHaSVPFremTilTreUkerFørTermin:b,arbeidsforhold:t,egenNæring:c,frilans:k,behovForTilretteleggingFom:D.behovForTilretteleggingFom}),i.jsx(ke,{goToPreviousStep:g.goToPreviousDefaultStep})]})})})};We.__docgenInfo={description:"",methods:[],displayName:"PerioderSteg",props:{mellomlagreSøknadOgNaviger:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},avbrytSøknad:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},arbeidsforhold:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    arbeidsgiverId: string;
    arbeidsgiverIdType: string;
    arbeidsgiverNavn: string;
    stillingsprosent: number;
    fom: string;
    tom?: string;
}`,signature:{properties:[{key:"arbeidsgiverId",value:{name:"string",required:!0}},{key:"arbeidsgiverIdType",value:{name:"string",required:!0}},{key:"arbeidsgiverNavn",value:{name:"string",required:!0}},{key:"stillingsprosent",value:{name:"number",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!1}}]}}],raw:"Arbeidsforhold[]"},description:""}}};export{We as P};
