import{u as P,j as a,a as I,X as Y}from"./Modal-5f6515f6.js";import{o as w,Y as O,i as l,c as j,l as G,p as f,d as U,q as $,v as q,S as J,F as V,B as o,n as W,b as z,h as Q,r as X}from"./fridagerUtils-89ecc5b6.js";import{r as H}from"./index-f1f2c4b1.js";import"./_baseToString-375081cd.js";import"./_createSet-53ab95fd.js";import{Q as K,R as Z,g as s,S as ee,u as te,U as ae,V as re,f as ne,W as de}from"./useFortsettSøknadSenere-905f921d.js";import{f as ie}from"./dateUtils-a13b77b7.js";import{H as le}from"./HorizontalLine-831b0129.js";import{u as b,C as u,a as v}from"./routes-345f7acb.js";import{n as N}from"./validation-631bcf6e.js";import{B as se}from"./BackButton-f80f5ffe.js";import{P as oe}from"./Plus-b48ff6db.js";var B=(e=>(e.JOBB_I_UTLANDET="JOBB_I_UTLANDET",e))(B||{}),A=(e=>(e.arbeidIUtlandet="arbeidIUtlandet",e))(A||{});const p=w(),h=()=>({fom:"",tom:"",pågående:void 0,arbeidsgiverNavn:"",land:""}),pe={[A.arbeidIUtlandet]:[h()]},me=e=>e.arbeidIUtlandet.map(t=>({type:B.JOBB_I_UTLANDET,tidsperiode:{fom:t.fom,tom:t.tom},pågående:!!Z(t.pågående),arbeidsgiverNavn:t.arbeidsgiverNavn,land:t.land})),ge=e=>e===void 0||e.length===0?pe:{arbeidIUtlandet:e.map(t=>({fom:t.tidsperiode.fom,tom:t.tidsperiode.tom,pågående:K(t.pågående),arbeidsgiverNavn:t.arbeidsgiverNavn,land:t.land}))},ue=e=>({arbeidIUtlandet:e.arbeidIUtlandet.map(m=>({...m,tom:m.pågående===O.NO?m.tom:h().tom}))}),ce=(e,n)=>t=>{if(!s(t))return l(e,"valideringsfeil.fraOgMedDato.påkrevd");if(s(t)&&!j(t))return l(e,"valideringsfeil.fraOgMedDato.gyldigDato");if(s(t)&&G(t))return l(e,"valideringsfeil.fraOgMedDato.erIFremtiden");if(s(t)&&n&&f(n,t))return l(e,"valideringsfeil.fraOgMedDato.førTilDato")},Ie=(e,n)=>t=>{if(!s(t))return l(e,"valideringsfeil.tilOgMedDato.påkrevd");if(!j(t))return l(e,"valideringsfeil.tilOgMedDato.gyldigDato");if(ee(t,U().add(9,"month")))return l(e,"valideringsfeil.tilOgMedDato.erIFremtiden");if(f(t,$(ie())))return l(e,"valideringsfeil.tilOgMedDato.arbeidIUtlandet.merEnn5MånederSiden");if(n&&f(t,n))return l(e,"valideringsfeil.tilOgMedDato.etterFraDato")},be=e=>n=>{if(!s(n))return l(e,"valideringsfeil.arbeidIUtlandetPågående.påkrevd")},ve=e=>n=>{if(!s(n))return l(e,"valideringsfeil.arbeidIUtlandetLand.påkrevd")},fe=(e,n)=>t=>s(t)?t.length>100?l(e,"valideringsfeil.arbeidIUtlandetNavn.forLang"):q(t,n,e):l(e,"valideringsfeil.arbeidIUtlandetNavn.påkrevd");const T=({mellomlagreSøknadOgNaviger:e,avbrytSøknad:n,arbeidsforhold:t})=>{const m=Q("arbeidIUtlandet"),r=P(),y=ne(),M=te(r,t),[D,F]=H.useState(!1),k=b(u.ARBEID_I_UTLANDET),_=N(b(u.OM_BARNET)),x=N(b(u.INNTEKTSINFORMASJON)),E=v(u.ARBEID_I_UTLANDET),L=v(u.VALGT_TILRETTELEGGING_ID),C=v(u.APP_ROUTE),R=d=>{F(!0);const c=me(d);E(c);const{nextRoute:g,nextTilretteleggingId:S}=de(_.termindato,t,x);L(S),C(g),e()};return a.jsx(p.FormikWrapper,{enableReinitialize:!0,initialValues:ge(k),onSubmit:R,renderForm:({values:d})=>{const c=r.formatMessage({id:"arbeidIUtlandet.navn"});return a.jsx(J,{bannerTitle:r.formatMessage({id:"søknad.pageheading"}),activeStepId:"arbeidIUtlandet",pageTitle:r.formatMessage({id:"steps.label.arbeidIUtlandet"}),onCancel:n,steps:M,onContinueLater:y,children:a.jsxs(p.Form,{includeButtons:!1,includeValidationSummary:!0,cleanup:g=>ue(g),children:[a.jsx(V,{validateOnChange:!1,name:A.arbeidIUtlandet,render:g=>d.arbeidIUtlandet&&d.arbeidIUtlandet.length>0&&d.arbeidIUtlandet.map((S,i)=>a.jsxs("div",{children:[a.jsxs(o,{padBottom:"xxl",className:m.element("countrySelect"),children:[a.jsx(p.CountrySelect,{name:`arbeidIUtlandet.${i}.land`,style:{width:"var(--app-text-input-width)"},label:r.formatMessage({id:"arbeidIUtlandet.land"}),useAlpha3Code:!1,validate:ve(r)}),i!==0&&a.jsx(I,{className:m.element("delete"),icon:a.jsx(Y,{"aria-hidden":!0}),type:"button",variant:"tertiary",onClick:()=>g.remove(i),children:r.formatMessage({id:"perioder.varierende.slett"})})]}),a.jsx(o,{padBottom:"xxl",children:a.jsx(p.TextField,{name:`arbeidIUtlandet.${i}.arbeidsgiverNavn`,style:{width:"var(--app-text-input-width)"},label:c,validate:fe(r,c),maxLength:100})}),a.jsx(o,{padBottom:"xxl",children:a.jsx(p.DatePicker,{name:`arbeidIUtlandet.${i}.fom`,label:r.formatMessage({id:"arbeidIUtlandet.fom"}),placeholder:"dd.mm.åååå",fullscreenOverlay:!0,showYearSelector:!0,validate:ce(r,d.arbeidIUtlandet[i].tom),maxDate:U().toDate(),minDate:W})}),a.jsx(o,{padBottom:"xxl",children:a.jsx(p.YesOrNoQuestion,{name:`arbeidIUtlandet.${i}.pågående`,legend:r.formatMessage({id:"egenNæring.næring.pågående"}),validate:be(r)})}),a.jsx(o,{padBottom:"xxl",visible:d.arbeidIUtlandet[i].pågående===O.NO,children:a.jsx(p.DatePicker,{name:`arbeidIUtlandet.${i}.tom`,label:r.formatMessage({id:"arbeidIUtlandet.tom"}),description:r.formatMessage({id:"egenNæring.arbeid.tom.description"}),placeholder:"dd.mm.åååå",fullscreenOverlay:!0,showYearSelector:!0,validate:Ie(r,d.arbeidIUtlandet[i].fom),maxDate:U().add(9,"month").toDate(),minDate:ae(d.arbeidIUtlandet[i].fom,X)})}),d.arbeidIUtlandet&&d.arbeidIUtlandet.length>1&&a.jsx(le,{}),d.arbeidIUtlandet&&i===d.arbeidIUtlandet.length-1&&a.jsx(o,{padBottom:"xl",children:a.jsx(I,{icon:a.jsx(oe,{"aria-hidden":!0}),type:"button",variant:"secondary",onClick:()=>g.push(h()),children:r.formatMessage({id:"arbeidIUtlandet.tittel.ny"})})})]},i))}),a.jsx(o,{padBottom:"l",children:a.jsxs(z,{children:[a.jsx(se,{mellomlagreSøknadOgNaviger:e,route:re(x)}),a.jsx(I,{type:"submit",disabled:D,loading:D,children:r.formatMessage({id:"søknad.gåVidere"})})]})})]})})}})};try{T.displayName="ArbeidIUtlandetStep",T.__docgenInfo={description:"",displayName:"ArbeidIUtlandetStep",props:{mellomlagreSøknadOgNaviger:{defaultValue:null,description:"",name:"mellomlagreSøknadOgNaviger",required:!0,type:{name:"() => Promise<void>"}},avbrytSøknad:{defaultValue:null,description:"",name:"avbrytSøknad",required:!0,type:{name:"() => Promise<void>"}},arbeidsforhold:{defaultValue:null,description:"",name:"arbeidsforhold",required:!0,type:{name:"Arbeidsforhold[]"}}}}}catch{}export{T as A,B as a};
