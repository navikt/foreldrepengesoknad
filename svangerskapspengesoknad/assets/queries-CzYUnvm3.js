class w extends Error{response;request;options;constructor(t,e,s){const o=t.status||t.status===0?t.status:"",n=t.statusText||"",i=`${o} ${n}`.trim(),a=i?`status code ${i}`:"an unknown error";super(`Request failed with ${a}: ${e.method} ${e.url}`),this.name="HTTPError",this.response=t,this.request=e,this.options=s}}class k extends Error{request;constructor(t){super(`Request timed out: ${t.method} ${t.url}`),this.name="TimeoutError",this.request=t}}const c=r=>r!==null&&typeof r=="object",d=(...r)=>{for(const t of r)if((!c(t)||Array.isArray(t))&&t!==void 0)throw new TypeError("The `options` argument must be an object");return g({},...r)},q=(r={},t={})=>{const e=new globalThis.Headers(r),s=t instanceof globalThis.Headers,o=new globalThis.Headers(t);for(const[n,i]of o.entries())s&&i==="undefined"||i===void 0?e.delete(n):e.set(n,i);return e};function y(r,t,e){return Object.hasOwn(t,e)&&t[e]===void 0?[]:g(r[e]??[],t[e]??[])}const E=(r={},t={})=>({beforeRequest:y(r,t,"beforeRequest"),beforeRetry:y(r,t,"beforeRetry"),afterResponse:y(r,t,"afterResponse"),beforeError:y(r,t,"beforeError")}),g=(...r)=>{let t={},e={},s={};for(const o of r)if(Array.isArray(o))Array.isArray(t)||(t=[]),t=[...t,...o];else if(c(o)){for(let[n,i]of Object.entries(o))c(i)&&n in t&&(i=g(t[n],i)),t={...t,[n]:i};c(o.hooks)&&(s=E(s,o.hooks),t.hooks=s),c(o.headers)&&(e=q(e,o.headers),t.headers=e)}return t},x=(()=>{let r=!1,t=!1;const e=typeof globalThis.ReadableStream=="function",s=typeof globalThis.Request=="function";if(e&&s)try{t=new globalThis.Request("https://empty.invalid",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type")}catch(o){if(o instanceof Error&&o.message==="unsupported BodyInit type")return!1;throw o}return r&&!t})(),O=typeof globalThis.AbortController=="function",C=typeof globalThis.ReadableStream=="function",P=typeof globalThis.FormData=="function",S=["get","post","put","patch","head","delete"],I={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},b=2147483647,A=Symbol("stop"),N={json:!0,parseJson:!0,stringifyJson:!0,searchParams:!0,prefixUrl:!0,retry:!0,timeout:!0,hooks:!0,throwHttpErrors:!0,onDownloadProgress:!0,fetch:!0},j={method:!0,headers:!0,body:!0,mode:!0,credentials:!0,cache:!0,redirect:!0,referrer:!0,referrerPolicy:!0,integrity:!0,keepalive:!0,signal:!0,window:!0,dispatcher:!0,duplex:!0,priority:!0},v=r=>S.includes(r)?r.toUpperCase():r,L=["get","put","head","delete","options","trace"],$=[408,413,429,500,502,503,504],U=[413,429,503],T={limit:2,methods:L,statusCodes:$,afterStatusCodes:U,maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY,delay:r=>.3*2**(r-1)*1e3},H=(r={})=>{if(typeof r=="number")return{...T,limit:r};if(r.methods&&!Array.isArray(r.methods))throw new Error("retry.methods must be an array");if(r.statusCodes&&!Array.isArray(r.statusCodes))throw new Error("retry.statusCodes must be an array");return{...T,...r}};async function F(r,t,e,s){return new Promise((o,n)=>{const i=setTimeout(()=>{e&&e.abort(),n(new k(r))},s.timeout);s.fetch(r,t).then(o).catch(n).then(()=>{clearTimeout(i)})})}async function M(r,{signal:t}){return new Promise((e,s)=>{t&&(t.throwIfAborted(),t.addEventListener("abort",o,{once:!0}));function o(){clearTimeout(n),s(t.reason)}const n=setTimeout(()=>{t?.removeEventListener("abort",o),e()},r)})}const K=(r,t)=>{const e={};for(const s in t)!(s in j)&&!(s in N)&&!(s in r)&&(e[s]=t[s]);return e};class m{static create(t,e){const s=new m(t,e),o=async()=>{if(typeof s._options.timeout=="number"&&s._options.timeout>b)throw new RangeError(`The \`timeout\` option cannot be greater than ${b}`);await Promise.resolve();let a=await s._fetch();for(const h of s._options.hooks.afterResponse){const u=await h(s.request,s._options,s._decorateResponse(a.clone()));u instanceof globalThis.Response&&(a=u)}if(s._decorateResponse(a),!a.ok&&s._options.throwHttpErrors){let h=new w(a,s.request,s._options);for(const u of s._options.hooks.beforeError)h=await u(h);throw h}if(s._options.onDownloadProgress){if(typeof s._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!C)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return s._stream(a.clone(),s._options.onDownloadProgress)}return a},i=s._options.retry.methods.includes(s.request.method.toLowerCase())?s._retry(o):o();for(const[a,h]of Object.entries(I))i[a]=async()=>{s.request.headers.set("accept",s.request.headers.get("accept")||h);const u=await i;if(a==="json"){if(u.status===204||(await u.clone().arrayBuffer()).byteLength===0)return"";if(e.parseJson)return e.parseJson(await u.text())}return u[a]()};return i}request;abortController;_retryCount=0;_input;_options;constructor(t,e={}){if(this._input=t,this._options={...e,headers:q(this._input.headers,e.headers),hooks:E({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},e.hooks),method:v(e.method??this._input.method??"GET"),prefixUrl:String(e.prefixUrl||""),retry:H(e.retry),throwHttpErrors:e.throwHttpErrors!==!1,timeout:e.timeout??1e4,fetch:e.fetch??globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(O){this.abortController=new globalThis.AbortController;const s=this._options.signal??this._input.signal;s?.aborted&&this.abortController.abort(s?.reason),s?.addEventListener("abort",()=>{this.abortController.abort(s.reason)}),this._options.signal=this.abortController.signal}if(x&&(this._options.duplex="half"),this._options.json!==void 0&&(this._options.body=this._options.stringifyJson?.(this._options.json)??JSON.stringify(this._options.json),this._options.headers.set("content-type",this._options.headers.get("content-type")??"application/json")),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const o="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),n=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,o);(P&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(n,{...this.request}),this._options)}}_calculateRetryDelay(t){if(this._retryCount++,this._retryCount>this._options.retry.limit||t instanceof k)throw t;if(t instanceof w){if(!this._options.retry.statusCodes.includes(t.response.status))throw t;const s=t.response.headers.get("Retry-After")??t.response.headers.get("RateLimit-Reset")??t.response.headers.get("X-RateLimit-Reset")??t.response.headers.get("X-Rate-Limit-Reset");if(s&&this._options.retry.afterStatusCodes.includes(t.response.status)){let o=Number(s)*1e3;Number.isNaN(o)?o=Date.parse(s)-Date.now():o>=Date.parse("2024-01-01")&&(o-=Date.now());const n=this._options.retry.maxRetryAfter??o;return o<n?o:n}if(t.response.status===413)throw t}const e=this._options.retry.delay(this._retryCount);return Math.min(this._options.retry.backoffLimit,e)}_decorateResponse(t){return this._options.parseJson&&(t.json=async()=>this._options.parseJson(await t.text())),t}async _retry(t){try{return await t()}catch(e){const s=Math.min(this._calculateRetryDelay(e),b);if(this._retryCount<1)throw e;await M(s,{signal:this._options.signal});for(const o of this._options.hooks.beforeRetry)if(await o({request:this.request,options:this._options,error:e,retryCount:this._retryCount})===A)return;return this._retry(t)}}async _fetch(){for(const s of this._options.hooks.beforeRequest){const o=await s(this.request,this._options);if(o instanceof Request){this.request=o;break}if(o instanceof Response)return o}const t=K(this.request,this._options),e=this.request;return this.request=e.clone(),this._options.timeout===!1?this._options.fetch(e,t):F(e,t,this.abortController,this._options)}_stream(t,e){const s=Number(t.headers.get("content-length"))||0;let o=0;return t.status===204?(e&&e({percent:1,totalBytes:s,transferredBytes:o},new Uint8Array),new globalThis.Response(null,{status:t.status,statusText:t.statusText,headers:t.headers})):new globalThis.Response(new globalThis.ReadableStream({async start(n){const i=t.body.getReader();e&&e({percent:0,transferredBytes:0,totalBytes:s},new Uint8Array);async function a(){const{done:h,value:u}=await i.read();if(h){n.close();return}if(e){o+=u.byteLength;const R=s===0?0:o/s;e({percent:R,transferredBytes:o,totalBytes:s},u)}n.enqueue(u),await a()}await a()}}),{status:t.status,statusText:t.statusText,headers:t.headers})}}/*! MIT License © Sindre Sorhus */const _=r=>{const t=(e,s)=>m.create(e,d(r,s));for(const e of S)t[e]=(s,o)=>m.create(s,d(r,o,{method:e}));return t.create=e=>_(d(e)),t.extend=e=>(typeof e=="function"&&(e=e(r??{})),_(d(r,e))),t.stop=A,t},p=_(),f="./",l={søkerInfo:`${f}/fpoversikt/api/person/info-med-arbeidsforhold`,saker:`${f}/fpoversikt/api/saker`,erOppdatert:`${f}/fpoversikt/api/saker/erOppdatert`,status:`${f}/fpsoknad/api/soknad/status`,mellomlagring:`${f}/fpsoknad/api/storage/SVANGERSKAPSPENGER`,sendSøknad:`${f}/fpsoknad/api/soknad/svangerskapspenger`,sendVedlegg:`${f}/fpsoknad/api/storage/SVANGERSKAPSPENGER/vedlegg`,hentVedlegg:r=>`${f}/fpsoknad/api/storage/SVANGERSKAPSPENGER/vedlegg/${r}`},G=()=>({queryKey:["SAKER"],queryFn:()=>p.get(l.saker).json(),staleTime:1/0}),V=()=>({queryKey:["SØKERINFO"],queryFn:()=>p.get(l.søkerInfo,{timeout:3e4}).json(),staleTime:1/0}),B=()=>({queryKey:["MELLOMLAGRET_INFO"],queryFn:()=>p.get(l.mellomlagring).json(),staleTime:1/0}),J=()=>({queryKey:["STATUS"],queryFn:async()=>{const r=await p.get(l.status).json();return r.saksnummer!==void 0?await p.get(l.erOppdatert).json()?r:{status:"PENDING"}:r},staleTime:1/0});export{l as A,w as H,V as a,G as b,p as k,B as m,J as s};
