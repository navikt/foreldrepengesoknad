import{j as o}from"./jsx-runtime-Cw0GR0a5.js";import{u as h,C as E,b as C,a as $}from"./routes-B1fb87EI.js";import{b as u,T as Q,h as Y,i as ie,k as oe,o as ne,u as ae,a as de,j as me,l as le}from"./useSvpNavigator-yfJ1o2OX.js";import{r as w,R as z}from"./index-CTjT7uj6.js";import{d as ge,e as fe,c as U,a as pe,b as H,g as ce,u as ve,R as ue,E as Te,S as ye}from"./ErrorSummaryHookForm-C03QHvL8.js";import{e as R,q as Se,f as d,k as Ee,I as Z,R as j,u as ee,V as x,O as Me,a as K,B as W,K as he,M as v,d as je,A as De,H as te,F as _e,c as ke}from"./VeiviserPage-DPeYfbGG.js";import{g as Ie,b as X,a as xe}from"./dateUtils-DnafmBGO.js";import{n as A,i as L,a as J,l as V,e as Ae}from"./minMax-BeRBV8CB.js";import{B as Re}from"./Bedriftsbanner-pytk0qyo.js";import{g as M}from"./numberUtils-DCxWcr3S.js";import{h as b,b as B}from"./validationUtils-CUnokTVc.js";import{R as be}from"./ReadMore-CJAWNmD8.js";import{S as Fe}from"./Plus-C9cnxDk0.js";var Ge=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const Oe=w.forwardRef((e,t)=>{var{children:r,className:n,variant:i,size:m="medium",icon:a}=e,g=Ge(e,["children","className","variant","size","icon"]);return z.createElement(R,Object.assign({},g,{ref:t,as:"span",size:m==="medium"?"medium":"small",className:Se("navds-tag",n,`navds-tag--${i}`,`navds-tag--${m}`)}),a&&z.createElement("span",{className:"navds-tag__icon--left"},a),r)}),Ne=(e,t)=>d(e.fom).isBetween(t.fom,t.tom,"day","[]")||d(e.tom).isBetween(t.fom,t.tom,"day","[]")||d(t.fom).isBetween(e.fom,e.tom,"day","[]")||d(t.tom).isBetween(e.fom,e.tom,"day","[]"),Le=(e,t,r)=>!!e&&b(t.fom)&&b(t.stillingsprosent)&&d(t.fom).isAfter(e.fom,"day")&&(r>0&&M(t.stillingsprosent)<r||r===0&&M(t.stillingsprosent)<100),Ve=(e,t)=>e?e.find(r=>t>0?b(r.stillingsprosent)&&M(r.stillingsprosent)===t:b(r.stillingsprosent)&&M(r.stillingsprosent)===100):void 0,we=(e,t)=>e&&Ee(e)?e:t,Be=(e,t,r,n,i)=>{var a;const m=i&&i[e].tomType===u.SISTE_DAG_MED_SVP;if((a=i==null?void 0:i[e])!=null&&a.fom&&(m||i[e].tom)){const g=i[e].fom,s=i[e].tomType===u.SISTE_DAG_MED_SVP?t:d(i[e].tom).format(Z),l=d(s).diff(g,"days")+1,f=Math.floor(l/7),S=l-f*7;let T=j(s);return m&&(T=n?r.formatMessage({id:"PerioderStep.TreUkerFørTermin"}):r.formatMessage({id:"PerioderStep.Fødsel"})),`${j(g)} - ${T} (${r.formatMessage({id:"PerioderStep.tidsperiode"},{ukeAntall:f,dagAntall:S})})`}return r.formatMessage({id:"ny.periode"})},Pe=(e,t)=>{if(!t||t.length===0)return"";const r=t.filter(i=>i.tom||i.tomType===u.SISTE_DAG_MED_SVP).map(i=>i.tomType===u.SISTE_DAG_MED_SVP?d(e).add(1,"d"):d(i.tom)),n=r.length>0?d.max(r):void 0;return n?n.add(1,"d").format(Z):""},qe=(e,t)=>({fom:Pe(e,t),tom:"",stillingsprosent:"",tomType:void 0,type:Q.DELVIS}),Ce=(e,t)=>!t||t.trim()===""?e.formatMessage({id:"valideringsfeil.stillingsprosent.required"}):M(t)===void 0?e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreEtTall"}):void 0,$e=(e,t,r,n,i)=>m=>{const a=Ce(e,m);if(a)return a;const g=M(m);if(g&&i>0&&g>i)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLikOpprinneligStillingsprosent"},{prosent:i});if(g&&i===0&&g>100)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLik100Prosent"},{prosent:i});if(i>0&&(n!=null&&n.every(s=>s.stillingsprosent&&M(s.stillingsprosent)===i)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kunFullTilrettelegging"},{prosent:i});if(i===0&&(n!=null&&n.every(s=>s.stillingsprosent&&M(s.stillingsprosent)===100)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kun100Prosent"},{prosent:i});if(t&&r)return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.nySøknad"},{fom:j(r.fom)})},ze=(e,t,r,n,i,m,a)=>g=>{const s=r&&r.length>0?r[t].tom:void 0,l=r&&r.length>0?r[t].tomType:void 0;if(g&&n&&d(g).isBefore(d(n),"d"))return e.formatMessage({id:"valideringsfeil.periode.fom.førBehovForTilretteleggingFom"});if(a&&d(g).isAfter(d(a),"d")){const S=B(a,e);return e.formatMessage({id:"valideringsfeil.periode.fom.etterSluttDatoArbeid"},{dato:j(a),navn:m,slutteTekst:S})}const f=Ke(g,s,l,r,t,e,i);return f||We(g,r,i,e)},Ue=(e,t,r)=>n=>{if(r&&d(n).isAfter(d(r),"d")){const i=B(r,e);return e.formatMessage({id:"valideringsfeil.periode.tom.etterSluttDatoArbeid"},{dato:j(r),navn:t,slutteTekst:i})}},He=(e,t,r,n)=>i=>{if(n&&i===u.SISTE_DAG_MED_SVP&&d(t).isAfter(d(n),"d")){const m=B(n,e);return e.formatMessage({id:"valideringsfeil.periode.tomType.etterSluttDatoArbeid"},{navn:r,slutteTekst:m})}},Ke=(e,t,r,n,i,m,a)=>{if((t||r)&&e&&n&&n.length>0){const s=n.filter((l,f)=>f>i).filter(l=>{let f;return l.tomType&&l.tomType===u.SISTE_DAG_MED_SVP&&(f=a),l.tom&&(f=l.tom),f?Ne({fom:e,tom:t||a},{fom:l.fom,tom:f}):!1});if(s.length>0){const l=s[0].tom?s[0].tom:a;return m.formatMessage({id:"valideringsfeil.periode.overlapper"},{fom:j(s[0].fom),tom:j(l)})}}},We=(e,t,r,n)=>{const i=t?t.filter(s=>s.fom).map(s=>d(s.fom)):void 0,m=i?d.min(i):void 0;if(m&&d(e).isSameOrBefore(m,"day"))return;const a=t?t.filter(s=>s.tom||s.tomType===u.SISTE_DAG_MED_SVP).map(s=>s.tomType===u.SISTE_DAG_MED_SVP?d(r):d(s.tom)):void 0;if(!(a?a.find(s=>d(e).subtract(1,"d").isSame(d(s),"day")):void 0))return n.formatMessage({id:"valideringsfeil.periode.ikkeSammenhengende"})},Xe={type:Q.DELVIS,fom:"",tom:"",stillingsprosent:"",tomType:void 0},re=({barn:e,valgtTilretteleggingId:t,kanHaSVPFremTilTreUkerFørTermin:r,behovForTilretteleggingFom:n,arbeidsforhold:i,egenNæring:m,frilans:a})=>{const g=_e("perioderStep"),s=ee(),l=Ie(e),f=Y(s,t,i),S=ie(e.termindato,t,i,m,a),T=oe(e.termindato,t,i,m,a),y=ge(),{fields:F,append:G,remove:k}=fe({name:"varierendePerioder",control:y.control}),c=y.watch("varierendePerioder"),D=T.tom?A(d.min(d(l),d(T.tom))):l,_=ne(c,S),I=Ve(c,_),O=qe(l,c);return o.jsx(o.Fragment,{children:F.map((N,p)=>{const P=Le(I,c[p],_),q=we(c[p].fom,n),se=X(q,D);return o.jsxs(w.Fragment,{children:[o.jsxs(x,{gap:"1",children:[o.jsx(Me,{}),o.jsxs(K,{justify:"space-between",align:"center",children:[o.jsx(Oe,{variant:"info-moderate",className:g.element("tag"),children:Be(p,l,s,r,c)}),p!==0&&o.jsx(W,{icon:o.jsx(he,{"aria-hidden":!0}),type:"button",variant:"tertiary",onClick:()=>k(p),children:o.jsx(v,{id:"perioder.varierende.slett"})})]})]}),o.jsx(U,{name:`varierendePerioder.${p}.fom`,label:s.formatMessage({id:"perioder.varierende.fom.label"}),minDate:n,maxDate:D,validate:[L(s.formatMessage({id:"valideringsfeil.periode.fom.påkrevd"})),J(s.formatMessage({id:"valideringsfeil.periode.fom.gyldigDato"})),V(s.formatMessage({id:"valideringsfeil.periode.fom.førTilDato"}),c[p].tom),V(r?s.formatMessage({id:"valideringsfeil.periode.fom.etterTreUkerFørTermin"}):s.formatMessage({id:"valideringsfeil.periode.fom.etterFødsel"}),l),ze(s,p,c,n,l,f||"",T.tom)],defaultMonth:X(n,D)}),o.jsxs(pe,{name:`varierendePerioder.${p}.tomType`,label:o.jsx(v,{id:"perioder.varierende.tomType.label"}),validate:[L(r?s.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.termin"}):s.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.fødsel"})),He(s,l,f||"",T.tom)],children:[o.jsx(H,{value:u.VALGFRI_DATO,children:o.jsx(v,{id:"perioder.varierende.tomType.valgfriDato"})}),o.jsx(H,{value:u.SISTE_DAG_MED_SVP,children:r?o.jsx(v,{id:"perioder.varierende.tomType.treUkerFørTermin"}):o.jsx(v,{id:"perioder.varierende.tomType.dagenFørFødsel"})})]}),c[p].tomType===u.VALGFRI_DATO&&o.jsx(U,{name:`varierendePerioder.${p}.tom`,label:s.formatMessage({id:"perioder.varierende.tom.label"}),validate:[L(s.formatMessage({id:"valideringsfeil.periode.tom.påkrevd"})),J(s.formatMessage({id:"valideringsfeil.periode.tom.gyldigDato"})),Ae(s.formatMessage({id:"valideringsfeil.periode.tom.etterTilDato"}),c[p].fom),V(r?s.formatMessage({id:"valideringsfeil.periode.tom.etterTreUkerFørTermin"}):s.formatMessage({id:"valideringsfeil.periode.tom.etterFødsel"}),l),Ue(s,f||"",T.tom)],minDate:q,maxDate:D,defaultMonth:se}),o.jsxs("div",{children:[o.jsx(ce,{name:`varierendePerioder.${p}.stillingsprosent`,label:s.formatMessage({id:"perioder.varierende.stillingsprosent.label"}),className:g.element("stillingsprosent"),description:s.formatMessage({id:"tilrettelegging.tilrettelagtArbeidType.description"}),validate:[$e(s,P,I,c,_)]}),o.jsx(be,{onOpenChange:je("Svangerskapspenger","Ikke_har_100%_stilling"),size:"medium",header:s.formatMessage({id:"tilrettelegging.varierendePerioderStillingsprosent.info.tittel"}),children:o.jsxs(x,{gap:"2",children:[o.jsx(R,{children:o.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del1"})}),o.jsx(R,{children:o.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del2"})})]})})]}),P&&o.jsx(De,{variant:"warning",children:o.jsxs(x,{gap:"4",children:[o.jsx(te,{size:"small",children:o.jsx(v,{id:"perioder.alert.nySøknad.title"})}),o.jsx("div",{children:o.jsx(v,{id:"perioder.alert.nySøknad.del1"})}),o.jsx(v,{id:"perioder.alert.nySøknad.del2"})]})}),c&&p===c.length-1&&o.jsx(K,{children:o.jsx(W,{icon:o.jsx(Fe,{"aria-hidden":!0}),type:"button",variant:"secondary",onClick:()=>G(O),children:o.jsx(v,{id:"perioder.varierende.leggTil"})})})]},N.id)})})};re.__docgenInfo={description:"",methods:[],displayName:"PerioderFieldArray"};const Je=({mellomlagreSøknadOgNaviger:e,avbrytSøknad:t,arbeidsforhold:r})=>{const n=ee(),i=ae(r),m=de(e,r),a=h(E.TILRETTELEGGINGER_PERIODER),g=A(h(E.TILRETTELEGGINGER)),s=A(h(E.OM_BARNET)),l=h(E.EGEN_NÆRING),f=h(E.FRILANS),S=h(E.VALGTE_ARBEIDSFORHOLD),T=A(h(E.VALGT_TILRETTELEGGING_ID)),[y]=w.useState(T),F=C(E.TILRETTELEGGINGER_PERIODER),G=C(E.VALGT_TILRETTELEGGING_ID),k=xe(s),c=me(y,r),D=Y(n,y,r),_=g[y],I=N=>{F({...a,[y]:N.varierendePerioder});const p=le(y,S);return p&&G(p),m.goToNextStep(p?$.SKJEMA:$.OPPSUMMERING)},O=ve({shouldUnregister:!0,defaultValues:{varierendePerioder:(a==null?void 0:a[y])??[Xe]}});return o.jsx(ke,{bannerTitle:n.formatMessage({id:"søknad.pageheading"}),onCancel:t,steps:i,onContinueLater:m.fortsettSøknadSenere,children:o.jsx(ue,{formMethods:O,onSubmit:I,children:o.jsxs(x,{gap:"10",children:[o.jsx(Te,{}),!!S&&S.length>1&&o.jsx(Re,{arbeidsforholdType:c,arbeidsforholdNavn:D}),o.jsxs("div",{children:[o.jsx(te,{size:"small",children:o.jsx(v,{id:"perioder.varierende.heading"})}),o.jsx(R,{children:k?o.jsx(v,{id:"perioder.varierende.description.termin"}):o.jsx(v,{id:"perioder.varierende.description.fødsel"})})]}),o.jsx(re,{valgtTilretteleggingId:y,barn:s,kanHaSVPFremTilTreUkerFørTermin:k,arbeidsforhold:r,egenNæring:l,frilans:f,behovForTilretteleggingFom:_.behovForTilretteleggingFom}),o.jsx(ye,{goToPreviousStep:m.goToPreviousDefaultStep})]})})})};Je.__docgenInfo={description:"",methods:[],displayName:"PerioderStep",props:{mellomlagreSøknadOgNaviger:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},avbrytSøknad:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},arbeidsforhold:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    arbeidsgiverNavn: string;
    arbeidsgiverId: string;
    arbeidsgiverIdType: string;
    fom: string;
    tom?: string;
    stillingsprosent: number;
}`,signature:{properties:[{key:"arbeidsgiverNavn",value:{name:"string",required:!0}},{key:"arbeidsgiverId",value:{name:"string",required:!0}},{key:"arbeidsgiverIdType",value:{name:"string",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!1}},{key:"stillingsprosent",value:{name:"number",required:!0}}]}}],raw:"Arbeidsforhold[]"},description:""}}};export{Je as P};
