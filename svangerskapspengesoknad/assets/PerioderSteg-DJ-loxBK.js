import{j as i}from"./index-DDg3ir62.js";import{u as M,C as S,b as te,c as P,a as N}from"./routes-BC9Z9msW.js";import{c as y,T as W,k as Y,l as ie,m as ne,q as se,u as ae,a as oe,e as de,f as ge,h as le}from"./useSvpNavigator-COpRi9JE.js";import{d as me,e as ue,c as C,a as fe,b as $,g as pe,u as ve,R as ce,E as ye,S as Te}from"./ErrorSummaryHookForm-CYzANNMK.js";import{e as d,i as ke,I as X,R as E,u as J,V as F,O as Se,a as H,B as U,K as Ee,M as v,l as he,d as V,F as Me,H as Q,c as je}from"./RegisterdataUtdatert-C91aLbpA.js";import{g as De,b as z,a as be}from"./dateUtils-BrBIle2Z.js";import{r as Ie}from"./index-CR__hKHy.js";import{n as A,i as G,a as K,j as L,e as Fe}from"./minMax-nBLAxST0.js";import{B as Ae}from"./Bedriftsbanner-EJZmA5Kl.js";import{g as T}from"./numberUtils-sHqsSnTP.js";import{h as x,b as B}from"./validationUtils-D-wz1xR5.js";import{T as xe}from"./Tag-4bVBcGqu.js";import{R as _e}from"./ReadMore-7Il4YwYn.js";import{S as qe}from"./Plus-BaKisdCp.js";const Re=(e,r)=>d(e.fom).isBetween(r.fom,r.tom,"day","[]")||d(e.tom).isBetween(r.fom,r.tom,"day","[]")||d(r.fom).isBetween(e.fom,e.tom,"day","[]")||d(r.tom).isBetween(e.fom,e.tom,"day","[]"),Ne=(e,r,t)=>!!e&&x(r.fom)&&x(r.stillingsprosent)&&d(r.fom).isAfter(e.fom,"day")&&(t>0&&T(r.stillingsprosent)<t||t===0&&T(r.stillingsprosent)<100),Ge=(e,r)=>e?e.find(t=>r>0?x(t.stillingsprosent)&&T(t.stillingsprosent)===r:x(t.stillingsprosent)&&T(t.stillingsprosent)===100):void 0,Le=(e,r)=>e&&ke(e)?e:r,Ve=(e,r,t,o,s)=>{var l;const g=s&&s[e].tomType===y.SISTE_DAG_MED_SVP;if((l=s==null?void 0:s[e])!=null&&l.fom&&(g||s[e].tom)){const n=s[e].fom,a=s[e].tomType===y.SISTE_DAG_MED_SVP?r:d(s[e].tom).format(X),m=d(a).diff(n,"days")+1,u=Math.floor(m/7),c=m-u*7;let k=E(a);return g&&(k=o?t.formatMessage({id:"PerioderStep.TreUkerFørTermin"}):t.formatMessage({id:"PerioderStep.Fødsel"})),`${E(n)} - ${k} (${t.formatMessage({id:"PerioderStep.tidsperiode"},{ukeAntall:u,dagAntall:c})})`}return t.formatMessage({id:"ny.periode"})},Be=(e,r)=>{if(!r||r.length===0)return"";const t=r.filter(s=>s.tom||s.tomType===y.SISTE_DAG_MED_SVP).map(s=>s.tomType===y.SISTE_DAG_MED_SVP?d(e).add(1,"d"):d(s.tom)),o=t.length>0?d.max(t):void 0;return o?o.add(1,"d").format(X):""},Oe=(e,r)=>({fom:Be(e,r),tom:"",stillingsprosent:"",tomType:void 0,type:W.DELVIS}),we=(e,r)=>!r||r.trim()===""?e.formatMessage({id:"valideringsfeil.stillingsprosent.required"}):T(r)===void 0?e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreEtTall"}):void 0,Pe=(e,r,t,o,s)=>g=>{const l=we(e,g);if(l)return l;const n=T(g);if(n&&s>0&&n>s)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLikOpprinneligStillingsprosent"},{prosent:s});if(n&&s===0&&n>100)return e.formatMessage({id:"valideringsfeil.stillingsprosent.måVæreMindreEllerLik100Prosent"},{prosent:s});if(s>0&&(o!=null&&o.every(a=>a.stillingsprosent&&T(a.stillingsprosent)===s)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kunFullTilrettelegging"},{prosent:s});if(s===0&&(o!=null&&o.every(a=>a.stillingsprosent&&T(a.stillingsprosent)===100)))return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.kun100Prosent"},{prosent:s});if(r&&t)return e.formatMessage({id:"valideringsfeil.periode.stillingsprosent.nySøknad"},{fom:E(t.fom)})},Ce=(e,r,t,o,s,g,l)=>n=>{const a=t&&t.length>0?t[r].tom:void 0,m=t&&t.length>0?t[r].tomType:void 0;if(n&&o&&d(n).isBefore(d(o),"d"))return e.formatMessage({id:"valideringsfeil.periode.fom.førBehovForTilretteleggingFom"});if(l&&d(n).isAfter(d(l),"d")){const c=B(l,e);return e.formatMessage({id:"valideringsfeil.periode.fom.etterSluttDatoArbeid"},{dato:E(l),navn:g,slutteTekst:c})}const u=Ue(n,a,m,t,r,e,s);return u||ze(n,t,s,e)},$e=(e,r,t)=>o=>{if(t&&d(o).isAfter(d(t),"d")){const s=B(t,e);return e.formatMessage({id:"valideringsfeil.periode.tom.etterSluttDatoArbeid"},{dato:E(t),navn:r,slutteTekst:s})}},He=(e,r,t,o)=>s=>{if(o&&s===y.SISTE_DAG_MED_SVP&&d(r).isAfter(d(o),"d")){const g=B(o,e);return e.formatMessage({id:"valideringsfeil.periode.tomType.etterSluttDatoArbeid"},{navn:t,slutteTekst:g})}},Ue=(e,r,t,o,s,g,l)=>{if((r||t)&&e&&o&&o.length>0){const a=o.filter((m,u)=>u>s).filter(m=>{let u;return m.tomType&&m.tomType===y.SISTE_DAG_MED_SVP&&(u=l),m.tom&&(u=m.tom),u?Re({fom:e,tom:r||l},{fom:m.fom,tom:u}):!1});if(a.length>0){const m=a[0].tom?a[0].tom:l;return g.formatMessage({id:"valideringsfeil.periode.overlapper"},{fom:E(a[0].fom),tom:E(m)})}}},ze=(e,r,t,o)=>{const s=r?r.filter(a=>a.fom).map(a=>d(a.fom)):void 0,g=s?d.min(s):void 0;if(g&&d(e).isSameOrBefore(g,"day"))return;const l=r?r.filter(a=>a.tom||a.tomType===y.SISTE_DAG_MED_SVP).map(a=>a.tomType===y.SISTE_DAG_MED_SVP?d(t):d(a.tom)):void 0;if(!(l?l.find(a=>d(e).subtract(1,"d").isSame(d(a),"day")):void 0))return o.formatMessage({id:"valideringsfeil.periode.ikkeSammenhengende"})},Ke={type:W.DELVIS,fom:"",tom:"",stillingsprosent:"",tomType:void 0},Z=({barn:e,valgtTilretteleggingId:r,kanHaSVPFremTilTreUkerFørTermin:t,behovForTilretteleggingFom:o,arbeidsforhold:s,egenNæring:g,frilans:l})=>{const n=J(),a=De(e),m=Y(n,r,s),u=ie(e.termindato,r,s,g,l),c=ne(e.termindato,r,s,g,l),k=me(),{fields:j,append:_,remove:b}=ue({name:"varierendePerioder",control:k.control}),f=k.watch("varierendePerioder"),h=c.tom?A(d.min(d(a),d(c.tom))):a,D=se(f,u),I=Ge(f,D),q=Oe(a,f);return i.jsx(i.Fragment,{children:j.map((R,p)=>{const O=Ne(I,f[p],D),w=Le(f[p].fom,o),ee=z(w,h);return i.jsxs(Ie.Fragment,{children:[i.jsxs(F,{gap:"1",children:[i.jsx(Se,{}),i.jsxs(H,{justify:"space-between",align:"center",children:[i.jsx(xe,{variant:"info-moderate",children:Ve(p,a,n,t,f)}),p!==0&&i.jsx(U,{icon:i.jsx(Ee,{"aria-hidden":!0}),type:"button",variant:"tertiary",onClick:()=>b(p),children:i.jsx(v,{id:"perioder.varierende.slett"})})]})]}),i.jsx(C,{name:`varierendePerioder.${p}.fom`,label:n.formatMessage({id:"perioder.varierende.fom.label"}),minDate:o,maxDate:h,validate:[G(n.formatMessage({id:"valideringsfeil.periode.fom.påkrevd"})),K(n.formatMessage({id:"valideringsfeil.periode.fom.gyldigDato"})),L(n.formatMessage({id:"valideringsfeil.periode.fom.førTilDato"}),f[p].tom),L(t?n.formatMessage({id:"valideringsfeil.periode.fom.etterTreUkerFørTermin"}):n.formatMessage({id:"valideringsfeil.periode.fom.etterFødsel"}),a),Ce(n,p,f,o,a,m||"",c.tom)],defaultMonth:z(o,h)}),i.jsxs(fe,{name:`varierendePerioder.${p}.tomType`,label:i.jsx(v,{id:"perioder.varierende.tomType.label"}),validate:[G(t?n.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.termin"}):n.formatMessage({id:"valideringsfeil.periode.tomType.påkrevd.fødsel"})),He(n,a,m||"",c.tom)],children:[i.jsx($,{value:y.VALGFRI_DATO,children:i.jsx(v,{id:"perioder.varierende.tomType.valgfriDato"})}),i.jsx($,{value:y.SISTE_DAG_MED_SVP,children:t?i.jsx(v,{id:"perioder.varierende.tomType.treUkerFørTermin"}):i.jsx(v,{id:"perioder.varierende.tomType.dagenFørFødsel"})})]}),f[p].tomType===y.VALGFRI_DATO&&i.jsx(C,{name:`varierendePerioder.${p}.tom`,label:n.formatMessage({id:"perioder.varierende.tom.label"}),validate:[G(n.formatMessage({id:"valideringsfeil.periode.tom.påkrevd"})),K(n.formatMessage({id:"valideringsfeil.periode.tom.gyldigDato"})),Fe(n.formatMessage({id:"valideringsfeil.periode.tom.etterTilDato"}),f[p].fom),L(t?n.formatMessage({id:"valideringsfeil.periode.tom.etterTreUkerFørTermin"}):n.formatMessage({id:"valideringsfeil.periode.tom.etterFødsel"}),a),$e(n,m||"",c.tom)],minDate:w,maxDate:h,defaultMonth:ee}),i.jsxs("div",{children:[i.jsx(pe,{name:`varierendePerioder.${p}.stillingsprosent`,label:n.formatMessage({id:"perioder.varierende.stillingsprosent.label"}),style:{maxWidth:"450px"},description:n.formatMessage({id:"tilrettelegging.tilrettelagtArbeidType.description"}),validate:[Pe(n,O,I,f,D)]}),i.jsx(_e,{onOpenChange:re=>he({origin:"svangerskapspengesoknad",eventName:re?"readmore åpnet":"readmore lukket",eventData:{tittel:"tilrettelegging.varierendePerioderStillingsprosent.info.tittel"}}),size:"medium",header:n.formatMessage({id:"tilrettelegging.varierendePerioderStillingsprosent.info.tittel"}),children:i.jsxs(F,{gap:"2",children:[i.jsx(V,{children:i.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del1"})}),i.jsx(V,{children:i.jsx(v,{id:"tilrettelegging.varierendePerioderStillingsprosent.info.tekst.del2"})})]})})]}),O&&i.jsx(Me,{variant:"warning",children:i.jsxs(F,{gap:"4",children:[i.jsx(Q,{size:"small",children:i.jsx(v,{id:"perioder.alert.nySøknad.title"})}),i.jsx("div",{children:i.jsx(v,{id:"perioder.alert.nySøknad.del1"})}),i.jsx(v,{id:"perioder.alert.nySøknad.del2"})]})}),f&&p===f.length-1&&i.jsx(H,{children:i.jsx(U,{icon:i.jsx(qe,{"aria-hidden":!0}),type:"button",variant:"secondary",onClick:()=>_(q),children:i.jsx(v,{id:"perioder.varierende.leggTil"})})})]},R.id)})})};Z.__docgenInfo={description:"",methods:[],displayName:"PerioderFieldArray",props:{barn:{required:!0,tsType:{name:"Barn"},description:""},valgtTilretteleggingId:{required:!0,tsType:{name:"string"},description:""},kanHaSVPFremTilTreUkerFørTermin:{required:!0,tsType:{name:"boolean"},description:""},behovForTilretteleggingFom:{required:!0,tsType:{name:"string"},description:""},arbeidsforhold:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    arbeidsgiverId: string;
    arbeidsgiverIdType: string;
    arbeidsgiverNavn: string;
    stillingsprosent: number;
    fom: string;
    tom?: string;
}`,signature:{properties:[{key:"arbeidsgiverId",value:{name:"string",required:!0}},{key:"arbeidsgiverIdType",value:{name:"string",required:!0}},{key:"arbeidsgiverNavn",value:{name:"string",required:!0}},{key:"stillingsprosent",value:{name:"number",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!1}}]}}],raw:"Arbeidsforhold[]"},description:""},egenNæring:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    næringstype: Næringstype;
    fom: string;
    tom: string;
    næringsinntekt?: number;
    pågående: boolean; // Brukes ikke backend
    navnPåNæringen?: string;
    organisasjonsnummer?: string;
    registrertINorge: boolean;
    registrertILand?: string;
    harBlittYrkesaktivILøpetAvDeTreSisteFerdigliknedeÅrene?: boolean;
    oppstartsdato?: string;
    hattVarigEndringAvNæringsinntektSiste4Kalenderår?: boolean;
    varigEndringDato?: string;
    varigEndringInntektEtterEndring?: string;
    varigEndringBeskrivelse?: string;
}`,signature:{properties:[{key:"næringstype",value:{name:"Næringstype",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!0}},{key:"næringsinntekt",value:{name:"number",required:!1}},{key:"pågående",value:{name:"boolean",required:!0}},{key:"navnPåNæringen",value:{name:"string",required:!1}},{key:"organisasjonsnummer",value:{name:"string",required:!1}},{key:"registrertINorge",value:{name:"boolean",required:!0}},{key:"registrertILand",value:{name:"string",required:!1}},{key:"harBlittYrkesaktivILøpetAvDeTreSisteFerdigliknedeÅrene",value:{name:"boolean",required:!1}},{key:"oppstartsdato",value:{name:"string",required:!1}},{key:"hattVarigEndringAvNæringsinntektSiste4Kalenderår",value:{name:"boolean",required:!1}},{key:"varigEndringDato",value:{name:"string",required:!1}},{key:"varigEndringInntektEtterEndring",value:{name:"string",required:!1}},{key:"varigEndringBeskrivelse",value:{name:"string",required:!1}}]}},description:""},frilans:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    jobberFremdelesSomFrilans: boolean;
    oppstart: string;
}`,signature:{properties:[{key:"jobberFremdelesSomFrilans",value:{name:"boolean",required:!0}},{key:"oppstart",value:{name:"string",required:!0}}]}},description:""}}};const We=({mellomlagreSøknadOgNaviger:e,avbrytSøknad:r,arbeidsforhold:t})=>{const o=J(),s=ae(t),g=oe(e,t),l=de(),n=A(l.tilretteleggingId),a=M(S.TILRETTELEGGINGER_PERIODER),m=A(M(S.TILRETTELEGGINGER)),u=A(M(S.OM_BARNET)),c=M(S.EGEN_NÆRING),k=M(S.FRILANS),j=M(S.VALGTE_ARBEIDSFORHOLD),_=te(S.TILRETTELEGGINGER_PERIODER),b=be(u),f=ge(n,t),h=Y(o,n,t),D=m[n],I=R=>{if(_({...a,[n]:R.varierendePerioder}),f==="virksomhet"||f==="privat")return g.goToStep(P(N.FERIE,n));const p=le(n,j);return g.goToStep(p?P(N.SKJEMA,p):N.OPPSUMMERING)},q=ve({shouldUnregister:!0,defaultValues:{varierendePerioder:(a==null?void 0:a[n])??[Ke]}});return i.jsx(je,{bannerTitle:o.formatMessage({id:"søknad.pageheading"}),onCancel:r,steps:s,onContinueLater:g.fortsettSøknadSenere,onStepChange:g.goToStep,children:i.jsx(ce,{formMethods:q,onSubmit:I,children:i.jsxs(F,{gap:"10",children:[i.jsx(ye,{}),!!j&&j.length>1&&i.jsx(Ae,{arbeidsforholdType:f,arbeidsforholdNavn:h}),i.jsxs("div",{children:[i.jsx(Q,{size:"small",children:i.jsx(v,{id:"perioder.varierende.heading"})}),i.jsx(V,{children:b?i.jsx(v,{id:"perioder.varierende.description.termin"}):i.jsx(v,{id:"perioder.varierende.description.fødsel"})})]}),i.jsx(Z,{valgtTilretteleggingId:n,barn:u,kanHaSVPFremTilTreUkerFørTermin:b,arbeidsforhold:t,egenNæring:c,frilans:k,behovForTilretteleggingFom:D.behovForTilretteleggingFom}),i.jsx(Te,{goToPreviousStep:g.goToPreviousDefaultStep})]})})})};We.__docgenInfo={description:"",methods:[],displayName:"PerioderSteg",props:{mellomlagreSøknadOgNaviger:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},avbrytSøknad:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},arbeidsforhold:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    arbeidsgiverId: string;
    arbeidsgiverIdType: string;
    arbeidsgiverNavn: string;
    stillingsprosent: number;
    fom: string;
    tom?: string;
}`,signature:{properties:[{key:"arbeidsgiverId",value:{name:"string",required:!0}},{key:"arbeidsgiverIdType",value:{name:"string",required:!0}},{key:"arbeidsgiverNavn",value:{name:"string",required:!0}},{key:"stillingsprosent",value:{name:"number",required:!0}},{key:"fom",value:{name:"string",required:!0}},{key:"tom",value:{name:"string",required:!1}}]}}],raw:"Arbeidsforhold[]"},description:""}}};export{We as P};
