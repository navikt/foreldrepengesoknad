import{j as e}from"./jsx-runtime-69eee039.js";import{r as h}from"./index-7c191284.js";import{u as N,j as s,n as U,o as E,V as x,F as D,d as b,T as I,p as L,g as A,P as R}from"./IntlProvider-6b2e8efe.js";import{a as H,O as B,x as M,u as V,b as $,C as q,D as w,w as z}from"./index.es-1c07523a.js";import{c as G}from"./countryUtils-8377bc9a.js";import{i as v,v as _,a as Y,b as J}from"./valideringsregler-4276fa64.js";import{a as K,u as Q,b as k,E as T,c as W}from"./useEsNavigator-196eef3f.js";import{P as y}from"./paths-77448497.js";const O=(t,m,a,n)=>{const r=m.map(i=>({from:s(i.fom).toDate(),to:s(i.tom).toDate()})).concat({from:s(a).toDate(),to:s(n).toDate()});return L(r)?t.formatMessage({id:"valideringsfeil.utenlandsopphold.overlapp"}):null},j=({index:t,fjernOpphold:m})=>{const a=N(),{watch:n,trigger:c,formState:{isSubmitted:r}}=H(),i=n("utenlandsoppholdSiste12Mnd").filter((o,p)=>p!==t),l=n(`utenlandsoppholdSiste12Mnd.${t}.fom`),d=n(`utenlandsoppholdSiste12Mnd.${t}.tom`),u=s(U).toDate(),g=d?s(d).toDate():s(E).toDate(),S=l?s(l).toDate():s(U).toDate(),f=s(E).toDate();return e.jsxs(x,{gap:"5",align:"start",children:[e.jsx(B,{name:`utenlandsoppholdSiste12Mnd.${t}.landkode`,label:e.jsx(D,{id:"utenlandsopphold.leggTilUtenlandsopphold.spørsmål.hvilketLandHarDuBoddI"}),validate:[v(a.formatMessage({id:"valideringsfeil.leggTilUtenlandsopphold.landDuHarBoddIPåkrevd"}))],children:G().map(o=>e.jsx("option",{value:o[0],children:o[1]},o[0]))}),e.jsx(M,{name:`utenlandsoppholdSiste12Mnd.${t}.fom`,label:e.jsx(D,{id:"utenlandsopphold.leggTilUtenlandsopphold.fraogmed"}),minDate:u,maxDate:g,validate:[v(a.formatMessage({id:"valideringsfeil.leggTilUtenlandsopphold.landFomDuSkalBoIPåkreved"})),_(a.formatMessage({id:"valideringsfeil.fomErLikTom"}),d),o=>Y(a,s(o).toDate(),u,g,s(d).toDate()),o=>O(a,i,o,d)],onChange:()=>r&&c()}),e.jsx(M,{name:`utenlandsoppholdSiste12Mnd.${t}.tom`,label:e.jsx(D,{id:"utenlandsopphold.leggTilUtenlandsopphold.tilogmed"}),minDate:S,maxDate:f,validate:[v(a.formatMessage({id:"valideringsfeil.leggTilUtenlandsopphold.landTomDuHarBoddIPåkreved"})),_(a.formatMessage({id:"valideringsfeil.tomErLikFom"}),l),o=>J(a,s(o).toDate(),S,f,s(l).toDate()),o=>O(a,i,l,o)],onChange:()=>r&&c()}),t>0&&e.jsx(b,{type:"button",variant:"tertiary",size:"small",icon:e.jsx(I,{"aria-hidden":!0}),onClick:()=>m(t),children:e.jsx(D,{id:"utenlandsopphold.knapp.SlettOpphold"})})]})};try{j.displayName="SisteUtenlandsoppholdPeriode",j.__docgenInfo={description:"",displayName:"SisteUtenlandsoppholdPeriode",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},fjernOpphold:{defaultValue:null,description:"",name:"fjernOpphold",required:!0,type:{name:"(index: number) => void"}}}}}catch{}const C={fom:"",tom:"",landkode:""},X={utenlandsoppholdSiste12Mnd:[C]},P=()=>{const t=N(),m=K(),a=Q(),n=k(T.UTENLANDSOPPHOLD),c=k(T.UTENLANDSOPPHOLD_SISTE),r=W(T.UTENLANDSOPPHOLD_SISTE),i=h.useMemo(()=>c||X,[]),l=V({defaultValues:i}),{fields:d,append:u,remove:g}=$({name:"utenlandsoppholdSiste12Mnd",control:l.control}),S=h.useCallback(()=>{u(C)},[u]),f=h.useCallback(p=>{g(p)},[g]),o=h.useCallback(p=>{r(p),a.goToNextStep(n!=null&&n.skalBoUtenforNorgeNeste12Mnd?y.NESTE_UTENLANDSOPPHOLD:y.OPPSUMMERING)},[]);return e.jsx(A,{bannerTitle:t.formatMessage({id:"Søknad.Pageheading"}),pageTitle:t.formatMessage({id:"søknad.utenlandsopphold.tidligere"}),onCancel:a.avbrytSøknad,steps:m.stepConfig,activeStepId:m.activeStepId,useNoTempSavingText:!0,children:e.jsx(q,{formMethods:l,onSubmit:o,children:e.jsxs(x,{gap:"10",children:[e.jsx(w,{}),e.jsxs(x,{gap:"10",align:"start",children:[d.map((p,F)=>e.jsxs(h.Fragment,{children:[e.jsx(j,{index:F,fjernOpphold:f}),d.length>1&&e.jsx("hr",{style:{width:"100%"},color:"#99C4DD"})]},p.id)),e.jsx(b,{type:"button",variant:"secondary",size:"small",icon:e.jsx(R,{"aria-hidden":!0}),onClick:S,children:e.jsx(D,{id:"utenlandsopphold.knapp.leggTilLand"})})]}),e.jsx(z,{goToPreviousStep:a.goToPreviousDefaultStep,saveDataOnPreviousClick:r})]})})})},de=P;try{P.displayName="SisteUtenlandsoppholdSteg",P.__docgenInfo={description:"",displayName:"SisteUtenlandsoppholdSteg",props:{}}}catch{}export{de as S};
//# sourceMappingURL=SisteUtenlandsoppholdSteg-96f042f7.js.map
