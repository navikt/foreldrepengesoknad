import{j as t}from"./jsx-runtime-69eee039.js";import{b as B,E as _,D as E,M as G}from"./DokumentasjonSteg-4ef9deaa.js";import"./countryUtils-ac55b9bd.js";import{n as P,h as j,j as x,e as q}from"./useEsNavigator-7d967be7.js";import{e as $,b as H,a as J}from"./Attachment-77c59016.js";import{e as z,O as Q}from"./OppsummeringSteg-2c2904ee.js";import{g as F,q as W,Q as X,U as Y,I as Z}from"./IntlProvider-323f7bb7.js";import{r as i,$ as ee}from"./index-7c191284.js";import{e as te,f as ne,R as se,a as p,N as re,P as c}from"./paths-15c3400b.js";import{S as oe}from"./SøkersituasjonSteg-1dbded33.js";import{V as ae}from"./Velkommen-b63b34ee.js";import{O as ie}from"./OmBarnetSteg-bc0aa37e.js";import{U as le}from"./UtenlandsoppholdSteg-baeb88a9.js";import{S as pe}from"./SøknadSendt-dde462bf.js";import{U as ce}from"./Umyndig-92b87bdd.js";import{U as de}from"./UtenlandsoppholdPeriodeSteg-c9e32797.js";import{F as me}from"./FeilsideInfo-dd82b7fe.js";import{K as w}from"./Person-12835ba1.js";import{i as ue}from"./amplitude-a97f1527.js";import"./ErrorSummaryHookForm-6083ef49.js";import"./StepButtons-472e9663.js";import"./dateUtils-a2958f29.js";import"./extends-2f8ee675.js";import"./index-ecbee218.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./Søkersituasjon-b1a475fe.js";import"./links-eccbf744.js";import"./valideringsregler-beb70bac.js";import"./Feilside-5b677e2f.js";const fe=e=>{window.location.href=e},ge=e=>{fe(e+"?redirect="+window.location.origin)},h=B.create({baseURL:_.REST_API_URL,withCredentials:!0});h.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));h.interceptors.response.use(e=>e,e=>{var s;return e.response&&e.response.status===401&&((s=e==null?void 0:e.config)!=null&&s.url)&&!e.config.url.includes("/soknad")&&ge(_.LOGIN_URL),Promise.reject(e)});const Se=()=>h.get("/personinfo"),ke=(e,s)=>{if($(e)||H(e))return{...e,fødselsdatoer:e.fødselsdatoer.map(r=>r.dato)};if(J(e)&&s&&z(s))return{...e,terminbekreftelsedato:s.terminbekreftelsedato};throw Error("Det er feil i data om barnet")},A=(e=[])=>e.map(s=>({land:s.landkode,tidsperiode:{fom:s.fom,tom:s.tom}})),he=(e,s)=>{if(e.harKunBoddINorge)return{iNorgeSiste12Mnd:!0,iNorgeNeste12Mnd:!0,tidligereOpphold:[],senereOpphold:[]};const{perioder:r}=P(s),o=F().format(W),a=r.filter(n=>j(n.fom)).map(n=>({...n,tom:x(n.tom)?o:n.tom})),l=r.filter(n=>x(n.tom)).map(n=>({...n,fom:j(n.fom)?o:n.fom}));return{iNorgeSiste12Mnd:a.length>0,iNorgeNeste12Mnd:l.length>0,tidligereOpphold:A(a),senereOpphold:A(l)}},Ee=(e,s)=>async(r,o,a,l)=>{P(o);const n={barn:ke(r,a),type:"engangsstønad",erEndringssøknad:!1,informasjonOmUtenlandsopphold:he(o,l),søker:{språkkode:e},vedlegg:(a==null?void 0:a.vedlegg)||[]},d=await h.post("/soknad",n,{headers:{"content-type":"application/json;"}});s(d.data)},v={getPerson:Se,sendSøknad:Ee};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const je="startTransition",y=ee[je];function xe(e){let{basename:s,children:r,future:o,window:a}=e,l=i.useRef();l.current==null&&(l.current=te({window:a,v5Compat:!0}));let n=l.current,[d,m]=i.useState({action:n.action,location:n.location}),{v7_startTransition:u}=o||{},f=i.useCallback(g=>{u&&y?y(()=>m(g)):m(g)},[m,u]);return i.useLayoutEffect(()=>n.listen(f),[n,f]),i.createElement(ne,{basename:s,children:r,location:d.location,navigationType:d.action,navigator:n})}var N;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(N||(N={}));var O;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(O||(O={}));const C="selectedLocale",Ae=()=>sessionStorage.getItem(C)||"nb",ve=e=>{sessionStorage.setItem(C,e)},ye=e=>{const[s,r]=i.useState(),[o,a]=i.useState(!1),[l,n]=i.useState(null);return i.useEffect(()=>{let d=!1;return(async()=>{try{a(!0);const u=await e();d||r(u.data)}catch(u){n(u)}finally{a(!1)}})(),()=>{d=!0}},[e]),{data:s,loading:o,error:l}},M=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(Y,{size:"2xlarge"})}),Ne=({locale:e,onChangeLocale:s})=>{var f,g;const[r,o]=i.useState(!1),[a,l]=i.useState(),{data:n,loading:d,error:m}=ye(v.getPerson);if(m!==null)return((f=m.response)==null?void 0:f.status)===401||((g=m.response)==null?void 0:g.status)===403?t.jsx(M,{}):t.jsx(me,{onChangeLocale:s,locale:e});if(d||!n)return t.jsx(M,{});if(!X(n.fødselsdato))return t.jsx(ce,{person:n});const u=v.sendSøknad(e,l);return t.jsx(q,{children:t.jsxs(se,{children:[!r&&t.jsx(p,{path:"*",element:t.jsx(re,{to:c.VELKOMMEN})}),t.jsx(p,{path:c.VELKOMMEN,element:t.jsx(ae,{locale:e,onChangeLocale:s,startSøknad:o,erVelkommen:r})}),r&&t.jsxs(t.Fragment,{children:[t.jsx(p,{path:c.SØKERSITUASJON,element:t.jsx(oe,{})}),t.jsx(p,{path:c.OM_BARNET,element:t.jsx(ie,{kjønn:n.kjønn})}),t.jsx(p,{path:c.TERMINBEKREFTELSE,element:t.jsx(E,{})}),t.jsx(p,{path:c.ADOPSJONSBEKREFTELSE,element:t.jsx(E,{})}),t.jsx(p,{path:c.UTENLANDSOPPHOLD,element:t.jsx(le,{})}),t.jsx(p,{path:c.UTENLANDSOPPHOLD_PERIODER,element:t.jsx(de,{})}),t.jsx(p,{path:c.OPPSUMMERING,element:t.jsx(Q,{person:n,sendSøknad:u})}),t.jsx(p,{path:c.KVITTERING,element:t.jsx(pe,{person:n,kvittering:a})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const D=Ae();F.locale(D);const Oe=()=>{const[e,s]=i.useState(D),r=i.useCallback(o=>{ve(o),s(o)},[]);return t.jsx(Z,{språkkode:e,children:t.jsx(xe,{children:t.jsx(Ne,{locale:e,onChangeLocale:r})})})},K=Oe,Me={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},rt={title:"Applikasjon - Engangsstønad (AppContainer)",component:K},V=({person:e})=>{ue();const s=new G(h);return s.onGet("/personinfo").reply(200,e),s.onPost("/soknad").reply(200,Me),t.jsx(K,{})},S=V.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:w.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=V.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:w.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var T,b,R;S.parameters={...S.parameters,docs:{...(T=S.parameters)==null?void 0:T.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  return <AppContainer />;
}`,...(R=(b=S.parameters)==null?void 0:b.docs)==null?void 0:R.source}}};var I,U,L;k.parameters={...k.parameters,docs:{...(I=k.parameters)==null?void 0:I.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  return <AppContainer />;
}`,...(L=(U=k.parameters)==null?void 0:U.docs)==null?void 0:L.source}}};const ot=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,ot as __namedExportsOrder,rt as default};
//# sourceMappingURL=AppContainer.stories-f5105da1.js.map
