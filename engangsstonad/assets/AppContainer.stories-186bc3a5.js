import{j as t,o as Y,d as q}from"./fridagerUtils-35c8f66a.js";import{E as k,D as _,M as L}from"./DokumentasjonSteg-d427f43b.js";import{K as z,L as Q,O as W,n as F,b as y,Q as X,T as Z,U as ee,R as te,g as E,N as ne,P as S,V as se,W as re,E as ae,i as oe}from"./useEsNavigator-7a42d800.js";import{r as o,$ as ie}from"./_baseToString-53b0dbb2.js";import{d as K,e as ce,c as le,b as pe,a as de}from"./OmBarnet-2901dea5.js";import{e as ge,O as ue,K as V}from"./OppsummeringSteg-bec878cd.js";import{n as me,a as v,b as Ee,e as Se}from"./en_US-81b94afb.js";import"./_createSet-a1fd5098.js";import{S as fe}from"./SøkersituasjonSteg-652b17c4.js";import{V as ke}from"./Velkommen-b47cb663.js";import{O as he}from"./OmBarnetSteg-86d14cfb.js";import{U as Ae}from"./UtenlandsoppholdSteg-bbd26cd0.js";import{S as Ne}from"./SenereUtenlandsoppholdSteg-5852574a.js";import{T as xe}from"./TidligereUtenlandsoppholdSteg-679869d5.js";import"./index-b613d0ba.js";import"./v4-a960c1f4.js";import"./ErrorSummaryHookForm-f88578f5.js";import"./TidligereUtenlandsoppholdPanel-496da00c.js";const{Axios:ot,AxiosError:it,CanceledError:ct,isCancel:lt,CancelToken:pt,VERSION:dt,all:gt,Cancel:ut,isAxiosError:ye,spread:mt,toFormData:Et,AxiosHeaders:St,HttpStatusCode:ft,formToJSON:kt,getAdapter:ht,mergeConfig:At}=K;class f extends Error{constructor(s){super(s)}}class j extends Error{constructor(){super("API_ACCESS_ERROR")}}const je=e=>e instanceof j||e instanceof f,ve=e=>!!(e&&typeof e=="object"&&"isAxiosError"in e),Me=(e,s)=>{const[r,a]=o.useState(),[c,l]=o.useState(!1),[n,i]=o.useState();return o.useEffect(()=>{let p=!1;return(async()=>{var d,g;try{l(!0);const u=await e.get(s,{withCredentials:!0,timeout:60*1e3});p||a(u.data)}catch(u){ye(u)?((d=u.response)==null?void 0:d.status)===401||((g=u.response)==null?void 0:g.status)===403?i(new j):i(new f(u.message)):u instanceof Error?i(new f(u.message)):i(new f(String(u)))}finally{l(!1)}})(),()=>{p=!0}},[e,s]),{data:r,loading:c,error:n}},_e=e=>K.create({baseURL:e,withCredentials:!0}),b="ukjent uuid",Le="Det har oppstått et problem med innsending av søknaden. Vennligst prøv igjen senere. Hvis problemet vedvarer, kontakt oss og oppgi feil id: ",be=async(e,s,r,a)=>{var c,l;try{return(await e.post(r,a,{withCredentials:!0,timeout:6e4,headers:{"content-type":"application/json;"},signal:s})).data}catch(n){if(ve(n)&&n.code!=="ERR_CANCELED"){if(((c=n.response)==null?void 0:c.status)===401||((l=n.response)==null?void 0:l.status)===403)throw new j;const i=n.response&&n.response.data&&n.response.data.uuid?n.response.data.uuid:b,p=i!==b?i.slice(0,8):i;throw new f(Le+p)}throw n instanceof Error?new f(n.message):new f(String(n))}};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Ie="startTransition",I=ie[Ie];function Oe(e){let{basename:s,children:r,future:a,window:c}=e,l=o.useRef();l.current==null&&(l.current=z({window:c,v5Compat:!0}));let n=l.current,[i,p]=o.useState({action:n.action,location:n.location}),{v7_startTransition:m}=a||{},d=o.useCallback(g=>{m&&I?I(()=>p(g)):p(g)},[p,m]);return o.useLayoutEffect(()=>n.listen(d),[n,d]),o.createElement(Q,{basename:s,children:r,location:i.location,navigationType:i.action,navigator:n})}var O;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(O||(O={}));var R;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(R||(R={}));const B="selectedLocale",Re=()=>sessionStorage.getItem(B)||"nb",Te=e=>{sessionStorage.setItem(B,e)},G=e=>{window.location.href=e},we=e=>{G(e+"?redirect="+window.location.origin)},Ce=(e,s)=>{const r=(s==null?void 0:s.vedlegg.map(a=>a.id))||[];if(ce(e))return{type:"adopsjon",antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer.map(a=>a.dato),adopsjonsdato:e.adopsjonsdato,adopsjonAvEktefellesBarn:e.adopsjonAvEktefellesBarn,vedleggreferanser:r};if(le(e))return{type:"fødsel",antallBarn:e.antallBarn,fødselsdato:e.fødselsdato,vedleggreferanser:[]};if(pe(e)&&s&&ge(s))return{type:"termin",antallBarn:e.antallBarn,termindato:e.termindato,terminbekreftelseDato:s.terminbekreftelsedato,vedleggreferanser:r};throw Error("Det er feil i data om barnet")},De=(e,s,r)=>{const a=W(),[c,l]=o.useState(),n=o.useCallback(async i=>{const p=F(a(y.OM_BARNET)),m=a(y.DOKUMENTASJON),d=a(y.UTENLANDSOPPHOLD_TIDLIGERE),g=a(y.UTENLANDSOPPHOLD_SENERE),u={type:"engangsstønad",språkkode:s,barn:Ce(p,m),utenlandsopphold:{utenlandsoppholdSiste12Mnd:(d==null?void 0:d.utenlandsoppholdSiste12Mnd)||[],utenlandsoppholdNeste12Mnd:(g==null?void 0:g.utenlandsoppholdNeste12Mnd)||[]},vedlegg:(m==null?void 0:m.vedlegg)||[]};try{const x=await be(e,i,"/soknad/engangssoknad",u);r(x)}catch(x){if(je(x))l(x);else throw new Error("This should never happen")}},[a,s,r,e]);return o.useMemo(()=>({sendSøknad:n,errorSendSøknad:c}),[n,c])},N=_e(k.REST_API_URL),M=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(Y,{size:"2xlarge"})}),Pe=({locale:e,onChangeLocale:s})=>{const[r,a]=o.useState(!1),[c,l]=o.useState(),{data:n,loading:i,error:p}=Me(N,"/personinfo"),{sendSøknad:m,errorSendSøknad:d}=De(N,e,l);if(c)return k.INNSYN?(G(c.saksNr?`${k.INNSYN}/sak/${c.saksNr}/redirectFromSoknad`:`${k.INNSYN}/redirectFromSoknad`),t.jsx(M,{})):t.jsx("div",{children:"Redirected to Innsyn"});if(p||d){const g=F(p||d);return g instanceof j?(we(k.LOGIN_URL),t.jsx(M,{})):t.jsx(X,{appName:"Engangsstønad",errorMessage:g.message,retryCallback:()=>location.reload()})}return i||!n?t.jsx(M,{}):Z(n.fødselsdato)?t.jsxs(te,{children:[!r&&t.jsx(E,{path:"*",element:t.jsx(ne,{to:S.VELKOMMEN})}),t.jsx(E,{path:S.VELKOMMEN,element:t.jsx(ke,{locale:e,onChangeLocale:s,startSøknad:a,erVelkommen:r})}),r&&t.jsxs(t.Fragment,{children:[t.jsx(E,{path:S.SØKERSITUASJON,element:t.jsx(fe,{})}),t.jsx(E,{path:S.OM_BARNET,element:t.jsx(he,{kjønn:n.kjønn})}),t.jsx(E,{path:S.TERMINBEKREFTELSE,element:t.jsx(_,{})}),t.jsx(E,{path:S.ADOPSJONSBEKREFTELSE,element:t.jsx(_,{})}),t.jsx(E,{path:S.UTENLANDSOPPHOLD,element:t.jsx(Ae,{})}),t.jsx(E,{path:S.TIDLIGERE_UTENLANDSOPPHOLD,element:t.jsx(xe,{})}),t.jsx(E,{path:S.SENERE_UTENLANDSOPPHOLD,element:t.jsx(Ne,{})}),t.jsx(E,{path:S.OPPSUMMERING,element:t.jsx(ue,{person:n,sendSøknad:m})})]})]}):t.jsx(ee,{appnavn:"Engangsstønad"})};try{N.displayName="esApi",N.__docgenInfo={description:"",displayName:"esApi",props:{}}}catch{}try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: LocaleAll) => void"}}}}}catch{}const H=Re(),Ue={nb:{...me,...v.nb},nn:{...Ee,...v.nn},en:{...Se,...v.en}};q.locale(H);const Fe=()=>location.reload(),Ke=()=>{const[e,s]=o.useState(H),r=o.useCallback(a=>{Te(a),s(a)},[]);return t.jsx(se,{locale:e,messagesGroupedByLocale:Ue,children:t.jsx(re,{appName:"Engangsstønad",retryCallback:Fe,children:t.jsx(ae,{children:t.jsx(Oe,{children:t.jsx(Pe,{locale:e,onChangeLocale:r})})})})})},$=Ke,Ve={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},Nt={title:"Applikasjon - Engangsstønad (AppContainer)",component:$},J=({person:e})=>{oe();const s=new L(N);s.onGet("/personinfo").reply(200,e),s.onPost("/soknad/engangssoknad").reply(200,Ve);const r=new L(de);return r.onPost("/storage/vedlegg").reply(200),r.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx($,{})},h=J.bind({});h.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:V.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const A=J.bind({});A.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:V.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var T,w,C;h.parameters={...h.parameters,docs:{...(T=h.parameters)==null?void 0:T.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(esApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(C=(w=h.parameters)==null?void 0:w.docs)==null?void 0:C.source}}};var D,P,U;A.parameters={...A.parameters,docs:{...(D=A.parameters)==null?void 0:D.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(esApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(U=(P=A.parameters)==null?void 0:P.docs)==null?void 0:U.source}}};const xt=["SøkerErKvinne","SøkerErMann"];export{h as SøkerErKvinne,A as SøkerErMann,xt as __namedExportsOrder,Nt as default};
//# sourceMappingURL=AppContainer.stories-186bc3a5.js.map
