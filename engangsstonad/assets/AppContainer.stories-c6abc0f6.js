import{j as t}from"./jsx-runtime-69eee039.js";import{E,D as j,M as x}from"./DokumentasjonSteg-3bab1a91.js";import{b as K,e as V,c as B,d as G,a as $}from"./attachmentApi-9c5aabf9.js";import{v as q,w as H,x as J,d as Y,R as z,e as d,N as Q,P as g}from"./useEsNavigator-61231b98.js";import{e as W,O as X}from"./OppsummeringSteg-f8c4becd.js";import{r as l,$ as Z}from"./index-7c191284.js";import{o as ee,p as te,j as ne,I as se,q as re,i as ae}from"./IntlProvider-d65b7afd.js";import"./_baseToString-8992fead.js";import"./_createSet-409f46e6.js";import{S as oe}from"./SøkersituasjonSteg-184942ca.js";import{V as ie}from"./Velkommen-610afa1c.js";import{O as le}from"./OmBarnetSteg-e1343be5.js";import{U as ce}from"./UtenlandsoppholdSteg-84b1fa11.js";import{U as pe}from"./Umyndig-8feaea54.js";import{S as de}from"./SenereUtenlandsoppholdSteg-b864d16a.js";import{T as ge}from"./TidligereUtenlandsoppholdSteg-47cd88ad.js";import{K as O}from"./Person-12835ba1.js";import"./ErrorSummaryHookForm-9df6c39a.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./Søkersituasjon-b1a475fe.js";const w=e=>{window.location.href=e},ue=e=>{w(e+"?redirect="+window.location.origin)},A="ukjent uuid",me="Det har oppstått et problem med innsending av søknaden. Vennligst prøv igjen senere. Hvis problemet vedvarer, kontakt oss og oppgi feil id: ",fe=e=>!!(e&&typeof e=="object"&&"isAxiosError"in e),h=K.create({baseURL:E.REST_API_URL,withCredentials:!0});h.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));const Se=[401,403];h.interceptors.response.use(e=>e,e=>{var n;return e.response&&Se.includes(e.response.status)&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad/engangssoknad")&&ue(E.LOGIN_URL),Promise.reject(e)});const ke=()=>h.get("/personinfo"),Ee=(e,n)=>{const r=(n==null?void 0:n.vedlegg.map(o=>o.id))||[];if(V(e))return{type:"adopsjon",antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer.map(o=>o.dato),adopsjonsdato:e.adopsjonsdato,adopsjonAvEktefellesBarn:e.adopsjonAvEktefellesBarn,vedleggreferanser:r};if(B(e))return{type:"fødsel",antallBarn:e.antallBarn,fødselsdato:e.fødselsdato,vedleggreferanser:[]};if(G(e)&&n&&W(n))return{type:"termin",antallBarn:e.antallBarn,termindato:e.termindato,terminbekreftelseDato:n.terminbekreftelsedato,vedleggreferanser:r};throw Error("Det er feil i data om barnet")},he=(e,n)=>async(r,o,i,p,a)=>{const u={type:"engangsstønad",språkkode:e,barn:Ee(o,i),utenlandsopphold:{utenlandsoppholdSiste12Mnd:(p==null?void 0:p.utenlandsoppholdSiste12Mnd)||[],utenlandsoppholdNeste12Mnd:(a==null?void 0:a.utenlandsoppholdNeste12Mnd)||[]},vedlegg:(i==null?void 0:i.vedlegg)||[]};try{const s=await h.post("/soknad/engangssoknad",u,{headers:{"content-type":"application/json;"},signal:r});n(s.data)}catch(s){if(fe(s)&&s.code!=="ERR_CANCELED"){const c=s.response&&s.response.data&&s.response.data.uuid?s.response.data.uuid:A,m=c!==A?c.slice(0,8):c;n(()=>{throw new Error(me+m)})}}},N={getPerson:ke,getSendSøknad:he},ve=e=>{const[n,r]=l.useState(),[o,i]=l.useState(!1),[p,a]=l.useState(null);return l.useEffect(()=>{let u=!1;return(async()=>{try{i(!0);const c=await e();u||r(c.data)}catch(c){a(c)}finally{i(!1)}})(),()=>{u=!0}},[e]),{data:n,loading:o,error:p}};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const je="startTransition",y=Z[je];function xe(e){let{basename:n,children:r,future:o,window:i}=e,p=l.useRef();p.current==null&&(p.current=q({window:i,v5Compat:!0}));let a=p.current,[u,s]=l.useState({action:a.action,location:a.location}),{v7_startTransition:c}=o||{},m=l.useCallback(f=>{c&&y?y(()=>s(f)):s(f)},[s,c]);return l.useLayoutEffect(()=>a.listen(m),[a,m]),l.createElement(H,{basename:n,children:r,location:u.location,navigationType:u.action,navigator:a})}var M;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(M||(M={}));var I;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(I||(I={}));const D="selectedLocale",Ae=()=>sessionStorage.getItem(D)||"nb",Ne=e=>{sessionStorage.setItem(D,e)},v=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(te,{size:"2xlarge"})}),ye=({locale:e,onChangeLocale:n})=>{var m,f;const[r,o]=l.useState(!1),[i,p]=l.useState(),{data:a,loading:u,error:s}=ve(N.getPerson);if(i)return E.INNSYN?(w(i.saksNr?`${E.INNSYN}/sak/${i.saksNr}/redirectFromSoknad`:`${E.INNSYN}/redirectFromSoknad`),t.jsx(v,{})):t.jsx("div",{children:"Redirected to Innsyn"});if(s!==null)return((m=s.response)==null?void 0:m.status)===401||((f=s.response)==null?void 0:f.status)===403?t.jsx(v,{}):t.jsx(ee,{appnavn:"Engangsstønad",feilmelding:s.message,søkPåNytt:()=>location.reload()});if(u||!a)return t.jsx(v,{});if(!J(a.fødselsdato))return t.jsx(pe,{person:a});const c=N.getSendSøknad(e,p);return t.jsx(Y,{children:t.jsxs(z,{children:[!r&&t.jsx(d,{path:"*",element:t.jsx(Q,{to:g.VELKOMMEN})}),t.jsx(d,{path:g.VELKOMMEN,element:t.jsx(ie,{locale:e,onChangeLocale:n,startSøknad:o,erVelkommen:r})}),r&&t.jsxs(t.Fragment,{children:[t.jsx(d,{path:g.SØKERSITUASJON,element:t.jsx(oe,{})}),t.jsx(d,{path:g.OM_BARNET,element:t.jsx(le,{kjønn:a.kjønn})}),t.jsx(d,{path:g.TERMINBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(d,{path:g.ADOPSJONSBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(d,{path:g.UTENLANDSOPPHOLD,element:t.jsx(ce,{})}),t.jsx(d,{path:g.TIDLIGERE_UTENLANDSOPPHOLD,element:t.jsx(ge,{})}),t.jsx(d,{path:g.SENERE_UTENLANDSOPPHOLD,element:t.jsx(de,{})}),t.jsx(d,{path:g.OPPSUMMERING,element:t.jsx(X,{person:a,sendSøknad:c})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const C=Ae();ne.locale(C);const Me=()=>{const[e,n]=l.useState(C),r=l.useCallback(o=>{Ne(o),n(o)},[]);return t.jsx(se,{språkkode:e,children:t.jsx(re,{appnavn:"Engangsstønad",children:t.jsx(xe,{children:t.jsx(ye,{locale:e,onChangeLocale:r})})})})},F=Me,Ie={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},ze={title:"Applikasjon - Engangsstønad (AppContainer)",component:F},U=({person:e})=>{ae();const n=new x(h);n.onGet("/personinfo").reply(200,e),n.onPost("/soknad/engangssoknad").reply(200,Ie);const r=new x($);return r.onPost("/storage/vedlegg").reply(200),r.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx(F,{})},S=U.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:O.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=U.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:O.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var R,b,L;S.parameters={...S.parameters,docs:{...(R=S.parameters)==null?void 0:R.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(L=(b=S.parameters)==null?void 0:b.docs)==null?void 0:L.source}}};var P,T,_;k.parameters={...k.parameters,docs:{...(P=k.parameters)==null?void 0:P.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(_=(T=k.parameters)==null?void 0:T.docs)==null?void 0:_.source}}};const Qe=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,Qe as __namedExportsOrder,ze as default};
//# sourceMappingURL=AppContainer.stories-c6abc0f6.js.map
