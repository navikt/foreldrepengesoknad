import{j as t}from"./jsx-runtime-69eee039.js";import{b as C,E as R,D as j,M as D}from"./DokumentasjonSteg-67cab06c.js";import{e as K,b as V,a as B}from"./Attachment-f7d69364.js";import{e as G,O as $}from"./OppsummeringSteg-4a27ca1a.js";import{n as q,d as H}from"./useEsNavigator-db836096.js";import{r as o,$ as J}from"./index-7c191284.js";import{e as z,f as W,R as X,a as c,N as Q,P as l}from"./paths-77448497.js";import{W as Y,X as Z,k as ee,I as te}from"./IntlProvider-6f18ce9f.js";import{S as ne}from"./SøkersituasjonSteg-25cf75fe.js";import{V as se}from"./Velkommen-e1e90ba8.js";import{O as re}from"./OmBarnetSteg-896d23fe.js";import{U as oe}from"./UtenlandsoppholdSteg-fe15692a.js";import{S as ae}from"./SøknadSendt-e73700ef.js";import{U as ie}from"./Umyndig-21e74bcc.js";import{N as pe}from"./NesteUtenlandsoppholdSteg-d88dd3f9.js";import{S as ce}from"./SisteUtenlandsoppholdSteg-604423e5.js";import{F as le}from"./FeilsideInfo-4a5a331d.js";import{K as P}from"./Person-12835ba1.js";import{i as me}from"./amplitude-a97f1527.js";import"./StepButtonsHookForm-ef5a06d8.js";import"./StepButtons-a9e02238.js";import"./Datepicker-50ebcfd3.js";import"./extends-2f8ee675.js";import"./index-ecbee218.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./RadioGroupPanel-1dfd0bb6.js";import"./Søkersituasjon-b1a475fe.js";import"./lenker-72d0e735.js";import"./ContentWrapper-3f88fdd7.js";import"./Select-cd02e5c6.js";import"./lenker-a38ed3bb.js";import"./countryUtils-91d8df56.js";import"./Feilside-fd6a488a.js";const de=e=>{window.location.href=e},ue=e=>{de(e+"?redirect="+window.location.origin)},E=C.create({baseURL:R.REST_API_URL,withCredentials:!0});E.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));E.interceptors.response.use(e=>e,e=>{var n;return e.response&&e.response.status===401&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad")&&ue(R.LOGIN_URL),Promise.reject(e)});const fe=()=>E.get("/personinfo"),ge=(e,n)=>{if(K(e)||V(e))return{...e,fødselsdatoer:e.fødselsdatoer.map(r=>r.dato)};if(B(e)&&n&&G(n))return{...e,terminbekreftelsedato:n.terminbekreftelsedato};throw Error("Det er feil i data om barnet")},x=(e=[])=>e.map(n=>({land:n.landkode,tidsperiode:{fom:n.fom,tom:n.tom}})),Se=(e,n)=>async(r,a,i,p,s)=>{q(a);const d={barn:ge(r,i),type:"engangsstønad",erEndringssøknad:!1,informasjonOmUtenlandsopphold:{iNorgeSiste12Mnd:a.harBoddUtenforNorgeSiste12Mnd,iNorgeNeste12Mnd:a.skalBoUtenforNorgeNeste12Mnd,tidligereOpphold:x(p==null?void 0:p.utenlandsoppholdSiste12Mnd),senereOpphold:x(s==null?void 0:s.utenlandsoppholdNeste12Mnd)},søker:{språkkode:e},vedlegg:(i==null?void 0:i.vedlegg)||[]},m=await E.post("/soknad",d,{headers:{"content-type":"application/json;"}});n(m.data)},h={getPerson:fe,sendSøknad:Se};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ke="startTransition",N=J[ke];function Ee(e){let{basename:n,children:r,future:a,window:i}=e,p=o.useRef();p.current==null&&(p.current=z({window:i,v5Compat:!0}));let s=p.current,[d,m]=o.useState({action:s.action,location:s.location}),{v7_startTransition:u}=a||{},f=o.useCallback(g=>{u&&N?N(()=>m(g)):m(g)},[m,u]);return o.useLayoutEffect(()=>s.listen(f),[s,f]),o.createElement(W,{basename:n,children:r,location:d.location,navigationType:d.action,navigator:s})}var v;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(v||(v={}));var A;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(A||(A={}));const _="selectedLocale",je=()=>sessionStorage.getItem(_)||"nb",xe=e=>{sessionStorage.setItem(_,e)},he=e=>{const[n,r]=o.useState(),[a,i]=o.useState(!1),[p,s]=o.useState(null);return o.useEffect(()=>{let d=!1;return(async()=>{try{i(!0);const u=await e();d||r(u.data)}catch(u){s(u)}finally{i(!1)}})(),()=>{d=!0}},[e]),{data:n,loading:a,error:p}},y=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(Z,{size:"2xlarge"})}),Ne=({locale:e,onChangeLocale:n})=>{var f,g;const[r,a]=o.useState(!1),[i,p]=o.useState(),{data:s,loading:d,error:m}=he(h.getPerson);if(m!==null)return((f=m.response)==null?void 0:f.status)===401||((g=m.response)==null?void 0:g.status)===403?t.jsx(y,{}):t.jsx(le,{onChangeLocale:n,locale:e});if(d||!s)return t.jsx(y,{});if(!Y(s.fødselsdato))return t.jsx(ie,{person:s});const u=h.sendSøknad(e,p);return t.jsx(H,{children:t.jsxs(X,{children:[!r&&t.jsx(c,{path:"*",element:t.jsx(Q,{to:l.VELKOMMEN})}),t.jsx(c,{path:l.VELKOMMEN,element:t.jsx(se,{locale:e,onChangeLocale:n,startSøknad:a,erVelkommen:r})}),r&&t.jsxs(t.Fragment,{children:[t.jsx(c,{path:l.SØKERSITUASJON,element:t.jsx(ne,{})}),t.jsx(c,{path:l.OM_BARNET,element:t.jsx(re,{kjønn:s.kjønn})}),t.jsx(c,{path:l.TERMINBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(c,{path:l.ADOPSJONSBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(c,{path:l.UTENLANDSOPPHOLD,element:t.jsx(oe,{})}),t.jsx(c,{path:l.SISTE_UTENLANDSOPPHOLD,element:t.jsx(ce,{})}),t.jsx(c,{path:l.NESTE_UTENLANDSOPPHOLD,element:t.jsx(pe,{})}),t.jsx(c,{path:l.OPPSUMMERING,element:t.jsx($,{person:s,sendSøknad:u})}),t.jsx(c,{path:l.KVITTERING,element:t.jsx(ae,{person:s,kvittering:i})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const U=je();ee.locale(U);const ve=()=>{const[e,n]=o.useState(U),r=o.useCallback(a=>{xe(a),n(a)},[]);return t.jsx(te,{språkkode:e,children:t.jsx(Ee,{children:t.jsx(Ne,{locale:e,onChangeLocale:r})})})},w=ve,Ae={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},ot={title:"Applikasjon - Engangsstønad (AppContainer)",component:w},F=({person:e})=>{me();const n=new D(E);return n.onGet("/personinfo").reply(200,e),n.onPost("/soknad").reply(200,Ae),t.jsx(w,{})},S=F.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:P.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=F.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:P.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var M,b,T;S.parameters={...S.parameters,docs:{...(M=S.parameters)==null?void 0:M.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  return <AppContainer />;
}`,...(T=(b=S.parameters)==null?void 0:b.docs)==null?void 0:T.source}}};var L,O,I;k.parameters={...k.parameters,docs:{...(L=k.parameters)==null?void 0:L.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  return <AppContainer />;
}`,...(I=(O=k.parameters)==null?void 0:O.docs)==null?void 0:I.source}}};const at=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,at as __namedExportsOrder,ot as default};
//# sourceMappingURL=AppContainer.stories-f4f62b2f.js.map
