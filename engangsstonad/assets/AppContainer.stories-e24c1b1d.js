import{j as t}from"./jsx-runtime-69eee039.js";import{b as C,E as R,D as j,M as D}from"./DokumentasjonSteg-38f467d0.js";import{e as K,b as V,a as B}from"./Attachment-03ccfb9d.js";import{e as G,O as $}from"./OppsummeringSteg-f9931f24.js";import{n as q,d as H}from"./useEsNavigator-196eef3f.js";import{r as o,$ as J}from"./index-7c191284.js";import{e as z,f as W,R as Q,a as p,N as X,P as l}from"./paths-77448497.js";import{U as Y,W as Z,j as ee,I as te}from"./IntlProvider-6b2e8efe.js";import{S as ne}from"./SøkersituasjonSteg-ba5e20fa.js";import{V as se}from"./Velkommen-86f05174.js";import{O as re}from"./OmBarnetSteg-1813ac31.js";import{U as oe}from"./UtenlandsoppholdSteg-c9667c7a.js";import{S as ae}from"./SøknadSendt-64663102.js";import{U as ie}from"./Umyndig-69403cf7.js";import{N as ce}from"./NesteUtenlandsoppholdSteg-a56cc7ec.js";import{S as pe}from"./SisteUtenlandsoppholdSteg-96f042f7.js";import{F as le}from"./FeilsideInfo-949f9c3a.js";import{K as P}from"./Person-12835ba1.js";import{i as de}from"./amplitude-a97f1527.js";import"./index.es-1c07523a.js";import"./valideringsregler-4276fa64.js";import"./extends-2f8ee675.js";import"./index-ecbee218.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./Søkersituasjon-b1a475fe.js";import"./lenker-72d0e735.js";import"./ContentWrapper-e55a945d.js";import"./lenker-a38ed3bb.js";import"./countryUtils-8377bc9a.js";import"./Feilside-c4a4e46f.js";const me=e=>{window.location.href=e},ue=e=>{me(e+"?redirect="+window.location.origin)},E=C.create({baseURL:R.REST_API_URL,withCredentials:!0});E.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));E.interceptors.response.use(e=>e,e=>{var n;return e.response&&e.response.status===401&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad")&&ue(R.LOGIN_URL),Promise.reject(e)});const fe=()=>E.get("/personinfo"),ge=(e,n)=>{if(K(e)||V(e))return{...e,fødselsdatoer:e.fødselsdatoer.map(r=>r.dato)};if(B(e)&&n&&G(n))return{...e,terminbekreftelsedato:n.terminbekreftelsedato};throw Error("Det er feil i data om barnet")},x=(e=[])=>e.map(n=>({land:n.landkode,tidsperiode:{fom:n.fom,tom:n.tom}})),Se=(e,n)=>async(r,a,i,c,s)=>{q(a);const m={barn:ge(r,i),type:"engangsstønad",erEndringssøknad:!1,informasjonOmUtenlandsopphold:{iNorgeSiste12Mnd:a.harBoddUtenforNorgeSiste12Mnd,iNorgeNeste12Mnd:a.skalBoUtenforNorgeNeste12Mnd,tidligereOpphold:x(c==null?void 0:c.utenlandsoppholdSiste12Mnd),senereOpphold:x(s==null?void 0:s.utenlandsoppholdNeste12Mnd)},søker:{språkkode:e},vedlegg:(i==null?void 0:i.vedlegg)||[]},d=await E.post("/soknad",m,{headers:{"content-type":"application/json;"}});n(d.data)},h={getPerson:fe,sendSøknad:Se};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ke="startTransition",N=J[ke];function Ee(e){let{basename:n,children:r,future:a,window:i}=e,c=o.useRef();c.current==null&&(c.current=z({window:i,v5Compat:!0}));let s=c.current,[m,d]=o.useState({action:s.action,location:s.location}),{v7_startTransition:u}=a||{},f=o.useCallback(g=>{u&&N?N(()=>d(g)):d(g)},[d,u]);return o.useLayoutEffect(()=>s.listen(f),[s,f]),o.createElement(W,{basename:n,children:r,location:m.location,navigationType:m.action,navigator:s})}var v;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(v||(v={}));var A;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(A||(A={}));const _="selectedLocale",je=()=>sessionStorage.getItem(_)||"nb",xe=e=>{sessionStorage.setItem(_,e)},he=e=>{const[n,r]=o.useState(),[a,i]=o.useState(!1),[c,s]=o.useState(null);return o.useEffect(()=>{let m=!1;return(async()=>{try{i(!0);const u=await e();m||r(u.data)}catch(u){s(u)}finally{i(!1)}})(),()=>{m=!0}},[e]),{data:n,loading:a,error:c}},y=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(Z,{size:"2xlarge"})}),Ne=({locale:e,onChangeLocale:n})=>{var f,g;const[r,a]=o.useState(!1),[i,c]=o.useState(),{data:s,loading:m,error:d}=he(h.getPerson);if(d!==null)return((f=d.response)==null?void 0:f.status)===401||((g=d.response)==null?void 0:g.status)===403?t.jsx(y,{}):t.jsx(le,{onChangeLocale:n,locale:e});if(m||!s)return t.jsx(y,{});if(!Y(s.fødselsdato))return t.jsx(ie,{person:s});const u=h.sendSøknad(e,c);return t.jsx(H,{children:t.jsxs(Q,{children:[!r&&t.jsx(p,{path:"*",element:t.jsx(X,{to:l.VELKOMMEN})}),t.jsx(p,{path:l.VELKOMMEN,element:t.jsx(se,{locale:e,onChangeLocale:n,startSøknad:a,erVelkommen:r})}),r&&t.jsxs(t.Fragment,{children:[t.jsx(p,{path:l.SØKERSITUASJON,element:t.jsx(ne,{})}),t.jsx(p,{path:l.OM_BARNET,element:t.jsx(re,{kjønn:s.kjønn})}),t.jsx(p,{path:l.TERMINBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(p,{path:l.ADOPSJONSBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(p,{path:l.UTENLANDSOPPHOLD,element:t.jsx(oe,{})}),t.jsx(p,{path:l.SISTE_UTENLANDSOPPHOLD,element:t.jsx(pe,{})}),t.jsx(p,{path:l.NESTE_UTENLANDSOPPHOLD,element:t.jsx(ce,{})}),t.jsx(p,{path:l.OPPSUMMERING,element:t.jsx($,{person:s,sendSøknad:u})}),t.jsx(p,{path:l.KVITTERING,element:t.jsx(ae,{person:s,kvittering:i})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const U=je();ee.locale(U);const ve=()=>{const[e,n]=o.useState(U),r=o.useCallback(a=>{xe(a),n(a)},[]);return t.jsx(te,{språkkode:e,children:t.jsx(Ee,{children:t.jsx(Ne,{locale:e,onChangeLocale:r})})})},w=ve,Ae={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},nt={title:"Applikasjon - Engangsstønad (AppContainer)",component:w},F=({person:e})=>{de();const n=new D(E);return n.onGet("/personinfo").reply(200,e),n.onPost("/soknad").reply(200,Ae),t.jsx(w,{})},S=F.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:P.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=F.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:P.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var M,b,T;S.parameters={...S.parameters,docs:{...(M=S.parameters)==null?void 0:M.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  return <AppContainer />;
}`,...(T=(b=S.parameters)==null?void 0:b.docs)==null?void 0:T.source}}};var L,O,I;k.parameters={...k.parameters,docs:{...(L=k.parameters)==null?void 0:L.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  return <AppContainer />;
}`,...(I=(O=k.parameters)==null?void 0:O.docs)==null?void 0:I.source}}};const st=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,st as __namedExportsOrder,nt as default};
//# sourceMappingURL=AppContainer.stories-e24c1b1d.js.map
