import{j as t}from"./jsx-runtime-69eee039.js";import{b as V,E,D as N,M as j,a as B}from"./DokumentasjonSteg-551c1274.js";import"./countryUtils-ea39d97c.js";import{t as G,v as $,g as H,I as q}from"./IntlProvider-705c2bb3.js";import{n as J,f as Y,g as z,d as Q,R as W,e as d,N as X,P as m}from"./useEsNavigator-8eca5e12.js";import{e as Z,a as ee,b as te}from"./Attachment-0260a327.js";import{e as ne,O as se}from"./OppsummeringSteg-7ddfedfc.js";import{r as i,$ as re}from"./index-7c191284.js";import{E as oe}from"./StepButtons-32021d55.js";import{S as ae}from"./SøkersituasjonSteg-db31b512.js";import{V as ie}from"./Velkommen-8f402842.js";import{O as ce}from"./OmBarnetSteg-4f32d9d9.js";import{U as pe}from"./UtenlandsoppholdSteg-1eecc6af.js";import{U as le}from"./Umyndig-21698b26.js";import{F as de}from"./FeilsideInfo-eb6a47f4.js";import{S as me}from"./SenereUtenlandsoppholdSteg-863ad5e8.js";import{T as ue}from"./TidligereUtenlandsoppholdSteg-042a8105.js";import{K as U}from"./Person-12835ba1.js";import{i as ge}from"./amplitude-a97f1527.js";import"./ErrorSummaryHookForm-581b703a.js";import"./extends-2f8ee675.js";import"./index-ecbee218.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./dateUtils-f49d068a.js";import"./Søkersituasjon-b1a475fe.js";import"./links-b4497713.js";import"./Feilside-d86aa690.js";const w=e=>{window.location.href=e},fe=e=>{w(e+"?redirect="+window.location.origin)},x="ukjent uuid",Se="Det har oppstått et problem med innsending av søknaden. Vennligst prøv igjen senere. Hvis problemet vedvarer, kontakt oss og oppgi feil id: ",ke=e=>!!(e&&typeof e=="object"&&"isAxiosError"in e),h=V.create({baseURL:E.REST_API_URL,withCredentials:!0});h.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));h.interceptors.response.use(e=>e,e=>{var n;return e.response&&e.response.status===401&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad")&&fe(E.LOGIN_URL),Promise.reject(e)});const Ee=()=>h.get("/personinfo"),he=(e,n)=>{if(Z(e)||ee(e))return{...e,fødselsdatoer:e.fødselsdatoer.map(r=>r.dato)};if(te(e)&&n&&ne(n))return{...e,terminbekreftelsedato:n.terminbekreftelsedato};throw Error("Det er feil i data om barnet")},A=(e=[])=>e.map(n=>({land:n.landkode,tidsperiode:{fom:n.fom,tom:n.tom}})),Ne=(e,n)=>async(r,c,a,l,s)=>{J(c);const u={barn:he(r,a),type:"engangsstønad",erEndringssøknad:!1,informasjonOmUtenlandsopphold:{iNorgeSiste12Mnd:c.harBoddUtenforNorgeSiste12Mnd,iNorgeNeste12Mnd:c.skalBoUtenforNorgeNeste12Mnd,tidligereOpphold:A(l==null?void 0:l.utenlandsoppholdSiste12Mnd),senereOpphold:A(s==null?void 0:s.utenlandsoppholdNeste12Mnd)},søker:{språkkode:e},vedlegg:(a==null?void 0:a.vedlegg)||[]};try{const o=await h.post("/soknad",u,{headers:{"content-type":"application/json;"}});n(o.data)}catch(o){if(ke(o)){const p=o.response&&o.response.data&&o.response.data.uuid?o.response.data.uuid:x,g=p!==x?p.slice(0,8):p;n(()=>{throw new Error(Se+g)})}}},v={getPerson:Ee,sendSøknad:Ne},je=e=>{const[n,r]=i.useState(),[c,a]=i.useState(!1),[l,s]=i.useState(null);return i.useEffect(()=>{let u=!1;return(async()=>{try{a(!0);const p=await e();u||r(p.data)}catch(p){s(p)}finally{a(!1)}})(),()=>{u=!0}},[e]),{data:n,loading:c,error:l}};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const xe="startTransition",y=re[xe];function Ae(e){let{basename:n,children:r,future:c,window:a}=e,l=i.useRef();l.current==null&&(l.current=Y({window:a,v5Compat:!0}));let s=l.current,[u,o]=i.useState({action:s.action,location:s.location}),{v7_startTransition:p}=c||{},g=i.useCallback(f=>{p&&y?y(()=>o(f)):o(f)},[o,p]);return i.useLayoutEffect(()=>s.listen(g),[s,g]),i.createElement(z,{basename:n,children:r,location:u.location,navigationType:u.action,navigator:s})}var M;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(M||(M={}));var I;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(I||(I={}));const D="selectedLocale",ve=()=>sessionStorage.getItem(D)||"nb",ye=e=>{sessionStorage.setItem(D,e)},b=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx($,{size:"2xlarge"})}),Me=({locale:e,onChangeLocale:n})=>{var g,f;const[r,c]=i.useState(!1),[a,l]=i.useState(),{data:s,loading:u,error:o}=je(v.getPerson);if(a)return E.INNSYN_SAK&&w(a.saksNr?`${E.INNSYN_SAK}${a.saksNr}`:E.INNSYN),t.jsx("div",{children:"Redirected to Innsyn"});if(o!==null)return((g=o.response)==null?void 0:g.status)===401||((f=o.response)==null?void 0:f.status)===403?t.jsx(b,{}):t.jsx(de,{onChangeLocale:n,locale:e});if(u||!s)return t.jsx(b,{});if(!G(s.fødselsdato))return t.jsx(le,{person:s});const p=v.sendSøknad(e,l);return t.jsx(Q,{children:t.jsxs(W,{children:[!r&&t.jsx(d,{path:"*",element:t.jsx(X,{to:m.VELKOMMEN})}),t.jsx(d,{path:m.VELKOMMEN,element:t.jsx(ie,{locale:e,onChangeLocale:n,startSøknad:c,erVelkommen:r})}),r&&t.jsxs(t.Fragment,{children:[t.jsx(d,{path:m.SØKERSITUASJON,element:t.jsx(ae,{})}),t.jsx(d,{path:m.OM_BARNET,element:t.jsx(ce,{kjønn:s.kjønn})}),t.jsx(d,{path:m.TERMINBEKREFTELSE,element:t.jsx(N,{})}),t.jsx(d,{path:m.ADOPSJONSBEKREFTELSE,element:t.jsx(N,{})}),t.jsx(d,{path:m.UTENLANDSOPPHOLD,element:t.jsx(pe,{})}),t.jsx(d,{path:m.TIDLIGERE_UTENLANDSOPPHOLD,element:t.jsx(ue,{})}),t.jsx(d,{path:m.SENERE_UTENLANDSOPPHOLD,element:t.jsx(me,{})}),t.jsx(d,{path:m.OPPSUMMERING,element:t.jsx(se,{person:s,sendSøknad:p})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const F=ve();H.locale(F);const Ie=()=>{const[e,n]=i.useState(F),r=i.useCallback(c=>{ye(c),n(c)},[]);return t.jsx(oe,{children:t.jsx(q,{språkkode:e,children:t.jsx(Ae,{children:t.jsx(Me,{locale:e,onChangeLocale:r})})})})},C=Ie,be={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},st={title:"Applikasjon - Engangsstønad (AppContainer)",component:C},K=({person:e})=>{ge();const n=new j(h);n.onGet("/personinfo").reply(200,e),n.onPost("/soknad").reply(200,be);const r=new j(B);return r.onPost("/storage/vedlegg").reply(200),r.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx(C,{})},S=K.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:U.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=K.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:U.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var L,T,O;S.parameters={...S.parameters,docs:{...(L=S.parameters)==null?void 0:L.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(O=(T=S.parameters)==null?void 0:T.docs)==null?void 0:O.source}}};var P,R,_;k.parameters={...k.parameters,docs:{...(P=k.parameters)==null?void 0:P.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(_=(R=k.parameters)==null?void 0:R.docs)==null?void 0:_.source}}};const rt=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,rt as __namedExportsOrder,st as default};
//# sourceMappingURL=AppContainer.stories-b8b51b09.js.map
