import{j as t}from"./jsx-runtime-69eee039.js";import{E,D as j,M as x}from"./DokumentasjonSteg-13671189.js";import{b as K,e as V,c as B,d as G,a as $}from"./Attachment-512881c1.js";import{v as q,w as H,x as J,d as Y,R as z,e as d,N as Q,P as g}from"./useEsNavigator-96d67a58.js";import{e as W,O as X}from"./OppsummeringSteg-274633ca.js";import{r as l,$ as Z}from"./index-7c191284.js";import{o as ee,p as te,j as ne,I as se,q as ae,i as re}from"./IntlProvider-e904c8b8.js";import"./_baseToString-8992fead.js";import"./_createSet-409f46e6.js";import{S as oe}from"./SøkersituasjonSteg-1ba235ff.js";import{V as ie}from"./Velkommen-585001d2.js";import{O as le}from"./OmBarnetSteg-b102499a.js";import{U as ce}from"./UtenlandsoppholdSteg-50fb566d.js";import{U as pe}from"./Umyndig-c0bfc962.js";import{S as de}from"./SenereUtenlandsoppholdSteg-e6793976.js";import{T as ge}from"./TidligereUtenlandsoppholdSteg-88543d1e.js";import{K as O}from"./Person-12835ba1.js";import"./ErrorSummaryHookForm-a1094fbf.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./Søkersituasjon-b1a475fe.js";const w=e=>{window.location.href=e},ue=e=>{w(e+"?redirect="+window.location.origin)},A="ukjent uuid",me="Det har oppstått et problem med innsending av søknaden. Vennligst prøv igjen senere. Hvis problemet vedvarer, kontakt oss og oppgi feil id: ",fe=e=>!!(e&&typeof e=="object"&&"isAxiosError"in e),h=K.create({baseURL:E.REST_API_URL,withCredentials:!0});h.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));h.interceptors.response.use(e=>e,e=>{var n;return e.response&&e.response.status===401&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad/engangssoknad")&&ue(E.LOGIN_URL),Promise.reject(e)});const Se=()=>h.get("/personinfo"),ke=(e,n)=>{const a=(n==null?void 0:n.vedlegg.map(o=>o.id))||[];if(V(e))return{type:"adopsjon",antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer.map(o=>o.dato),adopsjonsdato:e.adopsjonsdato,adopsjonAvEktefellesBarn:e.adopsjonAvEktefellesBarn,vedleggreferanser:a};if(B(e))return{type:"fødsel",antallBarn:e.antallBarn,fødselsdato:e.fødselsdato,vedleggreferanser:[]};if(G(e)&&n&&W(n))return{type:"termin",antallBarn:e.antallBarn,termindato:e.termindato,terminbekreftelseDato:n.terminbekreftelsedato,vedleggreferanser:a};throw Error("Det er feil i data om barnet")},Ee=(e,n)=>async(a,o,i,p,r)=>{const u={type:"engangsstønad",språkkode:e,barn:ke(o,i),utenlandsopphold:{utenlandsoppholdSiste12Mnd:(p==null?void 0:p.utenlandsoppholdSiste12Mnd)||[],utenlandsoppholdNeste12Mnd:(r==null?void 0:r.utenlandsoppholdNeste12Mnd)||[]},vedlegg:(i==null?void 0:i.vedlegg)||[]};try{const s=await h.post("/soknad/engangssoknad",u,{headers:{"content-type":"application/json;"},signal:a});n(s.data)}catch(s){if(fe(s)&&s.code!=="ERR_CANCELED"){const c=s.response&&s.response.data&&s.response.data.uuid?s.response.data.uuid:A,m=c!==A?c.slice(0,8):c;n(()=>{throw new Error(me+m)})}}},N={getPerson:Se,getSendSøknad:Ee},he=e=>{const[n,a]=l.useState(),[o,i]=l.useState(!1),[p,r]=l.useState(null);return l.useEffect(()=>{let u=!1;return(async()=>{try{i(!0);const c=await e();u||a(c.data)}catch(c){r(c)}finally{i(!1)}})(),()=>{u=!0}},[e]),{data:n,loading:o,error:p}};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ve="startTransition",y=Z[ve];function je(e){let{basename:n,children:a,future:o,window:i}=e,p=l.useRef();p.current==null&&(p.current=q({window:i,v5Compat:!0}));let r=p.current,[u,s]=l.useState({action:r.action,location:r.location}),{v7_startTransition:c}=o||{},m=l.useCallback(f=>{c&&y?y(()=>s(f)):s(f)},[s,c]);return l.useLayoutEffect(()=>r.listen(m),[r,m]),l.createElement(H,{basename:n,children:a,location:u.location,navigationType:u.action,navigator:r})}var M;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(M||(M={}));var I;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(I||(I={}));const D="selectedLocale",xe=()=>sessionStorage.getItem(D)||"nb",Ae=e=>{sessionStorage.setItem(D,e)},v=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(te,{size:"2xlarge"})}),Ne=({locale:e,onChangeLocale:n})=>{var m,f;const[a,o]=l.useState(!1),[i,p]=l.useState(),{data:r,loading:u,error:s}=he(N.getPerson);if(i)return E.INNSYN_SAK?(w(i.saksNr?`${E.INNSYN_SAK}${i.saksNr}`:E.INNSYN),t.jsx(v,{})):t.jsx("div",{children:"Redirected to Innsyn"});if(s!==null)return((m=s.response)==null?void 0:m.status)===401||((f=s.response)==null?void 0:f.status)===403?t.jsx(v,{}):t.jsx(ee,{appnavn:"Engangsstønad",feilmelding:s.message,søkPåNytt:()=>location.reload()});if(u||!r)return t.jsx(v,{});if(!J(r.fødselsdato))return t.jsx(pe,{person:r});const c=N.getSendSøknad(e,p);return t.jsx(Y,{children:t.jsxs(z,{children:[!a&&t.jsx(d,{path:"*",element:t.jsx(Q,{to:g.VELKOMMEN})}),t.jsx(d,{path:g.VELKOMMEN,element:t.jsx(ie,{locale:e,onChangeLocale:n,startSøknad:o,erVelkommen:a})}),a&&t.jsxs(t.Fragment,{children:[t.jsx(d,{path:g.SØKERSITUASJON,element:t.jsx(oe,{})}),t.jsx(d,{path:g.OM_BARNET,element:t.jsx(le,{kjønn:r.kjønn})}),t.jsx(d,{path:g.TERMINBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(d,{path:g.ADOPSJONSBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(d,{path:g.UTENLANDSOPPHOLD,element:t.jsx(ce,{})}),t.jsx(d,{path:g.TIDLIGERE_UTENLANDSOPPHOLD,element:t.jsx(ge,{})}),t.jsx(d,{path:g.SENERE_UTENLANDSOPPHOLD,element:t.jsx(de,{})}),t.jsx(d,{path:g.OPPSUMMERING,element:t.jsx(X,{person:r,sendSøknad:c})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const C=xe();ne.locale(C);const ye=()=>{const[e,n]=l.useState(C),a=l.useCallback(o=>{Ae(o),n(o)},[]);return t.jsx(se,{språkkode:e,children:t.jsx(ae,{appnavn:"Engangsstønad",children:t.jsx(je,{children:t.jsx(Ne,{locale:e,onChangeLocale:a})})})})},U=ye,Me={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},Ye={title:"Applikasjon - Engangsstønad (AppContainer)",component:U},F=({person:e})=>{re();const n=new x(h);n.onGet("/personinfo").reply(200,e),n.onPost("/soknad/engangssoknad").reply(200,Me);const a=new x($);return a.onPost("/storage/vedlegg").reply(200),a.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx(U,{})},S=F.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:O.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=F.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:O.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var b,L,P;S.parameters={...S.parameters,docs:{...(b=S.parameters)==null?void 0:b.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(P=(L=S.parameters)==null?void 0:L.docs)==null?void 0:P.source}}};var R,T,_;k.parameters={...k.parameters,docs:{...(R=k.parameters)==null?void 0:R.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(_=(T=k.parameters)==null?void 0:T.docs)==null?void 0:_.source}}};const ze=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,ze as __namedExportsOrder,Ye as default};
//# sourceMappingURL=AppContainer.stories-20ecb279.js.map
