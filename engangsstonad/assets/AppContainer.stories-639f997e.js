import{j as t}from"./jsx-runtime-69eee039.js";import{b as D,E as I,D as E,M as j,a as K}from"./DokumentasjonSteg-afeba8a8.js";import"./countryUtils-91dff4fa.js";import{n as V,d as B}from"./useEsNavigator-418925c5.js";import{e as G,b as $,a as q}from"./Attachment-77c59016.js";import{e as H,O as z}from"./OppsummeringSteg-652d1509.js";import{r,$ as J}from"./index-7c191284.js";import{e as Q,f as W,R as X,a as p,N as Y,P as l}from"./paths-6fc4bb0b.js";import{y as Z,z as ee,g as te,I as ne}from"./IntlProvider-4e33f46c.js";import{S as se}from"./SøkersituasjonSteg-f03bb739.js";import{V as oe}from"./Velkommen-64eb013a.js";import{O as re}from"./OmBarnetSteg-21640cee.js";import{U as ae}from"./UtenlandsoppholdSteg-df24a77c.js";import{S as ie}from"./SøknadSendt-2eaabfec.js";import{U as ce}from"./Umyndig-0ca9b785.js";import{F as pe}from"./FeilsideInfo-16443fcf.js";import{S as le}from"./SenereUtenlandsoppholdSteg-88be446e.js";import{T as me}from"./TidligereUtenlandsoppholdSteg-3f2e450d.js";import{K as _}from"./Person-12835ba1.js";import{i as de}from"./amplitude-a97f1527.js";import"./ErrorSummaryHookForm-c5bb13eb.js";import"./StepButtons-a9eb5602.js";import"./dateUtils-eef781fc.js";import"./extends-2f8ee675.js";import"./index-ecbee218.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./Søkersituasjon-b1a475fe.js";import"./links-b4497713.js";import"./Feilside-a1ac262e.js";const ue=e=>{window.location.href=e},ge=e=>{ue(e+"?redirect="+window.location.origin)},h=D.create({baseURL:I.REST_API_URL,withCredentials:!0});h.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));h.interceptors.response.use(e=>e,e=>{var n;return e.response&&e.response.status===401&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad")&&ge(I.LOGIN_URL),Promise.reject(e)});const fe=()=>h.get("/personinfo"),Se=(e,n)=>{if(G(e)||$(e))return{...e,fødselsdatoer:e.fødselsdatoer.map(o=>o.dato)};if(q(e)&&n&&H(n))return{...e,terminbekreftelsedato:n.terminbekreftelsedato};throw Error("Det er feil i data om barnet")},x=(e=[])=>e.map(n=>({land:n.landkode,tidsperiode:{fom:n.fom,tom:n.tom}})),ke=(e,n)=>async(o,a,i,c,s)=>{V(a);const d={barn:Se(o,i),type:"engangsstønad",erEndringssøknad:!1,informasjonOmUtenlandsopphold:{iNorgeSiste12Mnd:a.harBoddUtenforNorgeSiste12Mnd,iNorgeNeste12Mnd:a.skalBoUtenforNorgeNeste12Mnd,tidligereOpphold:x(c==null?void 0:c.utenlandsoppholdSiste12Mnd),senereOpphold:x(s==null?void 0:s.utenlandsoppholdNeste12Mnd)},søker:{språkkode:e},vedlegg:(i==null?void 0:i.vedlegg)||[]},m=await h.post("/soknad",d,{headers:{"content-type":"application/json;"}});n(m.data)},A={getPerson:fe,sendSøknad:ke},he=e=>{const[n,o]=r.useState(),[a,i]=r.useState(!1),[c,s]=r.useState(null);return r.useEffect(()=>{let d=!1;return(async()=>{try{i(!0);const u=await e();d||o(u.data)}catch(u){s(u)}finally{i(!1)}})(),()=>{d=!0}},[e]),{data:n,loading:a,error:c}};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Ee="startTransition",y=J[Ee];function je(e){let{basename:n,children:o,future:a,window:i}=e,c=r.useRef();c.current==null&&(c.current=Q({window:i,v5Compat:!0}));let s=c.current,[d,m]=r.useState({action:s.action,location:s.location}),{v7_startTransition:u}=a||{},g=r.useCallback(f=>{u&&y?y(()=>m(f)):m(f)},[m,u]);return r.useLayoutEffect(()=>s.listen(g),[s,g]),r.createElement(W,{basename:n,children:o,location:d.location,navigationType:d.action,navigator:s})}var M;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(M||(M={}));var v;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(v||(v={}));const w="selectedLocale",xe=()=>sessionStorage.getItem(w)||"nb",Ae=e=>{sessionStorage.setItem(w,e)},N=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(ee,{size:"2xlarge"})}),ye=({locale:e,onChangeLocale:n})=>{var g,f;const[o,a]=r.useState(!1),[i,c]=r.useState(),{data:s,loading:d,error:m}=he(A.getPerson);if(m!==null)return((g=m.response)==null?void 0:g.status)===401||((f=m.response)==null?void 0:f.status)===403?t.jsx(N,{}):t.jsx(pe,{onChangeLocale:n,locale:e});if(d||!s)return t.jsx(N,{});if(!Z(s.fødselsdato))return t.jsx(ce,{person:s});const u=A.sendSøknad(e,c);return t.jsx(B,{children:t.jsxs(X,{children:[!o&&t.jsx(p,{path:"*",element:t.jsx(Y,{to:l.VELKOMMEN})}),t.jsx(p,{path:l.VELKOMMEN,element:t.jsx(oe,{locale:e,onChangeLocale:n,startSøknad:a,erVelkommen:o})}),o&&t.jsxs(t.Fragment,{children:[t.jsx(p,{path:l.SØKERSITUASJON,element:t.jsx(se,{})}),t.jsx(p,{path:l.OM_BARNET,element:t.jsx(re,{kjønn:s.kjønn})}),t.jsx(p,{path:l.TERMINBEKREFTELSE,element:t.jsx(E,{})}),t.jsx(p,{path:l.ADOPSJONSBEKREFTELSE,element:t.jsx(E,{})}),t.jsx(p,{path:l.UTENLANDSOPPHOLD,element:t.jsx(ae,{})}),t.jsx(p,{path:l.TIDLIGERE_UTENLANDSOPPHOLD,element:t.jsx(me,{})}),t.jsx(p,{path:l.SENERE_UTENLANDSOPPHOLD,element:t.jsx(le,{})}),t.jsx(p,{path:l.OPPSUMMERING,element:t.jsx(z,{person:s,sendSøknad:u})}),t.jsx(p,{path:l.KVITTERING,element:t.jsx(ie,{person:s,kvittering:i})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const U=xe();te.locale(U);const Me=()=>{const[e,n]=r.useState(U),o=r.useCallback(a=>{Ae(a),n(a)},[]);return t.jsx(ne,{språkkode:e,children:t.jsx(je,{children:t.jsx(ye,{locale:e,onChangeLocale:o})})})},F=Me,ve={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},nt={title:"Applikasjon - Engangsstønad (AppContainer)",component:F},C=({person:e})=>{de();const n=new j(h);n.onGet("/personinfo").reply(200,e),n.onPost("/soknad").reply(200,ve);const o=new j(K);return o.onPost("/storage/vedlegg").reply(200),o.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx(F,{})},S=C.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:_.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=C.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:_.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var T,b,L;S.parameters={...S.parameters,docs:{...(T=S.parameters)==null?void 0:T.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(L=(b=S.parameters)==null?void 0:b.docs)==null?void 0:L.source}}};var O,P,R;k.parameters={...k.parameters,docs:{...(O=k.parameters)==null?void 0:O.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(R=(P=k.parameters)==null?void 0:P.docs)==null?void 0:R.source}}};const st=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,st as __namedExportsOrder,nt as default};
//# sourceMappingURL=AppContainer.stories-639f997e.js.map
