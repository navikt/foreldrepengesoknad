import{j as t}from"./jsx-runtime-69eee039.js";import{b as G,E as _,D as E,M as A,a as $}from"./DokumentasjonSteg-c5d0d109.js";import"./countryUtils-64ad3222.js";import{n as w,e as j,f as x,d as q}from"./useEsNavigator-fe1453fa.js";import{e as J,b as H,a as z}from"./Attachment-77c59016.js";import{e as Q,O as W}from"./OppsummeringSteg-764c8617.js";import{g as F,o as X,J as Y,K as Z,I as ee}from"./IntlProvider-79b89341.js";import{r as i,$ as te}from"./index-7c191284.js";import{e as ne,f as se,R as oe,a as p,N as re,P as c}from"./paths-15c3400b.js";import{S as ae}from"./SøkersituasjonSteg-23c6fab7.js";import{V as ie}from"./Velkommen-4919a811.js";import{O as le}from"./OmBarnetSteg-6f4c2e94.js";import{U as pe}from"./UtenlandsoppholdSteg-b5adb833.js";import{S as ce}from"./SøknadSendt-552beee5.js";import{U as de}from"./Umyndig-83ab8c9f.js";import{U as me}from"./UtenlandsoppholdPeriodeSteg-986df73b.js";import{F as ue}from"./FeilsideInfo-ae03eafd.js";import{K}from"./Person-12835ba1.js";import{i as ge}from"./amplitude-a97f1527.js";import"./ErrorSummaryHookForm-191d9635.js";import"./StepButtons-9bea993a.js";import"./dateUtils-243f90f9.js";import"./extends-2f8ee675.js";import"./index-ecbee218.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./Søkersituasjon-b1a475fe.js";import"./links-b4497713.js";import"./Feilside-022c72ff.js";const fe=e=>{window.location.href=e},he=e=>{fe(e+"?redirect="+window.location.origin)},S=G.create({baseURL:_.REST_API_URL,withCredentials:!0});S.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));S.interceptors.response.use(e=>e,e=>{var s;return e.response&&e.response.status===401&&((s=e==null?void 0:e.config)!=null&&s.url)&&!e.config.url.includes("/soknad")&&he(_.LOGIN_URL),Promise.reject(e)});const ke=()=>S.get("/personinfo"),Se=(e,s)=>{if(J(e)||H(e))return{...e,fødselsdatoer:e.fødselsdatoer.map(o=>o.dato)};if(z(e)&&s&&Q(s))return{...e,terminbekreftelsedato:s.terminbekreftelsedato};throw Error("Det er feil i data om barnet")},y=(e=[])=>e.map(s=>({land:s.landkode,tidsperiode:{fom:s.fom,tom:s.tom}})),Ee=(e,s)=>{if(e.harKunBoddINorge)return{iNorgeSiste12Mnd:!0,iNorgeNeste12Mnd:!0,tidligereOpphold:[],senereOpphold:[]};const{perioder:o}=w(s),r=F().format(X),a=o.filter(n=>j(n.fom)).map(n=>({...n,tom:x(n.tom)?r:n.tom})),l=o.filter(n=>x(n.tom)).map(n=>({...n,fom:j(n.fom)?r:n.fom}));return{iNorgeSiste12Mnd:a.length>0,iNorgeNeste12Mnd:l.length>0,tidligereOpphold:y(a),senereOpphold:y(l)}},Ae=(e,s)=>async(o,r,a,l)=>{w(r);const n={barn:Se(o,a),type:"engangsstønad",erEndringssøknad:!1,informasjonOmUtenlandsopphold:Ee(r,l),søker:{språkkode:e},vedlegg:(a==null?void 0:a.vedlegg)||[]},d=await S.post("/soknad",n,{headers:{"content-type":"application/json;"}});s(d.data)},v={getPerson:ke,sendSøknad:Ae},je=e=>{const[s,o]=i.useState(),[r,a]=i.useState(!1),[l,n]=i.useState(null);return i.useEffect(()=>{let d=!1;return(async()=>{try{a(!0);const u=await e();d||o(u.data)}catch(u){n(u)}finally{a(!1)}})(),()=>{d=!0}},[e]),{data:s,loading:r,error:l}};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const xe="startTransition",M=te[xe];function ye(e){let{basename:s,children:o,future:r,window:a}=e,l=i.useRef();l.current==null&&(l.current=ne({window:a,v5Compat:!0}));let n=l.current,[d,m]=i.useState({action:n.action,location:n.location}),{v7_startTransition:u}=r||{},g=i.useCallback(f=>{u&&M?M(()=>m(f)):m(f)},[m,u]);return i.useLayoutEffect(()=>n.listen(g),[n,g]),i.createElement(se,{basename:s,children:o,location:d.location,navigationType:d.action,navigator:n})}var N;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(N||(N={}));var O;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(O||(O={}));const C="selectedLocale",ve=()=>sessionStorage.getItem(C)||"nb",Me=e=>{sessionStorage.setItem(C,e)},T=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(Z,{size:"2xlarge"})}),Ne=({locale:e,onChangeLocale:s})=>{var g,f;const[o,r]=i.useState(!1),[a,l]=i.useState(),{data:n,loading:d,error:m}=je(v.getPerson);if(m!==null)return((g=m.response)==null?void 0:g.status)===401||((f=m.response)==null?void 0:f.status)===403?t.jsx(T,{}):t.jsx(ue,{onChangeLocale:s,locale:e});if(d||!n)return t.jsx(T,{});if(!Y(n.fødselsdato))return t.jsx(de,{person:n});const u=v.sendSøknad(e,l);return t.jsx(q,{children:t.jsxs(oe,{children:[!o&&t.jsx(p,{path:"*",element:t.jsx(re,{to:c.VELKOMMEN})}),t.jsx(p,{path:c.VELKOMMEN,element:t.jsx(ie,{locale:e,onChangeLocale:s,startSøknad:r,erVelkommen:o})}),o&&t.jsxs(t.Fragment,{children:[t.jsx(p,{path:c.SØKERSITUASJON,element:t.jsx(ae,{})}),t.jsx(p,{path:c.OM_BARNET,element:t.jsx(le,{kjønn:n.kjønn})}),t.jsx(p,{path:c.TERMINBEKREFTELSE,element:t.jsx(E,{})}),t.jsx(p,{path:c.ADOPSJONSBEKREFTELSE,element:t.jsx(E,{})}),t.jsx(p,{path:c.UTENLANDSOPPHOLD,element:t.jsx(pe,{})}),t.jsx(p,{path:c.UTENLANDSOPPHOLD_PERIODER,element:t.jsx(me,{})}),t.jsx(p,{path:c.OPPSUMMERING,element:t.jsx(W,{person:n,sendSøknad:u})}),t.jsx(p,{path:c.KVITTERING,element:t.jsx(ce,{person:n,kvittering:a})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const D=ve();F.locale(D);const Oe=()=>{const[e,s]=i.useState(D),o=i.useCallback(r=>{Me(r),s(r)},[]);return t.jsx(ee,{språkkode:e,children:t.jsx(ye,{children:t.jsx(Ne,{locale:e,onChangeLocale:o})})})},V=Oe,Te={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},ot={title:"Applikasjon - Engangsstønad (AppContainer)",component:V},B=({person:e})=>{ge();const s=new A(S);s.onGet("/personinfo").reply(200,e),s.onPost("/soknad").reply(200,Te);const o=new A($);return o.onPost("/storage/vedlegg").reply(200),o.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx(V,{})},h=B.bind({});h.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:K.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=B.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:K.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var b,R,I;h.parameters={...h.parameters,docs:{...(b=h.parameters)==null?void 0:b.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(I=(R=h.parameters)==null?void 0:R.docs)==null?void 0:I.source}}};var P,L,U;k.parameters={...k.parameters,docs:{...(P=k.parameters)==null?void 0:P.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(U=(L=k.parameters)==null?void 0:L.docs)==null?void 0:U.source}}};const rt=["SøkerErKvinne","SøkerErMann"];export{h as SøkerErKvinne,k as SøkerErMann,rt as __namedExportsOrder,ot as default};
//# sourceMappingURL=AppContainer.stories-4019e857.js.map
