import{j as t}from"./jsx-runtime-69eee039.js";import{b as K,E,D as j,M as x,a as V}from"./DokumentasjonSteg-a7444c14.js";import{x as B,y as G,z as $,d as H,R as q,e as g,N as J,P as u}from"./useEsNavigator-03c3a922.js";import{e as Y,b as z,a as Q}from"./Attachment-77c59016.js";import{e as W,O as X}from"./OppsummeringSteg-9b8b5e70.js";import{r as l,$ as Z}from"./index-7c191284.js";import{s as ee,t as te,j as ne,I as se,v as re,i as ae}from"./IntlProvider-f476007b.js";import"./_baseToString-8992fead.js";import"./_createSet-409f46e6.js";import{S as oe}from"./SøkersituasjonSteg-b66f30e9.js";import{V as ie}from"./Velkommen-95832ebf.js";import{O as le}from"./OmBarnetSteg-0f62af9e.js";import{U as ce}from"./UtenlandsoppholdSteg-95eac6f0.js";import{U as pe}from"./Umyndig-81801b18.js";import{S as de}from"./SenereUtenlandsoppholdSteg-38a10c7d.js";import{T as ge}from"./TidligereUtenlandsoppholdSteg-5ada98ec.js";import{K as O}from"./Person-12835ba1.js";import"./ErrorSummaryHookForm-b399183b.js";import"./index-b3a39e30.js";import"./v4-a960c1f4.js";import"./Søkersituasjon-b1a475fe.js";const w=e=>{window.location.href=e},ue=e=>{w(e+"?redirect="+window.location.origin)},A="ukjent uuid",me="Det har oppstått et problem med innsending av søknaden. Vennligst prøv igjen senere. Hvis problemet vedvarer, kontakt oss og oppgi feil id: ",fe=e=>!!(e&&typeof e=="object"&&"isAxiosError"in e),h=K.create({baseURL:E.REST_API_URL,withCredentials:!0});h.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));h.interceptors.response.use(e=>e,e=>{var n;return e.response&&e.response.status===401&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad/engangssoknad")&&ue(E.LOGIN_URL),Promise.reject(e)});const Se=()=>h.get("/personinfo"),ke=(e,n)=>{const s=(n==null?void 0:n.vedlegg.map(r=>r.id))||[];if(Y(e))return{type:"adopsjon",antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer.map(r=>r.dato),adopsjonsdato:e.adopsjonsdato,adopsjonAvEktefellesBarn:e.adopsjonAvEktefellesBarn,vedleggreferanser:s};if(z(e))return{type:"fødsel",antallBarn:e.antallBarn,fødselsdato:e.fødselsdatoer[0].dato,vedleggreferanser:[]};if(Q(e)&&n&&W(n))return{type:"termin",antallBarn:e.antallBarn,termindato:e.termindato,terminbekreftelseDato:n.terminbekreftelsedato,vedleggreferanser:s};throw Error("Det er feil i data om barnet")},Ee=(e,n)=>async(s,r,c,p)=>{const a={type:"engangsstønad",språkkode:e,barn:ke(s,r),utenlandsopphold:{utenlandsoppholdSiste12Mnd:(c==null?void 0:c.utenlandsoppholdSiste12Mnd)||[],utenlandsoppholdNeste12Mnd:(p==null?void 0:p.utenlandsoppholdNeste12Mnd)||[]},vedlegg:(r==null?void 0:r.vedlegg)||[]};try{const o=await h.post("/soknad/engangssoknad",a,{headers:{"content-type":"application/json;"}});n(o.data)}catch(o){if(fe(o)){const i=o.response&&o.response.data&&o.response.data.uuid?o.response.data.uuid:A,d=i!==A?i.slice(0,8):i;n(()=>{throw new Error(me+d)})}}},y={getPerson:Se,sendSøknad:Ee},he=e=>{const[n,s]=l.useState(),[r,c]=l.useState(!1),[p,a]=l.useState(null);return l.useEffect(()=>{let o=!1;return(async()=>{try{c(!0);const d=await e();o||s(d.data)}catch(d){a(d)}finally{c(!1)}})(),()=>{o=!0}},[e]),{data:n,loading:r,error:p}};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ve="startTransition",N=Z[ve];function je(e){let{basename:n,children:s,future:r,window:c}=e,p=l.useRef();p.current==null&&(p.current=B({window:c,v5Compat:!0}));let a=p.current,[o,i]=l.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},m=l.useCallback(f=>{d&&N?N(()=>i(f)):i(f)},[i,d]);return l.useLayoutEffect(()=>a.listen(m),[a,m]),l.createElement(G,{basename:n,children:s,location:o.location,navigationType:o.action,navigator:a})}var M;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(M||(M={}));var I;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(I||(I={}));const D="selectedLocale",xe=()=>sessionStorage.getItem(D)||"nb",Ae=e=>{sessionStorage.setItem(D,e)},v=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(te,{size:"2xlarge"})}),ye=({locale:e,onChangeLocale:n})=>{var m,f;const[s,r]=l.useState(!1),[c,p]=l.useState(),{data:a,loading:o,error:i}=he(y.getPerson);if(c)return E.INNSYN_SAK?(w(c.saksNr?`${E.INNSYN_SAK}${c.saksNr}`:E.INNSYN),t.jsx(v,{})):t.jsx("div",{children:"Redirected to Innsyn"});if(i!==null)return((m=i.response)==null?void 0:m.status)===401||((f=i.response)==null?void 0:f.status)===403?t.jsx(v,{}):t.jsx(ee,{appnavn:"Engangsstønad",feilmelding:i.message});if(o||!a)return t.jsx(v,{});if(!$(a.fødselsdato))return t.jsx(pe,{person:a});const d=y.sendSøknad(e,p);return t.jsx(H,{children:t.jsxs(q,{children:[!s&&t.jsx(g,{path:"*",element:t.jsx(J,{to:u.VELKOMMEN})}),t.jsx(g,{path:u.VELKOMMEN,element:t.jsx(ie,{locale:e,onChangeLocale:n,startSøknad:r,erVelkommen:s})}),s&&t.jsxs(t.Fragment,{children:[t.jsx(g,{path:u.SØKERSITUASJON,element:t.jsx(oe,{})}),t.jsx(g,{path:u.OM_BARNET,element:t.jsx(le,{kjønn:a.kjønn})}),t.jsx(g,{path:u.TERMINBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(g,{path:u.ADOPSJONSBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(g,{path:u.UTENLANDSOPPHOLD,element:t.jsx(ce,{})}),t.jsx(g,{path:u.TIDLIGERE_UTENLANDSOPPHOLD,element:t.jsx(ge,{})}),t.jsx(g,{path:u.SENERE_UTENLANDSOPPHOLD,element:t.jsx(de,{})}),t.jsx(g,{path:u.OPPSUMMERING,element:t.jsx(X,{person:a,sendSøknad:d})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: Locale) => void"}}}}}catch{}const C=xe();ne.locale(C);const Ne=()=>{const[e,n]=l.useState(C),s=l.useCallback(r=>{Ae(r),n(r)},[]);return t.jsx(se,{språkkode:e,children:t.jsx(re,{appnavn:"Engangsstønad",children:t.jsx(je,{children:t.jsx(ye,{locale:e,onChangeLocale:s})})})})},U=Ne,Me={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},Ye={title:"Applikasjon - Engangsstønad (AppContainer)",component:U},F=({person:e})=>{ae();const n=new x(h);n.onGet("/personinfo").reply(200,e),n.onPost("/soknad/engangssoknad").reply(200,Me);const s=new x(V);return s.onPost("/storage/vedlegg").reply(200),s.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx(U,{})},S=F.bind({});S.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:O.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=F.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:O.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var b,L,P;S.parameters={...S.parameters,docs:{...(b=S.parameters)==null?void 0:b.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(P=(L=S.parameters)==null?void 0:L.docs)==null?void 0:P.source}}};var R,T,_;k.parameters={...k.parameters,docs:{...(R=k.parameters)==null?void 0:R.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(_=(T=k.parameters)==null?void 0:T.docs)==null?void 0:_.source}}};const ze=["SøkerErKvinne","SøkerErMann"];export{S as SøkerErKvinne,k as SøkerErMann,ze as __namedExportsOrder,Ye as default};
//# sourceMappingURL=AppContainer.stories-5ccaf2e1.js.map
