import{j as t,h as K,e as V}from"./index-522fa98d.js";import{E,D as j,M as x}from"./DokumentasjonSteg-0663a4b5.js";import{A as G,B as $,F as H,G as J,U as Y,f as q,R as z,g as d,N as Q,P as g,H as W,J as X,i as Z}from"./useEsNavigator-bf1d48c4.js";import{r as l,$ as ee}from"./_baseToString-4ec4abc0.js";import{b as te,e as ne,c as se,d as ae,a as re}from"./OmBarnet-c243fb4b.js";import{e as oe,O as ie,K as D}from"./OppsummeringSteg-f56cf028.js";import{n as le,a as A,b as ce,e as pe}from"./en_US-7ca00eb4.js";import"./_createSet-fd84fb43.js";import{S as de}from"./SøkersituasjonSteg-39657065.js";import{V as ge}from"./Velkommen-761e4d84.js";import{O as ue}from"./OmBarnetSteg-97219bd9.js";import{U as me}from"./UtenlandsoppholdSteg-fc7d7c06.js";import{S as Se}from"./SenereUtenlandsoppholdSteg-a0f79a06.js";import{T as fe}from"./TidligereUtenlandsoppholdSteg-31acae4e.js";import"./index-99bae1ec.js";import"./v4-a960c1f4.js";import"./ErrorSummaryHookForm-5a605e89.js";import"./Søkersituasjon-b1a475fe.js";const ke=e=>{const[n,a]=l.useState(),[o,i]=l.useState(!1),[p,r]=l.useState(null);return l.useEffect(()=>{let u=!1;return(async()=>{try{i(!0);const c=await e();u||a(c.data)}catch(c){r(c)}finally{i(!1)}})(),()=>{u=!0}},[e]),{data:n,loading:o,error:p}},C=e=>{window.location.href=e},Ee=e=>{C(e+"?redirect="+window.location.origin)},N="ukjent uuid",he="Det har oppstått et problem med innsending av søknaden. Vennligst prøv igjen senere. Hvis problemet vedvarer, kontakt oss og oppgi feil id: ",Ae=e=>!!(e&&typeof e=="object"&&"isAxiosError"in e),h=te.create({baseURL:E.REST_API_URL,withCredentials:!0});h.interceptors.request.use(e=>(e.withCredentials=!0,e.timeout=60*1e3,e));const ve=[401,403];h.interceptors.response.use(e=>e,e=>{var n;return e.response&&ve.includes(e.response.status)&&((n=e==null?void 0:e.config)!=null&&n.url)&&!e.config.url.includes("/soknad/engangssoknad")&&Ee(E.LOGIN_URL),Promise.reject(e)});const je=()=>h.get("/personinfo"),xe=(e,n)=>{const a=(n==null?void 0:n.vedlegg.map(o=>o.id))||[];if(ne(e))return{type:"adopsjon",antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer.map(o=>o.dato),adopsjonsdato:e.adopsjonsdato,adopsjonAvEktefellesBarn:e.adopsjonAvEktefellesBarn,vedleggreferanser:a};if(se(e))return{type:"fødsel",antallBarn:e.antallBarn,fødselsdato:e.fødselsdato,vedleggreferanser:[]};if(ae(e)&&n&&oe(n))return{type:"termin",antallBarn:e.antallBarn,termindato:e.termindato,terminbekreftelseDato:n.terminbekreftelsedato,vedleggreferanser:a};throw Error("Det er feil i data om barnet")},Ne=(e,n)=>async(a,o,i,p,r)=>{const u={type:"engangsstønad",språkkode:e,barn:xe(o,i),utenlandsopphold:{utenlandsoppholdSiste12Mnd:(p==null?void 0:p.utenlandsoppholdSiste12Mnd)||[],utenlandsoppholdNeste12Mnd:(r==null?void 0:r.utenlandsoppholdNeste12Mnd)||[]},vedlegg:(i==null?void 0:i.vedlegg)||[]};try{const s=await h.post("/soknad/engangssoknad",u,{headers:{"content-type":"application/json;"},signal:a});n(s.data)}catch(s){if(Ae(s)&&s.code!=="ERR_CANCELED"){const c=s.response&&s.response.data&&s.response.data.uuid?s.response.data.uuid:N,m=c!==N?c.slice(0,8):c;n(()=>{throw new Error(he+m)})}}},y={getPerson:je,getSendSøknad:Ne};/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ye="startTransition",M=ee[ye];function Me(e){let{basename:n,children:a,future:o,window:i}=e,p=l.useRef();p.current==null&&(p.current=G({window:i,v5Compat:!0}));let r=p.current,[u,s]=l.useState({action:r.action,location:r.location}),{v7_startTransition:c}=o||{},m=l.useCallback(S=>{c&&M?M(()=>s(S)):s(S)},[s,c]);return l.useLayoutEffect(()=>r.listen(m),[r,m]),l.createElement($,{basename:n,children:a,location:u.location,navigationType:u.action,navigator:r})}var b;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(b||(b={}));var L;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(L||(L={}));const w="selectedLocale",be=()=>sessionStorage.getItem(w)||"nb",Le=e=>{sessionStorage.setItem(w,e)},v=()=>t.jsx("div",{style:{textAlign:"center",padding:"12rem 0"},children:t.jsx(K,{size:"2xlarge"})}),Re=({locale:e,onChangeLocale:n})=>{var m,S;const[a,o]=l.useState(!1),[i,p]=l.useState(),{data:r,loading:u,error:s}=ke(y.getPerson);if(i)return E.INNSYN?(C(i.saksNr?`${E.INNSYN}/sak/${i.saksNr}/redirectFromSoknad`:`${E.INNSYN}/redirectFromSoknad`),t.jsx(v,{})):t.jsx("div",{children:"Redirected to Innsyn"});if(s!==null)return((m=s.response)==null?void 0:m.status)===401||((S=s.response)==null?void 0:S.status)===403?t.jsx(v,{}):t.jsx(H,{appnavn:"Engangsstønad",feilmelding:s.message,søkPåNytt:()=>location.reload()});if(u||!r)return t.jsx(v,{});if(!J(r.fødselsdato))return t.jsx(Y,{appnavn:"Engangsstønad"});const c=y.getSendSøknad(e,p);return t.jsx(q,{children:t.jsxs(z,{children:[!a&&t.jsx(d,{path:"*",element:t.jsx(Q,{to:g.VELKOMMEN})}),t.jsx(d,{path:g.VELKOMMEN,element:t.jsx(ge,{locale:e,onChangeLocale:n,startSøknad:o,erVelkommen:a})}),a&&t.jsxs(t.Fragment,{children:[t.jsx(d,{path:g.SØKERSITUASJON,element:t.jsx(de,{})}),t.jsx(d,{path:g.OM_BARNET,element:t.jsx(ue,{kjønn:r.kjønn})}),t.jsx(d,{path:g.TERMINBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(d,{path:g.ADOPSJONSBEKREFTELSE,element:t.jsx(j,{})}),t.jsx(d,{path:g.UTENLANDSOPPHOLD,element:t.jsx(me,{})}),t.jsx(d,{path:g.TIDLIGERE_UTENLANDSOPPHOLD,element:t.jsx(fe,{})}),t.jsx(d,{path:g.SENERE_UTENLANDSOPPHOLD,element:t.jsx(Se,{})}),t.jsx(d,{path:g.OPPSUMMERING,element:t.jsx(ie,{person:r,sendSøknad:c})})]})]})})};try{Engangsstnad.displayName="Engangsstnad",Engangsstnad.__docgenInfo={description:"",displayName:"Engangsstnad",props:{locale:{defaultValue:null,description:"",name:"locale",required:!0,type:{name:"enum",value:[{value:'"nb"'},{value:'"nn"'},{value:'"en"'}]}},onChangeLocale:{defaultValue:null,description:"",name:"onChangeLocale",required:!0,type:{name:"(locale: LocaleAll) => void"}}}}}catch{}const F=be(),Ie={nb:{...le,...A.nb},nn:{...ce,...A.nn},en:{...pe,...A.en}};V.locale(F);const Pe=()=>{const[e,n]=l.useState(F),a=l.useCallback(o=>{Le(o),n(o)},[]);return t.jsx(W,{locale:e,messagesGroupedByLocale:Ie,children:t.jsx(X,{appnavn:"Engangsstønad",children:t.jsx(Me,{children:t.jsx(Re,{locale:e,onChangeLocale:a})})})})},U=Pe,_e={mottattDato:"2019-02-19T13:40:45.115",referanseId:"3959c880-83d2-4f01-b107-035fa7693758",leveranseStatus:"PÅ_VENT",journalId:"439772941"},We={title:"Applikasjon - Engangsstønad (AppContainer)",component:U},B=({person:e})=>{Z();const n=new x(h);n.onGet("/personinfo").reply(200,e),n.onPost("/soknad/engangssoknad").reply(200,_e);const a=new x(re);return a.onPost("/storage/vedlegg").reply(200),a.onPost("http://localhost:8888/rest/storage/vedlegg").reply(200),t.jsx(U,{})},f=B.bind({});f.args={person:{fnr:"11111111111",fornavn:"Henrikke",etternavn:"Ibsen",kjønn:D.KVINNE,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};const k=B.bind({});k.args={person:{fnr:"1231111111",fornavn:"Espen",etternavn:"Utvikler",kjønn:D.MANN,fødselsdato:"1979-01-28",adresse:"Oslo 123",bankkonto:{kontonummer:"49875234987",banknavn:"Storebank"}}};var R,I,P;f.parameters={...f.parameters,docs:{...(R=f.parameters)==null?void 0:R.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(P=(I=f.parameters)==null?void 0:I.docs)==null?void 0:P.source}}};var _,T,O;k.parameters={...k.parameters,docs:{...(_=k.parameters)==null?void 0:_.docs,source:{originalSource:`({
  person
}) => {
  initAmplitude();
  const apiMock = new MockAdapter(engangsstønadApi);
  apiMock.onGet('/personinfo').reply(200, person);
  apiMock.onPost('/soknad/engangssoknad').reply(200, kvittering);
  const attachmentApiMock = new MockAdapter(attachmentApi);
  attachmentApiMock.onPost('/storage/vedlegg').reply(200); //story
  attachmentApiMock.onPost('http://localhost:8888/rest/storage/vedlegg').reply(200); //test

  return <AppContainer />;
}`,...(O=(T=k.parameters)==null?void 0:T.docs)==null?void 0:O.source}}};const Xe=["SøkerErKvinne","SøkerErMann"];export{f as SøkerErKvinne,k as SøkerErMann,Xe as __namedExportsOrder,We as default};
//# sourceMappingURL=AppContainer.stories-a11cf96f.js.map
