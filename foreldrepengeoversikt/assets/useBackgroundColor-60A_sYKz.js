import{r as D,ad as ee}from"./iframe-DKah-zWz.js";const L={},Q=(e,n)=>e.unstable_is?e.unstable_is(n):n===e,X=e=>"init"in e,G=e=>!!e.write,Y=e=>"v"in e||"e"in e,z=e=>{if("e"in e)throw e.e;if((L?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},N=new WeakMap,Z=e=>{var n;return j(e)&&!!((n=N.get(e))!=null&&n[0])},ce=e=>{const n=N.get(e);n?.[0]&&(n[0]=!1,n[1].forEach(r=>r()))},te=(e,n)=>{let r=N.get(e);if(!r){r=[!0,new Set],N.set(e,r);const l=()=>{r[0]=!1};e.then(l,l)}r[1].add(n)},j=e=>typeof e?.then=="function",ne=(e,n,r)=>{r.p.has(e)||(r.p.add(e),n.then(()=>{r.p.delete(e)},()=>{r.p.delete(e)}))},k=(e,n,r)=>{const l=r(e),f="v"in l,h=l.v;if(j(n))for(const _ of l.d.keys())ne(e,n,r(_));l.v=n,delete l.e,(!f||!Object.is(h,l.v))&&(++l.n,j(h)&&ce(h))},F=(e,n,r)=>{var l;const f=new Set;for(const h of((l=r.get(e))==null?void 0:l.t)||[])r.has(h)&&f.add(h);for(const h of n.p)f.add(h);return f},le=Symbol(),ue=(e=new WeakMap,n=new WeakMap,r=new WeakMap,l=new Set,f=new Set,h=new Set,_={},P=(a,...y)=>a.read(...y),E=(a,...y)=>a.write(...y),d=(a,y)=>{var b;return(b=a.unstable_onInit)==null?void 0:b.call(a,y)},S=(a,y)=>{var b;return(b=a.onMount)==null?void 0:b.call(a,y)},...g)=>{const a=g[0]||(t=>{if((L?"production":void 0)!=="production"&&!t)throw new Error("Atom is undefined or null");let u=e.get(t);return u||(u={d:new Map,p:new Set,n:0},e.set(t,u),d?.(t,J)),u}),y=g[1]||(()=>{const t=[],u=c=>{try{c()}catch(s){t.push(s)}};do{_.f&&u(_.f);const c=new Set,s=c.add.bind(c);l.forEach(o=>{var i;return(i=n.get(o))==null?void 0:i.l.forEach(s)}),l.clear(),h.forEach(s),h.clear(),f.forEach(s),f.clear(),c.forEach(u),l.size&&b()}while(l.size||h.size||f.size);if(t.length)throw new AggregateError(t)}),b=g[2]||(()=>{const t=[],u=new WeakSet,c=new WeakSet,s=Array.from(l);for(;s.length;){const o=s[s.length-1],i=a(o);if(c.has(o)){s.pop();continue}if(u.has(o)){if(r.get(o)===i.n)t.push([o,i]);else if((L?"production":void 0)!=="production"&&r.has(o))throw new Error("[Bug] invalidated atom exists");c.add(o),s.pop();continue}u.add(o);for(const w of F(o,i,n))u.has(w)||s.push(w)}for(let o=t.length-1;o>=0;--o){const[i,w]=t[o];let p=!1;for(const T of w.d.keys())if(T!==i&&l.has(T)){p=!0;break}p&&(A(i),O(i)),r.delete(i)}}),A=g[3]||(t=>{var u;const c=a(t);if(Y(c)&&(n.has(t)&&r.get(t)!==c.n||Array.from(c.d).every(([v,C])=>A(v).n===C)))return c;c.d.clear();let s=!0;const o=()=>{n.has(t)&&(O(t),b(),y())},i=v=>{var C;if(Q(t,v)){const B=a(v);if(!Y(B))if(X(v))k(v,v.init,a);else throw new Error("no atom init");return z(B)}const $=A(v);try{return z($)}finally{c.d.set(v,$.n),Z(c.v)&&ne(t,c.v,$),(C=n.get(v))==null||C.t.add(t),s||o()}};let w,p;const T={get signal(){return w||(w=new AbortController),w.signal},get setSelf(){return(L?"production":void 0)!=="production"&&!G(t)&&console.warn("setSelf function cannot be used with read-only atom"),!p&&G(t)&&(p=(...v)=>{if((L?"production":void 0)!=="production"&&s&&console.warn("setSelf function cannot be called in sync"),!s)try{return R(t,...v)}finally{b(),y()}}),p}},x=c.n;try{const v=P(t,i,T);return k(t,v,a),j(v)&&(te(v,()=>w?.abort()),v.then(o,o)),c}catch(v){return delete c.v,c.e=v,++c.n,c}finally{s=!1,x!==c.n&&r.get(t)===x&&(r.set(t,c.n),l.add(t),(u=_.c)==null||u.call(_,t))}}),U=g[4]||(t=>{const u=[t];for(;u.length;){const c=u.pop(),s=a(c);for(const o of F(c,s,n)){const i=a(o);r.set(o,i.n),u.push(o)}}}),R=g[5]||((t,...u)=>{let c=!0;const s=i=>z(A(i)),o=(i,...w)=>{var p;const T=a(i);try{if(Q(t,i)){if(!X(i))throw new Error("atom not writable");const x=T.n,v=w[0];k(i,v,a),O(i),x!==T.n&&(l.add(i),(p=_.c)==null||p.call(_,i),U(i));return}else return R(i,...w)}finally{c||(b(),y())}};try{return E(t,s,o,...u)}finally{c=!1}}),O=g[6]||(t=>{var u;const c=a(t),s=n.get(t);if(s&&!Z(c.v)){for(const[o,i]of c.d)if(!s.d.has(o)){const w=a(o);V(o).t.add(t),s.d.add(o),i!==w.n&&(l.add(o),(u=_.c)==null||u.call(_,o),U(o))}for(const o of s.d||[])if(!c.d.has(o)){s.d.delete(o);const i=W(o);i?.t.delete(t)}}}),V=g[7]||(t=>{var u;const c=a(t);let s=n.get(t);if(!s){A(t);for(const o of c.d.keys())V(o).t.add(t);if(s={l:new Set,d:new Set(c.d.keys()),t:new Set},n.set(t,s),(u=_.m)==null||u.call(_,t),G(t)){const o=()=>{let i=!0;const w=(...p)=>{try{return R(t,...p)}finally{i||(b(),y())}};try{const p=S(t,w);p&&(s.u=()=>{i=!0;try{p()}finally{i=!1}})}finally{i=!1}};f.add(o)}}return s}),W=g[8]||(t=>{var u;const c=a(t);let s=n.get(t);if(s&&!s.l.size&&!Array.from(s.t).some(o=>{var i;return(i=n.get(o))==null?void 0:i.d.has(t)})){s.u&&h.add(s.u),s=void 0,n.delete(t),(u=_.u)==null||u.call(_,t);for(const o of c.d.keys()){const i=W(o);i?.t.delete(t)}return}return s}),ie=[e,n,r,l,f,h,_,P,E,d,S,a,y,b,A,U,R,O,V,W],J={get:t=>z(A(t)),set:(t,...u)=>{try{return R(t,...u)}finally{b(),y()}},sub:(t,u)=>{const s=V(t).l;return s.add(u),y(),()=>{s.delete(u),W(t),y()}}};return Object.defineProperty(J,le,{value:ie}),J},fe=ue,H=te,re={};let de=0;function ae(e,n){const r=`atom${++de}`,l={toString(){return(re?"production":void 0)!=="production"&&this.debugLabel?r+":"+this.debugLabel:r}};return typeof e=="function"?l.read=e:(l.init=e,l.read=ve,l.write=he),l}function ve(e){return e(this)}function he(e,n,r){return n(this,typeof r=="function"?r(e(this)):r)}function _e(){return fe()}let I;function we(){return I||(I=_e(),(re?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=I),globalThis.__JOTAI_DEFAULT_STORE__!==I&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),I}const Se={},ge=D.createContext(void 0);function oe(e){return D.useContext(ge)||we()}const M=e=>typeof e?.then=="function",q=e=>{e.status||(e.status="pending",e.then(n=>{e.status="fulfilled",e.value=n},n=>{e.status="rejected",e.reason=n}))},ye=ee.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(q(e),e)}),K=new WeakMap,m=(e,n)=>{let r=K.get(e);return r||(r=new Promise((l,f)=>{let h=e;const _=d=>S=>{h===d&&l(S)},P=d=>S=>{h===d&&f(S)},E=()=>{try{const d=n();M(d)?(K.set(d,r),h=d,d.then(_(d),P(d)),H(d,E)):l(d)}catch(d){f(d)}};e.then(_(e),P(e)),H(e,E)}),K.set(e,r)),r};function pe(e,n){const{delay:r,unstable_promiseStatus:l=!ee.use}={},f=oe(),[[h,_,P],E]=D.useReducer(S=>{const g=f.get(e);return Object.is(S[0],g)&&S[1]===f&&S[2]===e?S:[g,f,e]},void 0,()=>[f.get(e),f,e]);let d=h;if((_!==f||P!==e)&&(E(),d=f.get(e)),D.useEffect(()=>{const S=f.sub(e,()=>{if(l)try{const g=f.get(e);M(g)&&q(m(g,()=>f.get(e)))}catch{}if(typeof r=="number"){setTimeout(E,r);return}E()});return E(),S},[f,e,r,l]),D.useDebugValue(d),M(d)){const S=m(d,()=>f.get(e));return l&&q(S),ye(S)}return d}function be(e,n){const r=oe();return D.useCallback((...f)=>{if((Se?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return r.set(e,...f)},[r,e])}const se=ae("blue"),Pe=()=>pe(se),Ae=e=>{const n=be(se);D.useEffect(()=>{n(e)},[n,e])};export{ae as a,be as b,pe as c,Ae as d,Pe as u};
