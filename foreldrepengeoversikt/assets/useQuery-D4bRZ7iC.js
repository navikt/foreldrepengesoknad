var Le=t=>{throw TypeError(t)};var ye=(t,e,s)=>e.has(t)||Le("Cannot "+s);var i=(t,e,s)=>(ye(t,e,"read from private field"),s?s.call(t):e.get(t)),d=(t,e,s)=>e.has(t)?Le("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),c=(t,e,s,r)=>(ye(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),m=(t,e,s)=>(ye(t,e,"access private method"),s);import{r as x}from"./index-CR__hKHy.js";import{j as nt}from"./jsx-runtime-CLpGMVip.js";var Pe=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},V=typeof window>"u"||"Deno"in globalThis;function be(){}function Mt(t,e){return typeof t=="function"?t(e):t}function me(t){return typeof t=="number"&&t>=0&&t!==1/0}function We(t,e){return Math.max(t+(e||0)-Date.now(),0)}function fe(t,e){return typeof t=="function"?t(e):t}function P(t,e){return typeof t=="function"?t(e):t}function Lt(t,e){const{type:s="all",exact:r,fetchStatus:n,predicate:h,queryKey:a,stale:o}=t;if(a){if(r){if(e.queryHash!==at(a,e.options))return!1}else if(!De(e.queryKey,a))return!1}if(s!=="all"){const l=e.isActive();if(s==="active"&&!l||s==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||n&&n!==e.state.fetchStatus||h&&!h(e))}function At(t,e){const{exact:s,status:r,predicate:n,mutationKey:h}=t;if(h){if(!e.options.mutationKey)return!1;if(s){if(ve(e.options.mutationKey)!==ve(h))return!1}else if(!De(e.options.mutationKey,h))return!1}return!(r&&e.state.status!==r||n&&!n(e))}function at(t,e){return((e==null?void 0:e.queryKeyHashFn)||ve)(t)}function ve(t){return JSON.stringify(t,(e,s)=>Ce(s)?Object.keys(s).sort().reduce((r,n)=>(r[n]=s[n],r),{}):s)}function De(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(s=>!De(t[s],e[s])):!1}function $e(t,e){if(t===e)return t;const s=Ae(t)&&Ae(e);if(s||Ce(t)&&Ce(e)){const r=s?t:Object.keys(t),n=r.length,h=s?e:Object.keys(e),a=h.length,o=s?[]:{};let l=0;for(let C=0;C<a;C++){const v=s?C:h[C];(!s&&r.includes(v)||s)&&t[v]===void 0&&e[v]===void 0?(o[v]=void 0,l++):(o[v]=$e(t[v],e[v]),o[v]===t[v]&&t[v]!==void 0&&l++)}return n===a&&l===n?t:o}return e}function Re(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}function Ae(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ce(t){if(!qe(t))return!1;const e=t.constructor;if(e===void 0)return!0;const s=e.prototype;return!(!qe(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function qe(t){return Object.prototype.toString.call(t)==="[object Object]"}function ut(t){return new Promise(e=>{setTimeout(e,t)})}function Se(t,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,e):s.structuralSharing!==!1?$e(t,e):e}function qt(t,e,s=0){const r=[...t,e];return s&&r.length>s?r.slice(1):r}function kt(t,e,s=0){const r=[e,...t];return s&&r.length>s?r.slice(0,-1):r}var Je=Symbol();function ht(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Je?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var _,L,J,Ge,ot=(Ge=class extends Pe{constructor(){super();d(this,_);d(this,L);d(this,J);c(this,J,e=>{if(!V&&window.addEventListener){const s=()=>e();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){i(this,L)||this.setEventListener(i(this,J))}onUnsubscribe(){var e;this.hasListeners()||((e=i(this,L))==null||e.call(this),c(this,L,void 0))}setEventListener(e){var s;c(this,J,e),(s=i(this,L))==null||s.call(this),c(this,L,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){i(this,_)!==e&&(c(this,_,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(s=>{s(e)})}isFocused(){var e;return typeof i(this,_)=="boolean"?i(this,_):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},_=new WeakMap,L=new WeakMap,J=new WeakMap,Ge),Xe=new ot,X,A,Y,Be,ct=(Be=class extends Pe{constructor(){super();d(this,X,!0);d(this,A);d(this,Y);c(this,Y,e=>{if(!V&&window.addEventListener){const s=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){i(this,A)||this.setEventListener(i(this,Y))}onUnsubscribe(){var e;this.hasListeners()||((e=i(this,A))==null||e.call(this),c(this,A,void 0))}setEventListener(e){var s;c(this,Y,e),(s=i(this,A))==null||s.call(this),c(this,A,e(this.setOnline.bind(this)))}setOnline(e){i(this,X)!==e&&(c(this,X,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return i(this,X)}},X=new WeakMap,A=new WeakMap,Y=new WeakMap,Be),Ye=new ct;function ge(){let t,e;const s=new Promise((n,h)=>{t=n,e=h});s.status="pending",s.catch(()=>{});function r(n){Object.assign(s,n),delete s.resolve,delete s.reject}return s.resolve=n=>{r({status:"fulfilled",value:n}),t(n)},s.reject=n=>{r({status:"rejected",reason:n}),e(n)},s}function lt(t){return Math.min(1e3*2**t,3e4)}function Ze(t){return(t??"online")==="online"?Ye.isOnline():!0}var et=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function pe(t){return t instanceof et}function ft(t){let e=!1,s=0,r=!1,n;const h=ge(),a=b=>{var p;r||(S(new et(b)),(p=t.abort)==null||p.call(t))},o=()=>{e=!0},l=()=>{e=!1},C=()=>Xe.isFocused()&&(t.networkMode==="always"||Ye.isOnline())&&t.canRun(),v=()=>Ze(t.networkMode)&&t.canRun(),u=b=>{var p;r||(r=!0,(p=t.onSuccess)==null||p.call(t,b),n==null||n(),h.resolve(b))},S=b=>{var p;r||(r=!0,(p=t.onError)==null||p.call(t,b),n==null||n(),h.reject(b))},R=()=>new Promise(b=>{var p;n=F=>{(r||C())&&b(F)},(p=t.onPause)==null||p.call(t)}).then(()=>{var b;n=void 0,r||(b=t.onContinue)==null||b.call(t)}),w=()=>{if(r)return;let b;const p=s===0?t.initialPromise:void 0;try{b=p??t.fn()}catch(F){b=Promise.reject(F)}Promise.resolve(b).then(u).catch(F=>{var de;if(r)return;const Q=t.retry??(V?0:3),K=t.retryDelay??lt,oe=typeof K=="function"?K(s,F):K,ce=Q===!0||typeof Q=="number"&&s<Q||typeof Q=="function"&&Q(s,F);if(e||!ce){S(F);return}s++,(de=t.onFail)==null||de.call(t,s,F),ut(oe).then(()=>C()?void 0:R()).then(()=>{e?S(F):w()})})};return{promise:h,cancel:a,continue:()=>(n==null||n(),h),cancelRetry:o,continueRetry:l,canStart:v,start:()=>(v()?w():R().then(w),h)}}function dt(){let t=[],e=0,s=o=>{o()},r=o=>{o()},n=o=>setTimeout(o,0);const h=o=>{e?t.push(o):n(()=>{s(o)})},a=()=>{const o=t;t=[],o.length&&n(()=>{r(()=>{o.forEach(l=>{s(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{h(()=>{o(...l)})},schedule:h,setNotifyFunction:o=>{s=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{n=o}}}var je=dt(),H,Ne,yt=(Ne=class{constructor(){d(this,H)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),me(this.gcTime)&&c(this,H,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(V?1/0:5*60*1e3))}clearGcTimeout(){i(this,H)&&(clearTimeout(i(this,H)),c(this,H,void 0))}},H=new WeakMap,Ne),Z,ee,U,g,ae,G,I,M,ze,Kt=(ze=class extends yt{constructor(e){super();d(this,I);d(this,Z);d(this,ee);d(this,U);d(this,g);d(this,ae);d(this,G);c(this,G,!1),c(this,ae,e.defaultOptions),this.setOptions(e.options),this.observers=[],c(this,U,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,c(this,Z,pt(this.options)),this.state=e.state??i(this,Z),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=i(this,g))==null?void 0:e.promise}setOptions(e){this.options={...i(this,ae),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&i(this,U).remove(this)}setData(e,s){const r=Se(this.state.data,e,this.options);return m(this,I,M).call(this,{data:r,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),r}setState(e,s){m(this,I,M).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){var r,n;const s=(r=i(this,g))==null?void 0:r.promise;return(n=i(this,g))==null||n.cancel(e),s?s.then(be).catch(be):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(i(this,Z))}isActive(){return this.observers.some(e=>P(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Je||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!We(this.state.dataUpdatedAt,e)}onFocus(){var s;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(s=i(this,g))==null||s.continue()}onOnline(){var s;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(s=i(this,g))==null||s.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),i(this,U).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(s=>s!==e),this.observers.length||(i(this,g)&&(i(this,G)?i(this,g).cancel({revert:!0}):i(this,g).cancelRetry()),this.scheduleGc()),i(this,U).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||m(this,I,M).call(this,{type:"invalidate"})}fetch(e,s){var l,C,v;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(i(this,g))return i(this,g).continueRetry(),i(this,g).promise}if(e&&this.setOptions(e),!this.options.queryFn){const u=this.observers.find(S=>S.options.queryFn);u&&this.setOptions(u.options)}const r=new AbortController,n=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(c(this,G,!0),r.signal)})},h=()=>{const u=ht(this.options,s),S={queryKey:this.queryKey,meta:this.meta};return n(S),c(this,G,!1),this.options.persister?this.options.persister(u,S,this):u(S)},a={fetchOptions:s,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:h};n(a),(l=this.options.behavior)==null||l.onFetch(a,this),c(this,ee,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((C=a.fetchOptions)==null?void 0:C.meta))&&m(this,I,M).call(this,{type:"fetch",meta:(v=a.fetchOptions)==null?void 0:v.meta});const o=u=>{var S,R,w,b;pe(u)&&u.silent||m(this,I,M).call(this,{type:"error",error:u}),pe(u)||((R=(S=i(this,U).config).onError)==null||R.call(S,u,this),(b=(w=i(this,U).config).onSettled)==null||b.call(w,this.state.data,u,this)),this.scheduleGc()};return c(this,g,ft({initialPromise:s==null?void 0:s.initialPromise,fn:a.fetchFn,abort:r.abort.bind(r),onSuccess:u=>{var S,R,w,b;if(u===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(u)}catch(p){o(p);return}(R=(S=i(this,U).config).onSuccess)==null||R.call(S,u,this),(b=(w=i(this,U).config).onSettled)==null||b.call(w,u,this.state.error,this),this.scheduleGc()},onError:o,onFail:(u,S)=>{m(this,I,M).call(this,{type:"failed",failureCount:u,error:S})},onPause:()=>{m(this,I,M).call(this,{type:"pause"})},onContinue:()=>{m(this,I,M).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),i(this,g).start()}},Z=new WeakMap,ee=new WeakMap,U=new WeakMap,g=new WeakMap,ae=new WeakMap,G=new WeakMap,I=new WeakSet,M=function(e){const s=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...tt(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=e.error;return pe(n)&&n.revert&&i(this,ee)?{...i(this,ee),fetchStatus:"idle"}:{...r,error:n,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=s(this.state),je.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),i(this,U).notify({query:this,type:"updated",action:e})})},ze);function tt(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ze(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function pt(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,s=e!==void 0,r=s?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var T,f,ue,O,B,te,q,j,he,se,re,N,z,k,ie,y,ne,we,Fe,Ee,Oe,Te,Ue,xe,st,Ve,bt=(Ve=class extends Pe{constructor(e,s){super();d(this,y);d(this,T);d(this,f);d(this,ue);d(this,O);d(this,B);d(this,te);d(this,q);d(this,j);d(this,he);d(this,se);d(this,re);d(this,N);d(this,z);d(this,k);d(this,ie,new Set);this.options=s,c(this,T,e),c(this,j,null),c(this,q,ge()),this.options.experimental_prefetchInRender||i(this,q).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,f).addObserver(this),ke(i(this,f),this.options)?m(this,y,ne).call(this):this.updateResult(),m(this,y,Oe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ie(i(this,f),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ie(i(this,f),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,m(this,y,Te).call(this),m(this,y,Ue).call(this),i(this,f).removeObserver(this)}setOptions(e,s){const r=this.options,n=i(this,f);if(this.options=i(this,T).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof P(this.options.enabled,i(this,f))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");m(this,y,xe).call(this),i(this,f).setOptions(this.options),r._defaulted&&!Re(this.options,r)&&i(this,T).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,f),observer:this});const h=this.hasListeners();h&&Ke(i(this,f),n,this.options,r)&&m(this,y,ne).call(this),this.updateResult(s),h&&(i(this,f)!==n||P(this.options.enabled,i(this,f))!==P(r.enabled,i(this,f))||fe(this.options.staleTime,i(this,f))!==fe(r.staleTime,i(this,f)))&&m(this,y,we).call(this);const a=m(this,y,Fe).call(this);h&&(i(this,f)!==n||P(this.options.enabled,i(this,f))!==P(r.enabled,i(this,f))||a!==i(this,k))&&m(this,y,Ee).call(this,a)}getOptimisticResult(e){const s=i(this,T).getQueryCache().build(i(this,T),e),r=this.createResult(s,e);return vt(this,r)&&(c(this,O,r),c(this,te,this.options),c(this,B,i(this,f).state)),r}getCurrentResult(){return i(this,O)}trackResult(e,s){const r={};return Object.keys(e).forEach(n=>{Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(n),s==null||s(n),e[n])})}),r}trackProp(e){i(this,ie).add(e)}getCurrentQuery(){return i(this,f)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=i(this,T).defaultQueryOptions(e),r=i(this,T).getQueryCache().build(i(this,T),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return m(this,y,ne).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,O)))}createResult(e,s){var Me;const r=i(this,f),n=this.options,h=i(this,O),a=i(this,B),o=i(this,te),C=e!==r?e.state:i(this,ue),{state:v}=e;let u={...v},S=!1,R;if(s._optimisticResults){const E=this.hasListeners(),W=!E&&ke(e,s),$=E&&Ke(e,r,s,n);(W||$)&&(u={...u,...tt(v.data,e.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:w,errorUpdatedAt:b,status:p}=u;if(s.select&&u.data!==void 0)if(h&&u.data===(a==null?void 0:a.data)&&s.select===i(this,he))R=i(this,se);else try{c(this,he,s.select),R=s.select(u.data),R=Se(h==null?void 0:h.data,R,s),c(this,se,R),c(this,j,null)}catch(E){c(this,j,E)}else R=u.data;if(s.placeholderData!==void 0&&R===void 0&&p==="pending"){let E;if(h!=null&&h.isPlaceholderData&&s.placeholderData===(o==null?void 0:o.placeholderData))E=h.data;else if(E=typeof s.placeholderData=="function"?s.placeholderData((Me=i(this,re))==null?void 0:Me.state.data,i(this,re)):s.placeholderData,s.select&&E!==void 0)try{E=s.select(E),c(this,j,null)}catch(W){c(this,j,W)}E!==void 0&&(p="success",R=Se(h==null?void 0:h.data,E,s),S=!0)}i(this,j)&&(w=i(this,j),R=i(this,se),b=Date.now(),p="error");const F=u.fetchStatus==="fetching",Q=p==="pending",K=p==="error",oe=Q&&F,ce=R!==void 0,D={status:p,fetchStatus:u.fetchStatus,isPending:Q,isSuccess:p==="success",isError:K,isInitialLoading:oe,isLoading:oe,data:R,dataUpdatedAt:u.dataUpdatedAt,error:w,errorUpdatedAt:b,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>C.dataUpdateCount||u.errorUpdateCount>C.errorUpdateCount,isFetching:F,isRefetching:F&&!Q,isLoadingError:K&&!ce,isPaused:u.fetchStatus==="paused",isPlaceholderData:S,isRefetchError:K&&ce,isStale:Qe(e,s),refetch:this.refetch,promise:i(this,q)};if(this.options.experimental_prefetchInRender){const E=le=>{D.status==="error"?le.reject(D.error):D.data!==void 0&&le.resolve(D.data)},W=()=>{const le=c(this,q,D.promise=ge());E(le)},$=i(this,q);switch($.status){case"pending":e.queryHash===r.queryHash&&E($);break;case"fulfilled":(D.status==="error"||D.data!==$.value)&&W();break;case"rejected":(D.status!=="error"||D.error!==$.reason)&&W();break}}return D}updateResult(e){const s=i(this,O),r=this.createResult(i(this,f),this.options);if(c(this,B,i(this,f).state),c(this,te,this.options),i(this,B).data!==void 0&&c(this,re,i(this,f)),Re(r,s))return;c(this,O,r);const n={},h=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!i(this,ie).size)return!0;const l=new Set(o??i(this,ie));return this.options.throwOnError&&l.add("error"),Object.keys(i(this,O)).some(C=>{const v=C;return i(this,O)[v]!==s[v]&&l.has(v)})};(e==null?void 0:e.listeners)!==!1&&h()&&(n.listeners=!0),m(this,y,st).call(this,{...n,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&m(this,y,Oe).call(this)}},T=new WeakMap,f=new WeakMap,ue=new WeakMap,O=new WeakMap,B=new WeakMap,te=new WeakMap,q=new WeakMap,j=new WeakMap,he=new WeakMap,se=new WeakMap,re=new WeakMap,N=new WeakMap,z=new WeakMap,k=new WeakMap,ie=new WeakMap,y=new WeakSet,ne=function(e){m(this,y,xe).call(this);let s=i(this,f).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(be)),s},we=function(){m(this,y,Te).call(this);const e=fe(this.options.staleTime,i(this,f));if(V||i(this,O).isStale||!me(e))return;const r=We(i(this,O).dataUpdatedAt,e)+1;c(this,N,setTimeout(()=>{i(this,O).isStale||this.updateResult()},r))},Fe=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,f)):this.options.refetchInterval)??!1},Ee=function(e){m(this,y,Ue).call(this),c(this,k,e),!(V||P(this.options.enabled,i(this,f))===!1||!me(i(this,k))||i(this,k)===0)&&c(this,z,setInterval(()=>{(this.options.refetchIntervalInBackground||Xe.isFocused())&&m(this,y,ne).call(this)},i(this,k)))},Oe=function(){m(this,y,we).call(this),m(this,y,Ee).call(this,m(this,y,Fe).call(this))},Te=function(){i(this,N)&&(clearTimeout(i(this,N)),c(this,N,void 0))},Ue=function(){i(this,z)&&(clearInterval(i(this,z)),c(this,z,void 0))},xe=function(){const e=i(this,T).getQueryCache().build(i(this,T),this.options);if(e===i(this,f))return;const s=i(this,f);c(this,f,e),c(this,ue,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},st=function(e){je.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(i(this,O))}),i(this,T).getQueryCache().notify({query:i(this,f),type:"observerResultsUpdated"})})},Ve);function mt(t,e){return P(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ke(t,e){return mt(t,e)||t.state.data!==void 0&&Ie(t,e,e.refetchOnMount)}function Ie(t,e,s){if(P(e.enabled,t)!==!1){const r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&Qe(t,e)}return!1}function Ke(t,e,s,r){return(t!==e||P(r.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&Qe(t,s)}function Qe(t,e){return P(e.enabled,t)!==!1&&t.isStaleByTime(fe(e.staleTime,t))}function vt(t,e){return!Re(t.getCurrentResult(),e)}var rt=x.createContext(void 0),Rt=t=>{const e=x.useContext(rt);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},_t=({client:t,children:e})=>(x.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),nt.jsx(rt.Provider,{value:t,children:e})),it=x.createContext(!1),Ct=()=>x.useContext(it);it.Provider;function St(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var gt=x.createContext(St()),wt=()=>x.useContext(gt);function Ft(t,e){return typeof t=="function"?t(...e):!!t}function _e(){}var Et=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Ot=t=>{x.useEffect(()=>{t.clearReset()},[t])},Tt=({result:t,errorResetBoundary:e,throwOnError:s,query:r})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&Ft(s,[t.error,r]),Ut=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...s)=>Math.max(e(...s),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},xt=(t,e)=>t.isLoading&&t.isFetching&&!e,It=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,He=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Pt(t,e,s){var u,S,R,w,b;const r=Rt(),n=Ct(),h=wt(),a=r.defaultQueryOptions(t);(S=(u=r.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||S.call(u,a),a._optimisticResults=n?"isRestoring":"optimistic",Ut(a),Et(a,h),Ot(h);const o=!r.getQueryCache().get(a.queryHash),[l]=x.useState(()=>new e(r,a)),C=l.getOptimisticResult(a),v=!n&&t.subscribed!==!1;if(x.useSyncExternalStore(x.useCallback(p=>{const F=v?l.subscribe(je.batchCalls(p)):_e;return l.updateResult(),F},[l,v]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),x.useEffect(()=>{l.setOptions(a,{listeners:!1})},[a,l]),It(a,C))throw He(a,l,h);if(Tt({result:C,errorResetBoundary:h,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash)}))throw C.error;if((w=(R=r.getDefaultOptions().queries)==null?void 0:R._experimental_afterQuery)==null||w.call(R,a,C),a.experimental_prefetchInRender&&!V&&xt(C,n)){const p=o?He(a,l,h):(b=r.getQueryCache().get(a.queryHash))==null?void 0:b.promise;p==null||p.catch(_e).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?C:l.trackResult(C)}function Ht(t,e){return Pt(t,bt)}export{_t as Q,yt as R,Pe as S,Kt as a,At as b,ft as c,be as d,ht as e,kt as f,qt as g,at as h,Xe as i,Mt as j,ve as k,Re as l,Lt as m,je as n,Ye as o,De as p,Rt as q,fe as r,Je as s,_e as t,Ht as u,Ft as v};
