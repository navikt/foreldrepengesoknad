import{j as s}from"./jsx-runtime-DoxjgJx5.js";import{u as V,k as _,b as d,l as k,i as f}from"./Tidsperioden-BXZJ7Xx1.js";import{r as B}from"./index-Cu9bd8lq.js";import"./index-C-6Uy6j4.js";import{d as L}from"./globalUtil-C9WE76GY.js";import{i as T,m as b}from"./attachmentType-bBGQaA6h.js";import"./_baseToString-yTMKM5a7.js";import"./_createSet-BNfKGSGn.js";import{S as N}from"./Step-D87D-j42.js";import{E as w}from"./Environment-O62Hvuhd.js";import{g as z}from"./apiInterceptor-D_vgNGab.js";import{A as D}from"./AttachmentList-WdtErbjc.js";import{B as R}from"./Link-BqZ6CohM.js";function U(e){const t={withCredentials:!0,timeout:45e3,headers:{"content-type":"multipart/form-data"}},i=new FormData;i.append("id",e.id),i.append("vedlegg",e.file,e.filename);const n=`${w.REST_API_URL}/storage/foreldrepenger/vedlegg`;return z().post(n,i,t)}const C={saveAttachment:U},F=[".pdf",".jpeg",".jpg",".png"],x=16384,K=.0009765625,G=(e,t,i)=>e.map(n=>{const r=b(n,t,i);return r.pending=!0,r}),O=e=>{const t=e.split(".").pop();return F.includes(`.${t.toLowerCase()}`)},$=e=>e*K<=x,P=(e,t,i)=>e.filter(n=>{const r=O(n.filename);r||t(o=>o.concat(f(i,"vedlegg.feilmelding.ugyldig.type",{filename:n.filename})));const a=$(n.filesize);return a||t(o=>o.concat(f(i,"vedlegg.feilmelding.ugyldig.størrelse",{filename:n.filename,maxStørrelse:x}))),r&&a}),X=(e,t,i,n,r,a)=>{e.forEach(async(o,c)=>{try{const m=await C.saveAttachment(o);o.pending=!1,o.url=m.headers.location,o.uploaded=!0,o.uuid=m.data,t(r+c,o)}catch{i(r+c),n(p=>p.concat(f(a,"vedlegg.feilmelding.opplasting.feilet",{filename:o.filename})))}})},y=({attachments:e,name:t,onFileInputClick:i,attachmentType:n,skjemanummer:r,label:a,legend:o,...c})=>{const m=V(),{setFieldValue:p}=_(),[u,g]=B.useState([]);return s.jsxs(s.Fragment,{children:[s.jsx(d,{padBottom:"xl",children:s.jsx(k,{legend:o,buttonLabel:a,name:t,accept:F.join(", "),onFilesSelect:(l,{push:I,replace:j,remove:E})=>{const S=G(l,n,r),h=P(S,g,m);h.forEach(A=>I(A)),X(h,j,E,g,e.length,m)},onClick:i,error:u.length>0?u.map(l=>s.jsx(R,{children:l},l)):void 0,...c})}),s.jsx(d,{padBottom:"xl",visible:e.length>0,children:s.jsx(D,{attachments:e.filter(l=>!T(l)),showFileSize:!0,onDelete:l=>{p(t,L(e,l))}})}),s.jsx(d,{padBottom:"l",children:s.jsx(N,{})})]})},ne=y;y.__docgenInfo={description:"",methods:[],displayName:"FormikFileUploader"};export{ne as F};
