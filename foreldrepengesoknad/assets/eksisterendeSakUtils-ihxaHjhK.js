import{i as L,ab as Te,d as P,ac as $,U as G,b as x,ad as q,ae as F,af as I,aa as oe,I as Se}from"./Tidsperioden-C6mWeONA.js";import"./jsx-runtime-CexXSJP5.js";import"./index-CSpfAsmC.js";import{g as p}from"./guid-CsArkN6i.js";import{N as de,J as M,O as z,Q as Re,P as w,T as c,L as pe,U as Ie,V as ge,W as v,X as H,Y as V,Z as y,_ as S,$ as R,a0 as _e,D as j,a1 as Oe,a2 as b}from"./useFpNavigator-B35OhR2f.js";import{i as B,j as Pe,o as Ne,B as U}from"./FpDataContext-BTc1vbhf.js";import"./index-BP8_t0zE.js";import"./_baseToString-7VaozA17.js";import"./_createSet-W-93wHM-.js";import{c as Ue}from"./velkommenUtils-C5gjmvar.js";import{g as se,d as J}from"./dateUtils-BC7Ub2_c.js";var Q=(e=>(e.ÅTTI_PROSENT="ÅTTI",e.HUNDRE_PROSENT="HUNDRE",e))(Q||{}),g=(e=>(e.ADOPSJON="ADPSJN",e.OMSORGSOVERTAKELSE="OMSRGO",e.FØDSEL="FODSL",e.TERM="TERM",e))(g||{}),_=(e=>(e.UttakFellesperiodeAnnenForelder="FELLESPERIODE_ANNEN_FORELDER",e.UttakFedrekvoteAnnenForelder="FEDREKVOTE_ANNEN_FORELDER",e.UttakMødrekvoteAnnenForelder="MØDREKVOTE_ANNEN_FORELDER",e.UttakForeldrepengerAnnenForelder="FORELDREPENGER_ANNEN_FORELDER",e.Ingen="INGEN",e))(_||{}),D=(e=>(e.AVSLAG_FRATREKK_PLEIEPENGER="AVSLAG_FRATREKK_PLEIEPENGER",e.AVSLAG_UTSETTELSE_TILBAKE_I_TID="AVSLAG_UTSETTELSE_TILBAKE_I_TID",e.INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID="INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID",e.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER="AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER",e.ANNET="ANNET",e))(D||{}),A=(e=>(e.Ferie="LOVBESTEMT_FERIE",e.Arbeid="ARBEID",e.Sykdom="SØKER_SYKDOM",e.InstitusjonSøker="SØKER_INNLAGT",e.InstitusjonBarnet="BARN_INNLAGT",e.HvØvelse="HV_ØVELSE",e.NavTiltak="NAV_TILTAK",e.Fri="FRI",e))(A||{}),Y=(e=>(e.ORDINÆRT_ARBEID="ORDINÆRT_ARBEID",e.SELVSTENDIG_NÆRINGSDRIVENDE="SELVSTENDIG_NÆRINGSDRIVENDE",e.FRILANS="FRILANS",e.ANNET="ANNET",e))(Y||{}),N=(e=>(e.BARE_SØKER_RETT="BARE_SØKER_RETT",e.ALENEOMSORG="ALENEOMSORG",e.BEGGE_RETT="BEGGE_RETT",e))(N||{});const ie=(e,r,t)=>{if(t!==void 0)return g.ADOPSJON;if(e!==void 0)return g.FØDSEL;if(r!==void 0)return g.TERM;throw new Error("Fødselsdato/ termindato/ omsorgsovertakelsedato mangler")},fr=(e,r,t)=>e?L(t,"adopsjon"):r?L(t,"fødsel"):L(t,"termin"),C=e=>w(e).getAntallUttaksdager()>0,Le=e=>Te(e.tidsperiode),Me=(e,r,t)=>{if(e.length<=1)return e;const n=[],o=e.filter(a=>M(a)),l=[...e.filter(a=>!M(a)),...o];let i={...l[0]};return l.forEach((a,f)=>{if(f!==0){if(i===void 0){i=a;return}if(w(i).erLik(a,!1,!0)&&w(i).erSammenhengende(a)&&!P(a.tidsperiode.fom).isSame(r,"day")&&!(t!==void 0&&P(a.tidsperiode.fom).isSame(t,"day"))){i.tidsperiode.tom=a.tidsperiode.tom;return}else n.push(i);i=a}}),n.push(i),n.sort(de)},De=e=>{const{fom:r,tom:t}=e.tidsperiode,n=$(r),o=$(t);return n&&o?e:!n&&!o?{...e,tidsperiode:{fom:G(r).neste(),tom:G(t).forrige()}}:!n&&o?{...e,tidsperiode:{fom:G(r).neste(),tom:t}}:{...e,tidsperiode:{fom:r,tom:G(t).forrige()}}},O=(e,r)=>e.gjelderAnnenPart?r?y.mor:y.farMedmor:r?y.farMedmor:y.mor,ae=e=>{switch(e){case A.Arbeid:return S.Arbeid;case A.Ferie:return S.Ferie;case A.InstitusjonBarnet:return S.InstitusjonBarnet;case A.InstitusjonSøker:return S.InstitusjonSøker;case A.Sykdom:return S.Sykdom;case A.HvØvelse:return S.HvØvelse;case A.NavTiltak:return S.NavTiltak;case A.Fri:return S.Fri;default:return}},he=e=>{switch(e.kontoType){case c.Fedrekvote:return R.UttakFedrekvoteAnnenForelder;case c.Fellesperiode:return R.UttakFellesperiodeAnnenForelder;case c.Mødrekvote:return R.UttakMødrekvoteAnnenForelder;case c.Foreldrepenger:return R.UttakForeldrepengerAnnenForelder;case c.ForeldrepengerFørFødsel:return R.ForeldrepengerFørFødsel;default:return}},le=(e,r,t)=>{if(e)return e.toString();if(r)return t?(100-t).toString():"100"},Ge=e=>e?c.AktivitetsfriKvote:c.Foreldrepenger,ye=(e,r,t,n)=>{if(e&&!r.flerbarnsdager&&!r.samtidigUttak&&P(r.periode.fom).isBefore(P(t).add(6,"weeks"),"day")&&n!==c.AktivitetsfriKvote&&r.morsAktivitet!==_e.Uføre)return!0},Ve=(e,r,t)=>{var h;const n=e.gradering!==void 0&&e.resultat.innvilget,o=F(e.periode),d=r.søkerErFarEllerMedmor&&!r.morHarRett&&!r.farMedmorErAleneOmOmsorg&&!r.harAnnenForelderTilsvarendeRettEØS,l=t!==void 0?t.find(T=>(I(F(T.periode)).erLik(o)||I(F(T.periode)).overlapper(o))&&T.guid!==e.guid):void 0;let i;l&&(i=l.samtidigUttak);const a=le(e.samtidigUttak,i,(h=e.gradering)==null?void 0:h.arbeidstidprosent),f=fe(e),{termindato:E,fødselsdato:s,omsorgsovertakelsesdato:m}=r,k=se(E,s,m),u=d?Ge(e.resultat.trekkerMinsterett):e.kontoType;return{id:p(),type:v.Uttak,konto:u,tidsperiode:o,forelder:O(e,r.søkerErFarEllerMedmor),ønskerSamtidigUttak:e.samtidigUttak!==void 0,gradert:n,samtidigUttakProsent:a,ønskerFlerbarnsdager:r.antallBarn>1?e.flerbarnsdager:void 0,stillingsprosent:n?e.gradering.arbeidstidprosent.toString():void 0,arbeidsformer:n?[xe(e.gradering.aktivitet.type)]:void 0,orgnumre:n&&e.gradering.aktivitet.arbeidsgiver!==void 0?[e.gradering.aktivitet.arbeidsgiver.id]:void 0,morsAktivitetIPerioden:e.morsAktivitet,erMorForSyk:ye(r.søkerErFarEllerMedmor,e,k,u),angittAvAnnenPart:e.angittAvAnnenPart,opprinneligSøkt:f}},je=(e,r)=>({id:p(),type:v.Utsettelse,årsak:ae(e.utsettelseÅrsak),tidsperiode:F(e.periode),forelder:O(e,r),erArbeidstaker:!1,morsAktivitetIPerioden:e.morsAktivitet}),fe=e=>{if(e.resultat.årsak===D.AVSLAG_UTSETTELSE_TILBAKE_I_TID){if(e.utsettelseÅrsak===A.Ferie)return H.Ferie;if(e.utsettelseÅrsak===A.Arbeid)return H.Arbeid}if(e.resultat.årsak===D.INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID)return H.Gradering},Ke=(e,r)=>{const t=fe(e);return{id:p(),type:v.Info,infotype:V.avslåttPeriode,tidsperiode:F(e.periode),avslåttPeriodeType:e.utsettelseÅrsak!==void 0?v.Utsettelse:v.Uttak,kontoType:e.kontoType,forelder:O(e,r),overskrives:!0,visPeriodeIPlan:!0,kanSlettes:e.resultat.årsak!==D.AVSLAG_FRATREKK_PLEIEPENGER,opprinneligSøkt:t}},He=(e,r,t,n)=>{var E;const o=F(e.periode);if(e.utsettelseÅrsak!==void 0&&e.resultat.innvilget===!0)return{type:v.Info,infotype:V.utsettelseAnnenPart,id:p(),årsak:ae(e.utsettelseÅrsak),tidsperiode:o,forelder:O(e,r),overskrives:!0,visPeriodeIPlan:!0};const d=n!==void 0&&!n.some(s=>(I(F(s.periode)).erLik(o)||I(F(s.periode)).overlapper(o))&&s.guid!==e.guid),l=he(e),i=n!==void 0?n.find(s=>(I(F(s.periode)).erLik(o)||I(F(s.periode)).overlapper(o))&&s.guid!==e.guid):void 0;let a;i&&(a=i.samtidigUttak);const f=le(e.samtidigUttak,a,(E=e.gradering)==null?void 0:E.arbeidstidprosent);return W(e,t)?{type:v.Info,infotype:V.avslåttPeriode,id:p(),tidsperiode:o,forelder:O(e,r),overskrives:!0,visPeriodeIPlan:d,kontoType:e.kontoType,avslåttPeriodeType:v.Uttak,kanSlettes:!1}:{type:v.Info,infotype:V.uttakAnnenPart,id:p(),årsak:l,tidsperiode:o,forelder:O(e,r),overskrives:!0,gradert:e.gradering!==void 0,ønskerSamtidigUttak:f!==void 0,samtidigUttakProsent:f,stillingsprosent:e.gradering!==void 0?e.gradering.arbeidstidprosent.toString():void 0,visPeriodeIPlan:d}},be=(e,r)=>({id:p(),forelder:O(e,r),konto:e.kontoType,tidsperiode:F(e.periode),type:v.Overføring,årsak:e.overføringÅrsak}),we=(e,r,t)=>{const n=t.filter(o=>!W(o,r.termindato));return e.gjelderAnnenPart?He(e,r.søkerErFarEllerMedmor,r.termindato,n):e.resultat.innvilget?e.utsettelseÅrsak!==void 0?je(e,r.søkerErFarEllerMedmor):e.overføringÅrsak!==void 0?be(e,r.søkerErFarEllerMedmor):Ve(e,r,n):Ke(e,r.søkerErFarEllerMedmor)},W=(e,r)=>r&&e.gjelderAnnenPart&&!e.resultat.innvilget&&e.resultat.trekkerDager&&P(e.periode.tom).isBefore(P(x(r)),"d")&&e.kontoType!==c.Fedrekvote,Je=(e,r)=>e.resultat.innvilget?!0:e.gjelderAnnenPart?!!W(e,r):e.resultat.årsak!==D.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER&&e.resultat.trekkerDager===!0,Ye=(e,r,t)=>{const n=[];return e.forEach(o=>{q(o.tidsperiode,r)&&pe(o)?Ie(o,r).forEach(l=>n.push(l)):t!==void 0&&q(o.tidsperiode,t)?ge(o,t).forEach(l=>n.push(l)):n.push(o)}),n},me=(e,r,t)=>{const n=e.filter(u=>Je(u,r.termindato)),o=n.map(u=>we(u,r,n)),d=new Date(r.familiehendelseDato),l=Ye(o,d,t),i=Me([...l].sort(de).filter(C).map(De).filter(Le).filter(C),d,t),a=!r.morHarRett&&r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,f=r.familiehendelseType===g.ADOPSJON,E=i.filter(u=>!M(u)),s=i.filter(u=>M(u)),m=!r.erDeltUttak&&a&&!r.farMedmorErAleneOmOmsorg,k=z(E,m,d,f,a,r.søkerErFarEllerMedmor,t);return z(Re(k,s,d,t),m,d,f,a,r.søkerErFarEllerMedmor,t)},xe=e=>{switch(e){case Y.SELVSTENDIG_NÆRINGSDRIVENDE:return b.selvstendignæringsdrivende;case Y.FRILANS:return b.frilans;default:return b.arbeidstaker}},ee=e=>{switch(e){case _.UttakFedrekvoteAnnenForelder:return c.Fedrekvote;case _.UttakFellesperiodeAnnenForelder:return c.Fellesperiode;case _.UttakMødrekvoteAnnenForelder:return c.Mødrekvote;default:return}},Qe=e=>{switch(e){case _.UttakFedrekvoteAnnenForelder:return R.UttakFedrekvoteAnnenForelder;case _.UttakFellesperiodeAnnenForelder:return R.UttakFellesperiodeAnnenForelder;case _.UttakMødrekvoteAnnenForelder:return R.UttakMødrekvoteAnnenForelder;default:return}},Ee=(e,r)=>{const{oppholdÅrsak:t}=e,n={guid:p(),periode:{fom:e.fom,tom:e.tom},gjelderAnnenPart:r,resultat:e.resultat,kontoType:e.kontoType,flerbarnsdager:e.flerbarnsdager,gradering:e.gradering,utsettelseÅrsak:e.utsettelseÅrsak,overføringÅrsak:e.overføringÅrsak,samtidigUttak:e.samtidigUttak,morsAktivitet:e.morsAktivitet,oppholdÅrsak:Qe(e.oppholdÅrsak)};return t!==void 0&&r===!1&&(n.gjelderAnnenPart=!0,n.kontoType=ee(t)),t!==void 0&&r&&(n.gjelderAnnenPart=!1,n.angittAvAnnenPart=!0,n.kontoType=ee(t)),n},re=e=>e.resultat.innvilget,ue=(e,r,t)=>{const n=t.filter(d=>e.guid!==d.guid&&I(F(e.periode)).erLik(F(d.periode)));if(n.length===0)return!0;const o=n.filter(re);return!(re(e)===!1&&o.length>0)},mr=e=>{if(!(e===void 0||e===""||Object.keys(e).length===0||e.perioder.length===0))return x(e.perioder[0].fom)},Er=(e,r,t,n,o)=>{if(e==null)return;const d=!0,l=e.perioder.map(m=>Ee(m,d)).filter(ue);let i;e.termindato!==void 0?i=e.termindato:(B(r)||Pe(r))&&r.termindato!==void 0&&(i=r.termindato);const a=B(r)?r.fødselsdatoer[0]:void 0,f=Ne(r)?r.adopsjonsdato:void 0,E={dekningsgrad:e.dekningsgrad===Q.HUNDRE_PROSENT?j.HUNDRE_PROSENT:j.ÅTTI_PROSENT,antallBarn:e.antallBarn?e.antallBarn:r.antallBarn,morErAleneOmOmsorg:!1,morErUfør:!1,morHarRett:!0,farMedmorErAleneOmOmsorg:!1,farMedmorHarRett:!0,søkerErFarEllerMedmor:t,termindato:i,fødselsdato:a,omsorgsovertakelsesdato:f,erDeltUttak:!0,erBarnetFødt:a!==void 0,familiehendelseDato:n,familiehendelseType:ie(a,i,f),harAnnenForelderTilsvarendeRettEØS:!1,ønskerJustertUttakVedFødsel:void 0,barn:[]},s=me(l,E,o);return{saksnummer:"",erAnnenPartsSak:d,grunnlag:E,saksperioder:l,uttaksplan:s.filter(m=>M(m))}},We=(e,r,t)=>{if(e==null)return;const n=!1,{dekningsgrad:o,familiehendelse:{fødselsdato:d,termindato:l,omsorgsovertakelse:i,antallBarn:a},harAnnenForelderTilsvarendeRettEØS:f,morUføretrygd:E,rettighetType:s,sakTilhørerMor:m,ønskerJustertUttakVedFødsel:k}=e,u=e.gjeldendeVedtak?e.gjeldendeVedtak.perioder:[],K=!m,h=t&&t.length>0?oe(t[0]):void 0,T=d||h,X={dekningsgrad:o===Q.HUNDRE_PROSENT?j.HUNDRE_PROSENT:j.ÅTTI_PROSENT,antallBarn:a,morErAleneOmOmsorg:m&&s===N.ALENEOMSORG,morErUfør:E,morHarRett:m||s===N.BEGGE_RETT,farMedmorErAleneOmOmsorg:!m&&s===N.ALENEOMSORG,farMedmorHarRett:!m||s===N.BEGGE_RETT,søkerErFarEllerMedmor:K,termindato:l,fødselsdato:T,omsorgsovertakelsesdato:i,erDeltUttak:s===N.BEGGE_RETT,erBarnetFødt:T!==void 0,familiehendelseDato:se(l,T,i),familiehendelseType:ie(T,l,i),ønskerJustertUttakVedFødsel:T===void 0?k:void 0,harAnnenForelderTilsvarendeRettEØS:f},Z=u.map(ve=>Ee(ve,n)).filter(ue),ke=me(Z,X,r);return{saksnummer:e.saksnummer,erAnnenPartsSak:n,grunnlag:X,saksperioder:Z,uttaksplan:ke}},Fe=e=>e===g.TERM||e===g.FØDSEL?"fødsel":"adopsjon",Xe=(e,r,t)=>{const{søkerErFarEllerMedmor:n}=t,o=e.kjønn==="K";switch(r){case"fødsel":case"adopsjon":return o?n?"medmor":"mor":"far";default:return}},te=(e,r)=>e!=null&&e.fødselsdatoer?J(e.fødselsdatoer):r.fødselsdato?Array(r.antallBarn).fill(r.fødselsdato):[],Ze=(e,r,t)=>{switch(e){case"fødsel":return r.fødselsdato?{type:U.FØDT,antallBarn:r.antallBarn,fødselsdatoer:te(t,r),termindato:r.termindato?r.termindato:void 0,fnr:t==null?void 0:t.fnr}:{type:U.UFØDT,antallBarn:r.antallBarn,termindato:r.termindato};case"adopsjon":return{type:U.ADOPTERT_STEBARN,adopsjonsdato:r.omsorgsovertakelsesdato,antallBarn:r.antallBarn,fødselsdatoer:te(t,r),fnr:t==null?void 0:t.fnr};default:return}},ne=(e,r)=>e.fornavn!==void 0&&e.fornavn!==""?e.fornavn:r.formatMessage({id:"annen.forelder"}),$e=(e,r,t,n,o)=>{switch(e){case"fødsel":case"adopsjon":return n?{fornavn:ne(t,o),etternavn:t.etternavn,erMorUfør:r.morErUfør,harRettPåForeldrepengerINorge:!!r.morHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS,erAleneOmOmsorg:r.farMedmorErAleneOmOmsorg}:{fornavn:ne(t,o),etternavn:t.etternavn,harRettPåForeldrepengerINorge:!!r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS,erAleneOmOmsorg:r.farMedmorErAleneOmOmsorg||r.morErAleneOmOmsorg};default:return}},qe=(e,r,t,n,o,d,l)=>{var E;if(d===void 0&&r===void 0||!l)return;const i=d!==void 0?e.find(s=>d.includes(s.fnr)&&s.annenForelder!==void 0):void 0,a=r!==void 0?e.find(s=>Ue(s.fødselsdato,r)&&s.annenForelder!==void 0):void 0,f=i||a;if(f!==void 0&&((E=f.annenForelder)==null?void 0:E.fnr)===l){const s=f.annenForelder,{fornavn:m}=s,k=m!==void 0&&m.trim()!==""?m:L(o,"annen.forelder"),u={...s,fornavn:k};return $e(n,t,u,t.søkerErFarEllerMedmor,o)}},ce=e=>e.fødselsdatoer!==void 0&&e.fødselsdatoer.length>0?{type:U.FØDT,antallBarn:e.antallBarn,fødselsdatoer:J(e.fødselsdatoer),termindato:oe(e.termindato),fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0}:e.termindato!==void 0?{type:U.UFØDT,antallBarn:e.antallBarn,termindato:P(e.termindato).format(Se)}:{type:U.IKKE_UTFYLT,antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer?J(e.fødselsdatoer):[],fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0},ze=e=>e.annenForelder!==void 0?{fornavn:e.annenForelder.fornavn,etternavn:e.annenForelder.etternavn,fnr:e.annenForelder.fnr,kanIkkeOppgis:!1}:{kanIkkeOppgis:!1},Be=e=>{const r=Oe(e);if(r==="K")return"medmor";if(r==="M")return"far";throw new Error("Kan ikke utlede kjønn fra fødselsnummer.")},ur=e=>{const r=ce(e),t=ze(e);return{barn:r,annenForelder:t,erEndringssøknad:!1}},Ae=(e,r,t,n,o,d)=>{const l=r!==void 0?r.fnr:void 0,i={fornavn:L(e,"annen.forelder"),etternavn:"",fnr:l??"",harRettPåForeldrepengerINorge:t.søkerErFarEllerMedmor?t.morHarRett&&!t.harAnnenForelderTilsvarendeRettEØS:t.farMedmorHarRett&&!t.harAnnenForelderTilsvarendeRettEØS,harRettPåForeldrepengerIEØS:t.harAnnenForelderTilsvarendeRettEØS,kanIkkeOppgis:!1,erMorUfør:t.søkerErFarEllerMedmor?t.morErUfør:void 0,erAleneOmOmsorg:t.farMedmorErAleneOmOmsorg||t.morErAleneOmOmsorg};return qe(n,x(t.fødselsdato),t,o,e,d,l)||i},Fr=(e,r,t,n)=>{var E;const o=We(e.sak,void 0,e.fødselsdatoer),{grunnlag:d}=o,l=Fe(d.familiehendelseType),i=ce(e),a=Ae(r,(E=e.sak)==null?void 0:E.annenPart,d,t,l,e.fnr),f={barn:i,annenForelder:a,erEndringssøknad:!1,dekningsgrad:d.dekningsgrad};if(e.sak!==void 0){const s=e.sak.sakTilhørerMor?"mor":Be(n),m={situasjon:e.sak.gjelderAdopsjon?"adopsjon":"fødsel",rolle:s};f.søkersituasjon=m}return f},cr=(e,r,t,n,o)=>{const{grunnlag:d,uttaksplan:l}=r,{dekningsgrad:i,familiehendelseType:a,søkerErFarEllerMedmor:f,ønskerJustertUttakVedFødsel:E}=d,s=Fe(a);if(!s)return;const m=Ze(s,d,o),k=Xe(e,s,d);if(!m||!k)return;const u=Ae(t,n,d,e.barn,s,o==null?void 0:o.fnr);return{søkersituasjon:{situasjon:s,rolle:k},barn:m,annenForelder:{...u,erAleneOmOmsorg:f?d.farMedmorErAleneOmOmsorg:d.morErAleneOmOmsorg},erEndringssøknad:!0,dekningsgrad:i,uttaksplan:l,saksnummer:r.saksnummer,ønskerJustertUttakVedFødsel:E}};export{Q as D,N as R,Fr as a,ur as b,Er as c,mr as d,fr as g,We as m,cr as o};
