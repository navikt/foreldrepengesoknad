import{j as s}from"./jsx-runtime-CexXSJP5.js";import{u as V,j as k,B as d,k as B,i as f}from"./Tidsperioden-CVu3e1Oj.js";import{r as _}from"./index-BP8_t0zE.js";import"./index-CSpfAsmC.js";import{d as L}from"./globalUtil-Ds9yPXt7.js";import{i as T,m as w}from"./vedleggUtils-BXN25_YW.js";import"./_baseToString-7VaozA17.js";import"./_createSet-W-93wHM-.js";import{a as D}from"./ByttBrowserModal-B57CghBC.js";import{g as N}from"./apiInterceptor-D-WKbiXB.js";import{A as R}from"./AttachmentList-Cv1_A8rv.js";import{B as C}from"./Link-DYtqBS4e.js";function U(e){const t={withCredentials:!0,timeout:45e3,headers:{"content-type":"multipart/form-data"}},i=new FormData;return i.append("id",e.id),i.append("vedlegg",e.file,e.filename),N().post("/rest/storage/foreldrepenger/vedlegg",i,t)}const b={saveAttachment:U},h=[".pdf",".jpeg",".jpg",".png"],x=16,z=x*1024*1024,G=(e,t,i)=>e.map(r=>{const n=w(r,t,i);return n.pending=!0,n}),M=e=>{const t=e.split(".").pop();return h.includes(`.${t.toLowerCase()}`)},X=e=>e<=z,O=(e,t,i)=>e.filter(r=>{const n=M(r.filename);n||t(o=>o.concat(f(i,"vedlegg.feilmelding.ugyldig.type",{filename:r.filename})));const a=X(r.filesize);return a||t(o=>o.concat(f(i,"vedlegg.feilmelding.ugyldig.størrelse",{filename:r.filename,maxStørrelse:x}))),n&&a}),$=(e,t,i,r,n,a)=>{e.forEach(async(o,m)=>{try{const c=await b.saveAttachment(o);o.pending=!1,o.url=c.headers.location,o.uploaded=!0,o.uuid=c.data,t(n+m,o)}catch{i(n+m),r(p=>p.concat(f(a,"vedlegg.feilmelding.opplasting.feilet",{filename:o.filename})))}})},j=({attachments:e,name:t,onFileInputClick:i,attachmentType:r,skjemanummer:n,label:a,legend:o,...m})=>{const c=V(),{setFieldValue:p}=k(),[g,u]=_.useState([]);return s.jsxs(s.Fragment,{children:[s.jsx(d,{padBottom:"xl",children:s.jsx(B,{legend:o,buttonLabel:a,name:t,accept:h.join(", "),onFilesSelect:(l,{push:y,replace:S,remove:A})=>{const E=G(l,r,n),F=O(E,u,c);F.forEach(I=>y(I)),$(F,S,A,u,e.length,c)},onClick:i,error:g.length>0?g.map(l=>s.jsx(C,{children:l},l)):void 0,...m})}),s.jsx(d,{padBottom:"xl",visible:e.length>0,children:s.jsx(R,{attachments:e.filter(l=>!T(l)),showFileSize:!0,onDelete:l=>{p(t,L(e,l))}})}),s.jsx(d,{padBottom:"l",children:s.jsx(D,{})})]})},oe=j;j.__docgenInfo={description:"",methods:[],displayName:"FormikFileUploader"};export{oe as F};
