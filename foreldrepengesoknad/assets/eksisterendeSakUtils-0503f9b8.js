import{i as I,j as Fe,d as D,aw as z,U as V,I as g,X as C,ab as c,T as p,g as R,t as j,E as b}from"./Tidsperioden-1f4512e5.js";import"./jsx-runtime-1caa8f64.js";import"./index-753920cd.js";import"./index-1cdf6ce0.js";import"./_baseToString-2517c4f7.js";import"./_createSet-019d3bf6.js";import{g as te,s as B}from"./dateUtils-4bfbba32.js";import{f as Q,s as ve,a as ke,b as Ae,M as Te,A as w}from"./leggTilPeriode-1d28b3cd.js";import{O as S}from"./uttaksPlanStatus-02a1b7a2.js";import{a as G,h as x,S as F,b as Se,P as A,O as J,o as K,U as T}from"./Perioden-ca2a3b5d.js";import{s as ne,D as H}from"./Periodene-56b794dc.js";import{q as W,t as Re,u as pe,B as L}from"./barnUtils-a1c59311.js";import{b as Ie}from"./velkommenUtils-b2811faf.js";var q=(e=>(e.ÅTTI_PROSENT="ÅTTI",e.HUNDRE_PROSENT="HUNDRE",e))(q||{}),P=(e=>(e.ADOPSJON="ADPSJN",e.OMSORGSOVERTAKELSE="OMSRGO",e.FØDSEL="FODSL",e.TERM="TERM",e))(P||{}),_=(e=>(e.UttakFellesperiodeAnnenForelder="FELLESPERIODE_ANNEN_FORELDER",e.UttakFedrekvoteAnnenForelder="FEDREKVOTE_ANNEN_FORELDER",e.UttakMødrekvoteAnnenForelder="MØDREKVOTE_ANNEN_FORELDER",e.UttakForeldrepengerAnnenForelder="FORELDREPENGER_ANNEN_FORELDER",e.Ingen="INGEN",e))(_||{}),y=(e=>(e.AVSLAG_FRATREKK_PLEIEPENGER="AVSLAG_FRATREKK_PLEIEPENGER",e.AVSLAG_UTSETTELSE_TILBAKE_I_TID="AVSLAG_UTSETTELSE_TILBAKE_I_TID",e.INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID="INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID",e.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER="AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER",e.ANNET="ANNET",e))(y||{}),v=(e=>(e.Ferie="LOVBESTEMT_FERIE",e.Arbeid="ARBEID",e.Sykdom="SØKER_SYKDOM",e.InstitusjonSøker="SØKER_INNLAGT",e.InstitusjonBarnet="BARN_INNLAGT",e.HvØvelse="HV_ØVELSE",e.NavTiltak="NAV_TILTAK",e.Fri="FRI",e))(v||{}),Y=(e=>(e.ORDINÆRT_ARBEID="ORDINÆRT_ARBEID",e.SELVSTENDIG_NÆRINGSDRIVENDE="SELVSTENDIG_NÆRINGSDRIVENDE",e.FRILANS="FRILANS",e.ANNET="ANNET",e))(Y||{}),U=(e=>(e.BARE_SØKER_RETT="BARE_SØKER_RETT",e.ALENEOMSORG="ALENEOMSORG",e.BEGGE_RETT="BEGGE_RETT",e))(U||{});const oe=(e,r,t)=>{if(t!==void 0)return P.ADOPSJON;if(e!==void 0)return P.FØDSEL;if(r!==void 0)return P.TERM;throw new Error("Fødselsdato/ termindato/ omsorgsovertakelsedato mangler")},ir=(e,r,t)=>e?I(t,"adopsjon"):r?I(t,"fødsel"):I(t,"termin"),Z=e=>x(e).getAntallUttaksdager()>0,ge=e=>Fe(e.tidsperiode),Pe=(e,r,t)=>{if(e.length<=1)return e;const n=[],o=e.filter(i=>G(i)),l=[...e.filter(i=>!G(i)),...o];let a={...l[0]};return l.forEach((i,f)=>{if(f!==0){if(a===void 0){a=i;return}if(x(a).erLik(i,!1,!0)&&x(a).erSammenhengende(i)&&!D(i.tidsperiode.fom).isSame(r,"day")&&!(t!==void 0&&D(i.tidsperiode.fom).isSame(t,"day"))){a.tidsperiode.tom=i.tidsperiode.tom;return}else n.push(a);a=i}}),n.push(a),n.sort(ne)},_e=e=>{const{fom:r,tom:t}=e.tidsperiode,n=z(r),o=z(t);return n&&o?e:!n&&!o?{...e,tidsperiode:{fom:V(r).neste(),tom:V(t).forrige()}}:!n&&o?{...e,tidsperiode:{fom:V(r).neste(),tom:t}}:{...e,tidsperiode:{fom:r,tom:V(t).forrige()}}},N=(e,r)=>e.gjelderAnnenPart?r?j.mor:j.farMedmor:r?j.farMedmor:j.mor,de=e=>{switch(e){case v.Arbeid:return T.Arbeid;case v.Ferie:return T.Ferie;case v.InstitusjonBarnet:return T.InstitusjonBarnet;case v.InstitusjonSøker:return T.InstitusjonSøker;case v.Sykdom:return T.Sykdom;case v.HvØvelse:return T.HvØvelse;case v.NavTiltak:return T.NavTiltak;case v.Fri:return T.Fri;default:return}},Ne=e=>{switch(e.kontoType){case F.Fedrekvote:return S.UttakFedrekvoteAnnenForelder;case F.Fellesperiode:return S.UttakFellesperiodeAnnenForelder;case F.Mødrekvote:return S.UttakMødrekvoteAnnenForelder;case F.Foreldrepenger:return S.UttakForeldrepengerAnnenForelder;case F.ForeldrepengerFørFødsel:return S.ForeldrepengerFørFødsel;default:return}},ie=(e,r,t)=>{if(e)return e.toString();if(r)return t?(100-t).toString():"100"},Oe=e=>e?F.AktivitetsfriKvote:F.Foreldrepenger,Ue=(e,r,t,n)=>{if(e&&!r.flerbarnsdager&&!r.samtidigUttak&&D(r.periode.fom).isBefore(D(t).add(6,"weeks"),"day")&&n!==F.AktivitetsfriKvote&&r.morsAktivitet!==Te.Uføre)return!0},Le=(e,r,t)=>{var O;const n=e.gradering!==void 0&&e.resultat.innvilget,o=c(e.periode),d=r.søkerErFarEllerMedmor&&!r.morHarRett&&!r.farMedmorErAleneOmOmsorg&&!r.harAnnenForelderTilsvarendeRettEØS,l=t!==void 0?t.find(h=>(p(c(h.periode)).erLik(o)||p(c(h.periode)).overlapper(o))&&h.guid!==e.guid):void 0;let a;l&&(a=l.samtidigUttak);const i=ie(e.samtidigUttak,a,(O=e.gradering)==null?void 0:O.arbeidstidprosent),f=se(e),{termindato:E,fødselsdato:s,omsorgsovertakelsesdato:u}=r,k=te(E,s,u),m=d?Oe(e.resultat.trekkerMinsterett):e.kontoType;return{id:R(),type:A.Uttak,konto:m,tidsperiode:o,forelder:N(e,r.søkerErFarEllerMedmor),ønskerSamtidigUttak:e.samtidigUttak!==void 0,gradert:n,samtidigUttakProsent:i,ønskerFlerbarnsdager:r.antallBarn>1?e.flerbarnsdager:void 0,stillingsprosent:n?e.gradering.arbeidstidprosent.toString():void 0,arbeidsformer:n?[Ke(e.gradering.aktivitet.type)]:void 0,orgnumre:n&&e.gradering.aktivitet.arbeidsgiver!==void 0?[e.gradering.aktivitet.arbeidsgiver.id]:void 0,morsAktivitetIPerioden:e.morsAktivitet,erMorForSyk:Ue(r.søkerErFarEllerMedmor,e,k,m),angittAvAnnenPart:e.angittAvAnnenPart,opprinneligSøkt:f}},De=(e,r)=>({id:R(),type:A.Utsettelse,årsak:de(e.utsettelseÅrsak),tidsperiode:c(e.periode),forelder:N(e,r),erArbeidstaker:!1,morsAktivitetIPerioden:e.morsAktivitet}),se=e=>{if(e.resultat.årsak===y.AVSLAG_UTSETTELSE_TILBAKE_I_TID){if(e.utsettelseÅrsak===v.Ferie)return J.Ferie;if(e.utsettelseÅrsak===v.Arbeid)return J.Arbeid}if(e.resultat.årsak===y.INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID)return J.Gradering},Me=(e,r)=>{const t=se(e);return{id:R(),type:A.Info,infotype:K.avslåttPeriode,tidsperiode:c(e.periode),avslåttPeriodeType:e.utsettelseÅrsak!==void 0?A.Utsettelse:A.Uttak,kontoType:e.kontoType,forelder:N(e,r),overskrives:!0,visPeriodeIPlan:!0,kanSlettes:e.resultat.årsak!==y.AVSLAG_FRATREKK_PLEIEPENGER,opprinneligSøkt:t}},he=(e,r,t,n)=>{var E;const o=c(e.periode);if(e.utsettelseÅrsak!==void 0&&e.resultat.innvilget===!0)return{type:A.Info,infotype:K.utsettelseAnnenPart,id:R(),årsak:de(e.utsettelseÅrsak),tidsperiode:o,forelder:N(e,r),overskrives:!0,visPeriodeIPlan:!0};const d=n!==void 0&&!n.some(s=>(p(c(s.periode)).erLik(o)||p(c(s.periode)).overlapper(o))&&s.guid!==e.guid),l=Ne(e),a=n!==void 0?n.find(s=>(p(c(s.periode)).erLik(o)||p(c(s.periode)).overlapper(o))&&s.guid!==e.guid):void 0;let i;a&&(i=a.samtidigUttak);const f=ie(e.samtidigUttak,i,(E=e.gradering)==null?void 0:E.arbeidstidprosent);return X(e,t)?{type:A.Info,infotype:K.avslåttPeriode,id:R(),tidsperiode:o,forelder:N(e,r),overskrives:!0,visPeriodeIPlan:d,kontoType:e.kontoType,avslåttPeriodeType:A.Uttak,kanSlettes:!1}:{type:A.Info,infotype:K.uttakAnnenPart,id:R(),årsak:l,tidsperiode:o,forelder:N(e,r),overskrives:!0,gradert:e.gradering!==void 0,ønskerSamtidigUttak:f!==void 0,samtidigUttakProsent:f,stillingsprosent:e.gradering!==void 0?e.gradering.arbeidstidprosent.toString():void 0,visPeriodeIPlan:d}},Ge=(e,r)=>({id:R(),forelder:N(e,r),konto:e.kontoType,tidsperiode:c(e.periode),type:A.Overføring,årsak:e.overføringÅrsak}),ye=(e,r,t)=>{const n=t.filter(o=>!X(o,r.termindato));return e.gjelderAnnenPart?he(e,r.søkerErFarEllerMedmor,r.termindato,n):e.resultat.innvilget?e.utsettelseÅrsak!==void 0?De(e,r.søkerErFarEllerMedmor):e.overføringÅrsak!==void 0?Ge(e,r.søkerErFarEllerMedmor):Le(e,r,n):Me(e,r.søkerErFarEllerMedmor)},X=(e,r)=>r&&e.gjelderAnnenPart&&!e.resultat.innvilget&&e.resultat.trekkerDager&&D(e.periode.tom).isBefore(D(g(r)),"d")&&e.kontoType!==F.Fedrekvote,Ve=(e,r)=>e.resultat.innvilget?!0:e.gjelderAnnenPart?!!X(e,r):e.resultat.årsak!==y.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER&&e.resultat.trekkerDager===!0,je=(e,r,t)=>{const n=[];return e.forEach(o=>{C(o.tidsperiode,r)&&Se(o)?ke(o,r).forEach(l=>n.push(l)):t!==void 0&&C(o.tidsperiode,t)?Ae(o,t).forEach(l=>n.push(l)):n.push(o)}),n},ae=(e,r,t)=>{const n=e.filter(m=>Ve(m,r.termindato)),o=n.map(m=>ye(m,r,n)),d=new Date(r.familiehendelseDato),l=je(o,d,t),a=Pe([...l].sort(ne).filter(Z).map(_e).filter(ge).filter(Z),d,t),i=!r.morHarRett&&r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,f=r.familiehendelseType===P.ADOPSJON,E=a.filter(m=>!G(m)),s=a.filter(m=>G(m)),u=!r.erDeltUttak&&i&&!r.farMedmorErAleneOmOmsorg,k=Q(E,u,d,f,i,r.søkerErFarEllerMedmor,t);return Q(ve(k,s,d,t),u,d,f,i,r.søkerErFarEllerMedmor,t)},Ke=e=>{switch(e){case Y.SELVSTENDIG_NÆRINGSDRIVENDE:return w.selvstendignæringsdrivende;case Y.FRILANS:return w.frilans;default:return w.arbeidstaker}},$=e=>{switch(e){case _.UttakFedrekvoteAnnenForelder:return F.Fedrekvote;case _.UttakFellesperiodeAnnenForelder:return F.Fellesperiode;case _.UttakMødrekvoteAnnenForelder:return F.Mødrekvote;default:return}},He=e=>{switch(e){case _.UttakFedrekvoteAnnenForelder:return S.UttakFedrekvoteAnnenForelder;case _.UttakFellesperiodeAnnenForelder:return S.UttakFellesperiodeAnnenForelder;case _.UttakMødrekvoteAnnenForelder:return S.UttakMødrekvoteAnnenForelder;default:return}},le=(e,r)=>{const{oppholdÅrsak:t}=e,n={guid:R(),periode:{fom:e.fom,tom:e.tom},gjelderAnnenPart:r,resultat:e.resultat,kontoType:e.kontoType,flerbarnsdager:e.flerbarnsdager,gradering:e.gradering,utsettelseÅrsak:e.utsettelseÅrsak,overføringÅrsak:e.overføringÅrsak,samtidigUttak:e.samtidigUttak,morsAktivitet:e.morsAktivitet,oppholdÅrsak:He(e.oppholdÅrsak)};return t!==void 0&&r===!1&&(n.gjelderAnnenPart=!0,n.kontoType=$(t)),t!==void 0&&r&&(n.gjelderAnnenPart=!1,n.angittAvAnnenPart=!0,n.kontoType=$(t)),n},ee=e=>e.resultat.innvilget,fe=(e,r,t)=>{const n=t.filter(d=>e.guid!==d.guid&&p(c(e.periode)).erLik(c(d.periode)));if(n.length===0)return!0;const o=n.filter(ee);return!(ee(e)===!1&&o.length>0)},sr=e=>{if(!(e===void 0||e===""||Object.keys(e).length===0||e.perioder.length===0))return g(e.perioder[0].fom)},ar=(e,r,t,n,o)=>{if(e==null)return;const d=!0,l=e.perioder.map(u=>le(u,d)).filter(fe);let a;e.termindato!==void 0?a=e.termindato:(W(r)||Re(r))&&r.termindato!==void 0&&(a=b(r.termindato));const i=W(r)?b(r.fødselsdatoer[0]):void 0,f=pe(r)?b(r.adopsjonsdato):void 0,E={dekningsgrad:e.dekningsgrad===q.HUNDRE_PROSENT?H.HUNDRE_PROSENT:H.ÅTTI_PROSENT,antallBarn:e.antallBarn?e.antallBarn:r.antallBarn,morErAleneOmOmsorg:!1,morErUfør:!1,morHarRett:!0,farMedmorErAleneOmOmsorg:!1,farMedmorHarRett:!0,søkerErFarEllerMedmor:t,termindato:a,fødselsdato:i,omsorgsovertakelsesdato:f,erDeltUttak:!0,erBarnetFødt:i!==void 0,familiehendelseDato:n,familiehendelseType:oe(i,a,f),harAnnenForelderTilsvarendeRettEØS:!1,ønskerJustertUttakVedFødsel:void 0,barn:[]},s=ae(l,E,o);return{saksnummer:"",erAnnenPartsSak:d,grunnlag:E,saksperioder:l,uttaksplan:s.filter(u=>G(u))}},be=(e,r)=>{if(e==null)return;const t=!1,{dekningsgrad:n,familiehendelse:{fødselsdato:o,termindato:d,omsorgsovertakelse:l,antallBarn:a},harAnnenForelderTilsvarendeRettEØS:i,morUføretrygd:f,rettighetType:E,sakTilhørerMor:s,ønskerJustertUttakVedFødsel:u}=e,k=e.gjeldendeVedtak?e.gjeldendeVedtak.perioder:[],m=!s,M={dekningsgrad:n===q.HUNDRE_PROSENT?H.HUNDRE_PROSENT:H.ÅTTI_PROSENT,antallBarn:a,morErAleneOmOmsorg:s&&E===U.ALENEOMSORG,morErUfør:f,morHarRett:s||E===U.BEGGE_RETT,farMedmorErAleneOmOmsorg:!s&&E===U.ALENEOMSORG,farMedmorHarRett:!s||E===U.BEGGE_RETT,søkerErFarEllerMedmor:m,termindato:d,fødselsdato:o,omsorgsovertakelsesdato:l,erDeltUttak:E===U.BEGGE_RETT,erBarnetFødt:o!==void 0,familiehendelseDato:te(d,o,l),familiehendelseType:oe(o,d,l),ønskerJustertUttakVedFødsel:o===void 0?u:void 0,harAnnenForelderTilsvarendeRettEØS:i},O=k.map(ce=>le(ce,t)).filter(fe),h=ae(O,M,r);return{saksnummer:e.saksnummer,erAnnenPartsSak:t,grunnlag:M,saksperioder:O,uttaksplan:h}},Ee=e=>e===P.TERM||e===P.FØDSEL?"fødsel":"adopsjon",we=(e,r)=>({erAleneOmOmsorg:r?e.farMedmorErAleneOmOmsorg:e.morErAleneOmOmsorg}),Je=(e,r,t)=>{const{søkerErFarEllerMedmor:n}=t,o=e.kjønn==="K";switch(r){case"fødsel":case"adopsjon":return o?n?"medmor":"mor":"far";default:return}},re=(e,r)=>e&&e.fødselsdatoer?B(e.fødselsdatoer):r.fødselsdato?Array(r.antallBarn).fill(g(r.fødselsdato)):[],Be=(e,r,t)=>{switch(e){case"fødsel":return r.fødselsdato?{type:L.FØDT,antallBarn:r.antallBarn,fødselsdatoer:re(t,r),termindato:r.termindato?g(r.termindato):void 0,fnr:t==null?void 0:t.fnr}:{type:L.UFØDT,antallBarn:r.antallBarn,termindato:g(r.termindato),terminbekreftelse:[]};case"adopsjon":return{type:L.ADOPTERT_STEBARN,adopsjonsdato:g(r.omsorgsovertakelsesdato),antallBarn:r.antallBarn,fødselsdatoer:re(t,r),omsorgsovertakelse:[],fnr:t==null?void 0:t.fnr};default:return}},xe=(e,r,t,n,o)=>{switch(e){case"fødsel":case"adopsjon":return n?{fornavn:t.fornavn!==void 0&&t.fornavn!==""?t.fornavn:I(o,"annen.forelder"),etternavn:t.etternavn,erUfør:r.morErUfør,harRettPåForeldrepengerINorge:!!r.morHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS}:{fornavn:t.fornavn!==void 0&&t.fornavn!==""?t.fornavn:I(o,"annen.forelder"),etternavn:t.etternavn,harRettPåForeldrepengerINorge:!!r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS};default:return}},Ye=(e,r,t,n,o,d,l)=>{var E;if(d===void 0&&r===void 0||!l)return;const a=d!==void 0?e.find(s=>d.includes(s.fnr)&&s.annenForelder!==void 0):void 0,i=r!==void 0?e.find(s=>Ie(s.fødselsdato,r)&&s.annenForelder!==void 0):void 0,f=a||i;if(f!==void 0&&((E=f.annenForelder)==null?void 0:E.fnr)===l){const s=f.annenForelder,{fornavn:u}=s,k=u!==void 0&&u.trim()!==""?u:I(o,"annen.forelder"),m={...s,fornavn:k};return xe(n,t,m,t.søkerErFarEllerMedmor,o)}},me=e=>e.fødselsdatoer!==void 0&&e.fødselsdatoer.length>0?{type:L.FØDT,antallBarn:e.antallBarn,fødselsdatoer:B(e.fødselsdatoer),fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0}:e.termindato!==void 0?{type:L.UFØDT,antallBarn:e.antallBarn,termindato:e.termindato}:{type:L.IKKE_UTFYLT,antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer?B(e.fødselsdatoer):[],fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0},qe=e=>e.annenForelder!==void 0?{fornavn:e.annenForelder.fornavn,etternavn:e.annenForelder.etternavn,fnr:e.annenForelder.fnr,kanIkkeOppgis:!1}:{kanIkkeOppgis:!1},lr=e=>{const r=me(e),t=qe(e);return{barn:r,annenForelder:t,erEndringssøknad:!1}},ue=(e,r,t,n,o,d)=>{const l=r!==void 0?r.fnr:void 0,a={fornavn:I(e,"annen.forelder"),etternavn:"",fnr:l||"",harRettPåForeldrepengerINorge:t.søkerErFarEllerMedmor?!!t.morHarRett&&!t.harAnnenForelderTilsvarendeRettEØS:!!t.farMedmorHarRett&&!t.harAnnenForelderTilsvarendeRettEØS,harRettPåForeldrepengerIEØS:t.harAnnenForelderTilsvarendeRettEØS,kanIkkeOppgis:!1,erUfør:t.søkerErFarEllerMedmor?t.morErUfør:void 0};return Ye(n,g(t.fødselsdato),t,o,e,d,l)||a},fr=(e,r,t)=>{var f;const n=be(e.sak,void 0),{grunnlag:o}=n,d=Ee(o.familiehendelseType),l=me(e),a=ue(r,(f=e.sak)==null?void 0:f.annenPart,o,t,d,e.fnr),i={barn:l,annenForelder:a,erEndringssøknad:!1};if(e.sak!==void 0){const E={situasjon:e.sak.gjelderAdopsjon?"adopsjon":"fødsel",rolle:e.sak.sakTilhørerMor?void 0:"far"};i.søkersituasjon=E}return i},Er=(e,r,t,n,o)=>{const{grunnlag:d,uttaksplan:l}=r,{dekningsgrad:a,familiehendelseType:i,søkerErFarEllerMedmor:f,ønskerJustertUttakVedFødsel:E}=d,s=Ee(i);if(!s)return;const u=we(d,f),k=Be(s,d,o),m=Je(e,s,d);if(!k||!m)return;const M=ue(t,n,d,e.barn,s,o==null?void 0:o.fnr);return{søker:u,søkersituasjon:{situasjon:s,rolle:m},barn:k,annenForelder:M,erEndringssøknad:!0,dekningsgrad:a,uttaksplan:l,saksnummer:r.saksnummer,ønskerJustertUttakVedFødsel:E}};export{q as D,U as R,fr as a,lr as b,ar as c,ir as d,sr as g,be as m,Er as o};
