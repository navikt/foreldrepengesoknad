import{w as ue,d as D,aO as B,U as _,I as O,O as X,aq as c,x as P,g as S,a7 as y,X as H,j as G}from"./Tidsperioden-f06b1fb0.js";import"./jsx-runtime-69eee039.js";import"./index-e13aeee6.js";import"./index-7c191284.js";import"./_baseToString-4b695375.js";import"./_createSet-f4a01039.js";import{g as ee,s as b}from"./dateUtils-d252c747.js";import{f as z,s as ce,a as ve,b as Fe,A as K}from"./leggTilPeriode-6d2e14ee.js";import{q as C,r as ke,s as Ae,B as h}from"./barnUtils-6ca83891.js";import{s as re,D as V}from"./Periodene-0a8f4fdf.js";import{O as R,M as pe}from"./uttaksPlanStatus-eb75c060.js";import{a as L,h as w,S as v,b as Re,P as k,o as j,U as p}from"./Perioden-258f0205.js";import{e as Se}from"./velkommenUtils-c9ac41d3.js";var x=(e=>(e.ÅTTI_PROSENT="ÅTTI",e.HUNDRE_PROSENT="HUNDRE",e))(x||{}),I=(e=>(e.ADOPSJON="ADPSJN",e.OMSORGSOVERTAKELSE="OMSRGO",e.FØDSEL="FODSL",e.TERM="TERM",e))(I||{}),N=(e=>(e.UttakFellesperiodeAnnenForelder="FELLESPERIODE_ANNEN_FORELDER",e.UttakFedrekvoteAnnenForelder="FEDREKVOTE_ANNEN_FORELDER",e.UttakMødrekvoteAnnenForelder="MØDREKVOTE_ANNEN_FORELDER",e.UttakForeldrepengerAnnenForelder="FORELDREPENGER_ANNEN_FORELDER",e.Ingen="INGEN",e))(N||{}),q=(e=>(e.AVSLAG_FRATREKK_PLEIEPENGER="AVSLAG_FRATREKK_PLEIEPENGER",e.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER="AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER",e.ANNET="ANNET",e))(q||{}),A=(e=>(e.Ferie="LOVBESTEMT_FERIE",e.Arbeid="ARBEID",e.Sykdom="SØKER_SYKDOM",e.InstitusjonSøker="SØKER_INNLAGT",e.InstitusjonBarnet="BARN_INNLAGT",e.HvØvelse="HV_ØVELSE",e.NavTiltak="NAV_TILTAK",e.Fri="FRI",e))(A||{}),J=(e=>(e.ORDINÆRT_ARBEID="ORDINÆRT_ARBEID",e.SELVSTENDIG_NÆRINGSDRIVENDE="SELVSTENDIG_NÆRINGSDRIVENDE",e.FRILANS="FRILANS",e.ANNET="ANNET",e))(J||{}),M=(e=>(e.BARE_SØKER_RETT="BARE_SØKER_RETT",e.ALENEOMSORG="ALENEOMSORG",e.BEGGE_RETT="BEGGE_RETT",e))(M||{});const te=(e,r,t)=>{if(t!==void 0)return I.ADOPSJON;if(e!==void 0)return I.FØDSEL;if(r!==void 0)return I.TERM;throw new Error("Fødselsdato/ termindato/ omsorgsovertakelsedato mangler")},Q=e=>w(e).getAntallUttaksdager()>0,ge=e=>ue(e.tidsperiode),Te=(e,r,t)=>{if(e.length<=1)return e;const o=[],n=e.filter(s=>L(s)),l=[...e.filter(s=>!L(s)),...n];let a={...l[0]};return l.forEach((s,f)=>{if(f!==0){if(a===void 0){a=s;return}if(w(a).erLik(s,!1,!0)&&w(a).erSammenhengende(s)&&!D(s.tidsperiode.fom).isSame(r,"day")&&!(t!==void 0&&D(s.tidsperiode.fom).isSame(t,"day"))){a.tidsperiode.tom=s.tidsperiode.tom;return}else o.push(a);a=s}}),o.push(a),o.sort(re)},Pe=e=>{const{fom:r,tom:t}=e.tidsperiode,o=B(r),n=B(t);return o&&n?e:!o&&!n?{...e,tidsperiode:{fom:_(r).neste(),tom:_(t).forrige()}}:!o&&n?{...e,tidsperiode:{fom:_(r).neste(),tom:t}}:{...e,tidsperiode:{fom:r,tom:_(t).forrige()}}},U=(e,r)=>e.gjelderAnnenPart?r?y.mor:y.farMedmor:r?y.farMedmor:y.mor,oe=e=>{switch(e){case A.Arbeid:return p.Arbeid;case A.Ferie:return p.Ferie;case A.InstitusjonBarnet:return p.InstitusjonBarnet;case A.InstitusjonSøker:return p.InstitusjonSøker;case A.Sykdom:return p.Sykdom;case A.HvØvelse:return p.HvØvelse;case A.NavTiltak:return p.NavTiltak;case A.Fri:return p.Fri;default:return}},Oe=e=>{switch(e.kontoType){case v.Fedrekvote:return R.UttakFedrekvoteAnnenForelder;case v.Fellesperiode:return R.UttakFellesperiodeAnnenForelder;case v.Mødrekvote:return R.UttakMødrekvoteAnnenForelder;case v.Foreldrepenger:return R.UttakForeldrepengerAnnenForelder;case v.ForeldrepengerFørFødsel:return R.ForeldrepengerFørFødsel;default:return}},ne=(e,r,t)=>{if(e)return e.toString();if(r)return t?(100-t).toString():"100"},Ie=e=>e?v.AktivitetsfriKvote:v.Foreldrepenger,Ne=(e,r,t,o)=>{if(e&&!r.flerbarnsdager&&!r.samtidigUttak&&D(r.periode.fom).isBefore(D(t).add(6,"weeks"),"day")&&o!==v.AktivitetsfriKvote&&r.morsAktivitet!==pe.Uføre)return!0},Ue=(e,r,t)=>{var g;const o=e.gradering!==void 0&&e.resultat.innvilget,n=c(e.periode),d=r.søkerErFarEllerMedmor&&!r.morHarRett&&!r.farMedmorErAleneOmOmsorg&&!r.harAnnenForelderTilsvarendeRettEØS,l=t!==void 0?t.find(T=>(P(c(T.periode)).erLik(n)||P(c(T.periode)).overlapper(n))&&T.guid!==e.guid):void 0;let a;l&&(a=l.samtidigUttak);const s=ne(e.samtidigUttak,a,(g=e.gradering)==null?void 0:g.arbeidstidprosent),{termindato:f,fødselsdato:m,omsorgsovertakelsesdato:i}=r,E=ee(f,m,i),F=d?Ie(e.resultat.trekkerMinsterett):e.kontoType;return{id:S(),type:k.Uttak,konto:F,tidsperiode:n,forelder:U(e,r.søkerErFarEllerMedmor),ønskerSamtidigUttak:e.samtidigUttak!==void 0,gradert:o,samtidigUttakProsent:s,ønskerFlerbarnsdager:r.antallBarn>1?e.flerbarnsdager:void 0,stillingsprosent:o?e.gradering.arbeidstidprosent.toString():void 0,arbeidsformer:o?[Ge(e.gradering.aktivitet.type)]:void 0,orgnumre:o&&e.gradering.aktivitet.arbeidsgiver!==void 0?[e.gradering.aktivitet.arbeidsgiver.id]:void 0,morsAktivitetIPerioden:e.morsAktivitet,erMorForSyk:Ne(r.søkerErFarEllerMedmor,e,E,F),angittAvAnnenPart:e.angittAvAnnenPart}},Me=(e,r)=>({id:S(),type:k.Utsettelse,årsak:oe(e.utsettelseÅrsak),tidsperiode:c(e.periode),forelder:U(e,r),erArbeidstaker:!1,morsAktivitetIPerioden:e.morsAktivitet}),he=(e,r)=>({id:S(),type:k.Info,infotype:j.avslåttPeriode,tidsperiode:c(e.periode),avslåttPeriodeType:e.utsettelseÅrsak!==void 0?k.Utsettelse:k.Uttak,kontoType:e.kontoType,forelder:U(e,r),overskrives:!0,visPeriodeIPlan:!0,kanSlettes:e.resultat.årsak!==q.AVSLAG_FRATREKK_PLEIEPENGER}),De=(e,r,t,o)=>{var m;const n=c(e.periode);if(e.utsettelseÅrsak!==void 0&&e.resultat.innvilget===!0)return{type:k.Info,infotype:j.utsettelseAnnenPart,id:S(),årsak:oe(e.utsettelseÅrsak),tidsperiode:n,forelder:U(e,r),overskrives:!0,visPeriodeIPlan:!0};const d=o!==void 0&&!o.some(i=>(P(c(i.periode)).erLik(n)||P(c(i.periode)).overlapper(n))&&i.guid!==e.guid),l=Oe(e),a=o!==void 0?o.find(i=>(P(c(i.periode)).erLik(n)||P(c(i.periode)).overlapper(n))&&i.guid!==e.guid):void 0;let s;a&&(s=a.samtidigUttak);const f=ne(e.samtidigUttak,s,(m=e.gradering)==null?void 0:m.arbeidstidprosent);return Y(e,t)?{type:k.Info,infotype:j.avslåttPeriode,id:S(),tidsperiode:n,forelder:U(e,r),overskrives:!0,visPeriodeIPlan:d,kontoType:e.kontoType,avslåttPeriodeType:k.Uttak,kanSlettes:!1}:{type:k.Info,infotype:j.uttakAnnenPart,id:S(),årsak:l,tidsperiode:n,forelder:U(e,r),overskrives:!0,gradert:e.gradering!==void 0,ønskerSamtidigUttak:f!==void 0,samtidigUttakProsent:f,stillingsprosent:e.gradering!==void 0?e.gradering.arbeidstidprosent.toString():void 0,visPeriodeIPlan:d}},Le=(e,r)=>({id:S(),forelder:U(e,r),konto:e.kontoType,tidsperiode:c(e.periode),type:k.Overføring,årsak:e.overføringÅrsak}),_e=(e,r,t)=>{const o=t.filter(n=>!Y(n,r.termindato));return e.gjelderAnnenPart?De(e,r.søkerErFarEllerMedmor,r.termindato,o):e.resultat.innvilget?e.utsettelseÅrsak!==void 0?Me(e,r.søkerErFarEllerMedmor):e.overføringÅrsak!==void 0?Le(e,r.søkerErFarEllerMedmor):Ue(e,r,o):he(e,r.søkerErFarEllerMedmor)},Y=(e,r)=>r&&e.gjelderAnnenPart&&!e.resultat.innvilget&&e.resultat.trekkerDager&&D(e.periode.tom).isBefore(D(O(r)),"d")&&e.kontoType!==v.Fedrekvote,ye=(e,r)=>e.resultat.innvilget?!0:e.gjelderAnnenPart?!!Y(e,r):e.resultat.årsak!==q.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER&&e.resultat.trekkerDager===!0,je=(e,r,t)=>{const o=[];return e.forEach(n=>{X(n.tidsperiode,r)&&Re(n)?ve(n,r).forEach(l=>o.push(l)):t!==void 0&&X(n.tidsperiode,t)?Fe(n,t).forEach(l=>o.push(l)):o.push(n)}),o},de=(e,r,t)=>{const o=e.filter(u=>ye(u,r.termindato)),n=o.map(u=>_e(u,r,o)),d=new Date(r.familiehendelseDato),l=je(n,d,t),a=Te([...l].sort(re).filter(Q).map(Pe).filter(ge).filter(Q),d,t),s=!r.morHarRett&&r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,f=r.familiehendelseType===I.ADOPSJON,m=a.filter(u=>!L(u)),i=a.filter(u=>L(u)),E=!r.erDeltUttak&&s&&!r.farMedmorErAleneOmOmsorg,F=z(m,E,d,f,s,r.søkerErFarEllerMedmor,t);return z(ce(F,i,d,t),E,d,f,s,r.søkerErFarEllerMedmor,t)},Ge=e=>{switch(e){case J.SELVSTENDIG_NÆRINGSDRIVENDE:return K.selvstendignæringsdrivende;case J.FRILANS:return K.frilans;default:return K.arbeidstaker}},W=e=>{switch(e){case N.UttakFedrekvoteAnnenForelder:return v.Fedrekvote;case N.UttakFellesperiodeAnnenForelder:return v.Fellesperiode;case N.UttakMødrekvoteAnnenForelder:return v.Mødrekvote;default:return}},Ve=e=>{switch(e){case N.UttakFedrekvoteAnnenForelder:return R.UttakFedrekvoteAnnenForelder;case N.UttakFellesperiodeAnnenForelder:return R.UttakFellesperiodeAnnenForelder;case N.UttakMødrekvoteAnnenForelder:return R.UttakMødrekvoteAnnenForelder;default:return}},se=(e,r)=>{const{oppholdÅrsak:t}=e,o={guid:S(),periode:{fom:e.fom,tom:e.tom},gjelderAnnenPart:r,resultat:e.resultat,kontoType:e.kontoType,flerbarnsdager:e.flerbarnsdager,gradering:e.gradering,utsettelseÅrsak:e.utsettelseÅrsak,overføringÅrsak:e.overføringÅrsak,samtidigUttak:e.samtidigUttak,morsAktivitet:e.morsAktivitet,oppholdÅrsak:Ve(e.oppholdÅrsak)};return t!==void 0&&r===!1&&(o.gjelderAnnenPart=!0,o.kontoType=W(t)),t!==void 0&&r&&(o.gjelderAnnenPart=!1,o.angittAvAnnenPart=!0,o.kontoType=W(t)),o},Z=e=>e.resultat.innvilget,ie=(e,r,t)=>{const o=t.filter(d=>e.guid!==d.guid&&P(c(e.periode)).erLik(c(d.periode)));if(o.length===0)return!0;const n=o.filter(Z);return!(Z(e)===!1&&n.length>0)},nr=e=>{if(!(e===void 0||e===""||Object.keys(e).length===0||e.perioder.length===0))return O(e.perioder[0].fom)},dr=(e,r,t,o,n)=>{if(e===void 0||e===""||Object.keys(e).length===0)return;const d=!0,l=e.perioder.map(E=>se(E,d)).filter(ie);let a;e.termindato!==void 0?a=e.termindato:(C(r)||ke(r))&&r.termindato!==void 0&&(a=H(r.termindato));const s=C(r)?H(r.fødselsdatoer[0]):void 0,f=Ae(r)?H(r.adopsjonsdato):void 0,m={dekningsgrad:e.dekningsgrad===x.HUNDRE_PROSENT?V.HUNDRE_PROSENT:V.ÅTTI_PROSENT,antallBarn:e.antallBarn?e.antallBarn:r.antallBarn,morErAleneOmOmsorg:!1,morErUfør:!1,morHarRett:!0,farMedmorErAleneOmOmsorg:!1,farMedmorHarRett:!0,søkerErFarEllerMedmor:t,termindato:a,fødselsdato:s,omsorgsovertakelsesdato:f,erDeltUttak:!0,erBarnetFødt:s!==void 0,familiehendelseDato:o,familiehendelseType:te(s,a,f),harAnnenForelderTilsvarendeRettEØS:!1,ønskerJustertUttakVedFødsel:void 0,barn:[]},i=de(l,m,n);return{saksnummer:"",erAnnenPartsSak:d,grunnlag:m,saksperioder:l,uttaksplan:i.filter(E=>L(E))}},He=(e,r)=>{if(e===void 0||e===""||Object.keys(e).length===0)return;const t=!1,{dekningsgrad:o,familiehendelse:{fødselsdato:n,termindato:d,omsorgsovertakelse:l,antallBarn:a},harAnnenForelderTilsvarendeRettEØS:s,morUføretrygd:f,rettighetType:m,sakTilhørerMor:i,ønskerJustertUttakVedFødsel:E}=e,F=e.gjeldendeVedtak?e.gjeldendeVedtak.perioder:[],u=!i,g={dekningsgrad:o===x.HUNDRE_PROSENT?V.HUNDRE_PROSENT:V.ÅTTI_PROSENT,antallBarn:a,morErAleneOmOmsorg:i&&m===M.ALENEOMSORG,morErUfør:f,morHarRett:i||m===M.BEGGE_RETT,farMedmorErAleneOmOmsorg:!i&&m===M.ALENEOMSORG,farMedmorHarRett:!i||m===M.BEGGE_RETT,søkerErFarEllerMedmor:u,termindato:d,fødselsdato:n,omsorgsovertakelsesdato:l,erDeltUttak:m===M.BEGGE_RETT,erBarnetFødt:n!==void 0,familiehendelseDato:ee(d,n,l),familiehendelseType:te(n,d,l),ønskerJustertUttakVedFødsel:n===void 0?E:void 0,harAnnenForelderTilsvarendeRettEØS:s},T=F.map(Ee=>se(Ee,t)).filter(ie),me=de(T,g,r);return{saksnummer:e.saksnummer,erAnnenPartsSak:t,grunnlag:g,saksperioder:T,uttaksplan:me}},ae=e=>e===I.TERM||e===I.FØDSEL?"fødsel":"adopsjon",Ke=(e,r)=>({erAleneOmOmsorg:r?e.farMedmorErAleneOmOmsorg:e.morErAleneOmOmsorg}),be=(e,r,t)=>{const{søkerErFarEllerMedmor:o}=t,n=e.kjønn==="K";switch(r){case"fødsel":case"adopsjon":return n?o?"medmor":"mor":"far";default:return}},$=(e,r)=>e&&e.fødselsdatoer?b(e.fødselsdatoer):r.fødselsdato?Array(r.antallBarn).fill(O(r.fødselsdato)):[],we=(e,r,t)=>{switch(e){case"fødsel":return r.fødselsdato?{type:h.FØDT,antallBarn:r.antallBarn,fødselsdatoer:$(t,r),termindato:r.termindato?O(r.termindato):void 0,fnr:t==null?void 0:t.fnr}:{type:h.UFØDT,antallBarn:r.antallBarn,termindato:O(r.termindato),terminbekreftelse:[]};case"adopsjon":return{type:h.ADOPTERT_STEBARN,adopsjonsdato:O(r.omsorgsovertakelsesdato),antallBarn:r.antallBarn,fødselsdatoer:$(t,r),omsorgsovertakelse:[],fnr:t==null?void 0:t.fnr};default:return}},Je=(e,r,t,o,n)=>{switch(e){case"fødsel":case"adopsjon":return o?{fornavn:t.fornavn!==void 0&&t.fornavn!==""?t.fornavn:G(n,"annen.forelder"),etternavn:t.etternavn,erUfør:r.morErUfør,harRettPåForeldrepengerINorge:!!r.morHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS}:{fornavn:t.fornavn!==void 0&&t.fornavn!==""?t.fornavn:G(n,"annen.forelder"),etternavn:t.etternavn,harRettPåForeldrepengerINorge:!!r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS};default:return}},xe=(e,r,t,o,n,d,l)=>{var m;if(d===void 0&&r===void 0||!l)return;const a=d!==void 0?e.find(i=>d.includes(i.fnr)&&i.annenForelder!==void 0):void 0,s=r!==void 0?e.find(i=>Se(i.fødselsdato,r)&&i.annenForelder!==void 0):void 0,f=a||s;if(f!==void 0&&((m=f.annenForelder)==null?void 0:m.fnr)===l){const i=f.annenForelder,{fornavn:E}=i,F=E!==void 0&&E.trim()!==""?E:G(n,"annen.forelder"),u={...i,fornavn:F};return Je(o,t,u,t.søkerErFarEllerMedmor,n)}},le=e=>e.fødselsdatoer!==void 0&&e.fødselsdatoer.length>0?{type:h.FØDT,antallBarn:e.antallBarn,fødselsdatoer:b(e.fødselsdatoer),fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0}:e.termindato!==void 0?{type:h.UFØDT,antallBarn:e.antallBarn,termindato:e.termindato}:{type:h.IKKE_UTFYLT,antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer?b(e.fødselsdatoer):[],fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0},qe=e=>e.annenForelder!==void 0?{fornavn:e.annenForelder.fornavn,etternavn:e.annenForelder.etternavn,fnr:e.annenForelder.fnr,kanIkkeOppgis:!1}:{kanIkkeOppgis:!1},sr=e=>{const r=le(e),t=qe(e);return{barn:r,annenForelder:t,erEndringssøknad:!1}},fe=(e,r,t,o,n,d)=>{const l=r!==void 0?r.fnr:void 0,a={fornavn:G(e,"annen.forelder"),etternavn:"",fnr:l||"",harRettPåForeldrepengerINorge:t.søkerErFarEllerMedmor?!!t.morHarRett&&!t.harAnnenForelderTilsvarendeRettEØS:!!t.farMedmorHarRett&&!t.harAnnenForelderTilsvarendeRettEØS,harRettPåForeldrepengerIEØS:t.harAnnenForelderTilsvarendeRettEØS,kanIkkeOppgis:!1,erUfør:t.søkerErFarEllerMedmor?t.morErUfør:void 0};return xe(o.registrerteBarn,O(t.fødselsdato),t,n,e,d,l)||a},ir=(e,r,t)=>{var f;const o=He(e.sak,void 0),{grunnlag:n}=o,d=ae(n.familiehendelseType),l=le(e),a=fe(r,(f=e.sak)==null?void 0:f.annenPart,n,t,d,e.fnr),s={barn:l,annenForelder:a,erEndringssøknad:!1};if(e.sak!==void 0){const m={situasjon:e.sak.gjelderAdopsjon?"adopsjon":"fødsel",rolle:e.sak.sakTilhørerMor?void 0:"far"};s.søkersituasjon=m}return s},ar=(e,r,t,o,n)=>{const{grunnlag:d,uttaksplan:l}=r,{dekningsgrad:a,familiehendelseType:s,søkerErFarEllerMedmor:f,ønskerJustertUttakVedFødsel:m}=d,i=ae(s);if(!i)return;const E=Ke(d,f),F=we(i,d,n),u=be(e.person,i,d);if(!F||!u)return;const g=fe(t,o,d,e,i,n==null?void 0:n.fnr);return{søker:E,søkersituasjon:{situasjon:i,rolle:u},barn:F,annenForelder:g,erEndringssøknad:!0,dekningsgrad:a,uttaksplan:l,saksnummer:r.saksnummer,ønskerJustertUttakVedFødsel:m}};export{x as D,M as R,ir as a,sr as b,dr as c,nr as g,He as m,ar as o};
//# sourceMappingURL=eksisterendeSakUtils-ae52dae6.js.map
