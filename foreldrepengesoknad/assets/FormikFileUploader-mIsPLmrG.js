import{j as s}from"./jsx-runtime-Cw0GR0a5.js";import{d as I,B as d,e as V}from"./Tidsperioden-Cw9xAJ1Y.js";import{r as B}from"./index-CTjT7uj6.js";import{u as _}from"./index-DSgjoNiG.js";import"./index-CCQ3W5xA.js";import{d as k}from"./globalUtil-COyT2LIB.js";import"./Uttaksdagen-CXktmUXL.js";import{i as L,m as M}from"./vedleggUtils-bEzzXB5v.js";import"./_baseToString-Cq6MbKF_.js";import"./_createSet-D2BJ0WVx.js";import{a as T}from"./ByttBrowserModal-50UgTbct.js";import{g as w}from"./apiInterceptor-D-WKbiXB.js";import{A as D}from"./AttachmentList-VpRNJMhh.js";import{B as N}from"./Label-C_UMiHsP.js";function R(e){const t={withCredentials:!0,timeout:45e3,headers:{"content-type":"multipart/form-data"}},r=new FormData;return r.append("id",e.id),r.append("vedlegg",e.file,e.filename),w().post("/rest/storage/foreldrepenger/vedlegg",r,t)}const C={saveAttachment:R},F=[".pdf",".jpeg",".jpg",".png"],h=16,b=h*1024*1024,z=(e,t,r)=>e.map(i=>{const n=M(i,t,r);return n.pending=!0,n}),G=e=>{const t=e.split(".").pop();return F.includes(`.${t.toLowerCase()}`)},U=e=>e<=b,X=(e,t,r)=>e.filter(i=>{const n=G(i.filename);n||t(o=>o.concat(r.formatMessage({id:"vedlegg.feilmelding.ugyldig.type"},{filename:i.filename})));const a=U(i.filesize);return a||t(o=>o.concat(r.formatMessage({id:"vedlegg.feilmelding.ugyldig.størrelse"},{filename:i.filename,maxStørrelse:h}))),n&&a}),O=(e,t,r,i,n,a)=>{e.forEach(async(o,c)=>{try{const m=await C.saveAttachment(o);o.pending=!1,o.url=m.headers.location,o.uploaded=!0,o.uuid=m.data,t(n+c,o)}catch{r(n+c),i(p=>p.concat(a.formatMessage({id:"vedlegg.feilmelding.opplasting.feilet"},{filename:o.filename})))}})},x=({attachments:e,name:t,onFileInputClick:r,attachmentType:i,skjemanummer:n,label:a,legend:o,...c})=>{const m=_(),{setFieldValue:p}=I(),[f,g]=B.useState([]);return s.jsxs(s.Fragment,{children:[s.jsx(d,{padBottom:"xl",children:s.jsx(V,{legend:o,buttonLabel:a,name:t,accept:F.join(", "),onFilesSelect:(l,{push:y,replace:j,remove:S})=>{const A=z(l,i,n),u=X(A,g,m);u.forEach(E=>y(E)),O(u,j,S,g,e.length,m)},onClick:r,error:f.length>0?f.map(l=>s.jsx(N,{children:l},l)):void 0,...c})}),s.jsx(d,{padBottom:"xl",visible:e.length>0,children:s.jsx(D,{attachments:e.filter(l=>!L(l)),showFileSize:!0,onDelete:l=>{p(t,k(e,l))}})}),s.jsx(d,{padBottom:"l",children:s.jsx(T,{})})]})},re=x;x.__docgenInfo={description:"",methods:[],displayName:"FormikFileUploader"};export{re as F};
