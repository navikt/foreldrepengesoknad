import{U as p,d as a,T as k,W as h,Q as N,g as D,j as G,X as x}from"./Tidsperioden-1f4512e5.js";import"./jsx-runtime-1caa8f64.js";import{b as E,f as y,j as z,e as B,l as C,h as R,P as j,S as F,c as Y,i as Z,m as V}from"./Perioden-ca2a3b5d.js";import"./index-753920cd.js";import"./index-1cdf6ce0.js";import{P as T,s as H}from"./Periodene-56b794dc.js";import"./_baseToString-2517c4f7.js";import"./_createSet-019d3bf6.js";var $=(e=>(e.arbeidstaker="ARBEIDSTAKER",e.frilans="FRILANS",e.selvstendignæringsdrivende="SELVSTENDIG_NÆRINGSDRIVENDE",e))($||{}),M=(e=>(e.Arbeid="ARBEID",e.Utdanning="UTDANNING",e.Kvalifiseringsprogrammet="KVALPROG",e.Introduksjonsprogrammet="INTROPROG",e.TrengerHjelp="TRENGER_HJELP",e.Innlagt="INNLAGT",e.ArbeidOgUtdanning="ARBEID_OG_UTDANNING",e.Uføre="UFØRE",e.IkkeOppgitt="IKKE_OPPGITT",e))(M||{}),J=(e=>(e.fridag="fridag",e.avslåttPeriode="avslåttPeriode",e))(J||{});const b=(e,t,o,i)=>{if(e.length<=1)return e;const d=[];let r={...e[0]};return e.forEach((s,c)=>{if(c!==0){if(r===void 0){r=s;return}if(R(r).erLik(s,!1,!0)&&R(r).erSammenhengende(s)){if(i&&E(s)&&s.ønskerSamtidigUttak&&E(r)&&r.ønskerSamtidigUttak){const l=T(i).finnOverlappendePerioder(r),g=T(i).finnOverlappendePerioder(s);if(g.length===0&&l.length>0||g.length>0&&l.length===0){d.push(r),r=s;return}}if(a(r.tidsperiode.tom).isBefore(t,"day")&&a(s.tidsperiode.tom).isSameOrAfter(p(t).denneEllerNeste())||o!==void 0&&a(r.tidsperiode.tom).isBefore(o,"day")&&a(s.tidsperiode.fom).isSameOrAfter(p(o).denneEllerNeste(),"day")){d.push(r),r=s;return}const n={fom:r.tidsperiode.fom,tom:s.tidsperiode.tom};r.tidsperiode={...n};return}else d.push(r);r=s}}),d.push(r),d},v=(e,t)=>t!==void 0&&x(e.tidsperiode,t)?te(e,t):[e],O=(e,t,o,i,d,r,s,c=J.fridag)=>{if(h(o)){const g=p(o).denneEllerNeste(),m=p(g).leggTil(30),f=k(e).erInnenforFørsteSeksUker(o),u=a(e.fom).isBefore(m,"day")&&!i&&(d&&h(o)||r&&N(o));if(t&&!u)return v(I(e,c),s);if(a(e.fom).isBefore(o,"day"))return v(S(e),s);if(f&&!i){if(a(e.tom).isBefore(m,"day"))return d&&h(o)||r&&N(o)?[S(e)]:[I(e,c)];const P=k({fom:e.fom,tom:m}).getAntallUttaksdager()-2,U=k(e).getAntallUttaksdager()-P,A={fom:e.fom,tom:p(m).leggTil(-1)},L={fom:m,tom:p(m).leggTil(U-2)};if(d&&h(o)||r&&N(o)){if(r&&!d)return[S(e)];const q=S(A),w=I(L,c);return[q,w]}const Q=I(A,c),X=S(L);return[Q,X]}return v(S(e),s)}return v(I(e,c),s)},I=(e,t)=>({id:D(),type:j.Hull,tidsperiode:e,årsak:t}),S=e=>({id:D(),type:j.PeriodeUtenUttak,tidsperiode:e}),K=(e,t)=>{const o={fom:p(e.tom).neste(),tom:p(t.fom).forrige()},i=k(o).getAntallUttaksdager();if(G(o)&&i>0)return o},me=e=>e.reduce((t,o,i)=>i===0&&y(o)?t:i===e.length-1?(B(o)||y(o)||t.push(o),t):(t.push(o),t),[]),ge=(e,t,o,i,d,r,s)=>e.length===0?e:e.reduce((n,l,g)=>{if(g===0&&r){const P=p(o).denneEllerNeste();if(a(P).isBefore(l.tidsperiode.fom)){const U={fom:P,tom:p(l.tidsperiode.fom).forrige()};k(U).getAntallUttaksdager()>0&&n.push(...O(U,t,o,i,d,r,s))}}if(n.push(l),g===e.length-1)return n;const m=e[g+1],f={fom:p(l.tidsperiode.tom).neste(),tom:p(m.tidsperiode.fom).forrige()};return a(f.tom).isBefore(f.fom,"day")||!r&&a(f.tom).isBefore(o,"day")||k(f).getAntallUttaksdager()>0&&n.push(...O(f,t,o,i,d,r,s)),n},[]),_=(e,t)=>{const o=t.filter(d=>k(e.tidsperiode).inneholderDato(d.dato)),i=[];return o.length===2?[e]:(o.forEach((d,r)=>{if(r===0){i.push({...e,tidsperiode:{fom:d.dato,tom:void 0}});return}i[r-1].tidsperiode.tom=d.erFom?p(d.dato).forrige():d.dato,r<o.length-1&&i.push({...e,id:D(),tidsperiode:{fom:d.erFom?d.dato:p(d.dato).neste(),tom:void 0}})}),i.filter(d=>G(d.tidsperiode)))},W=(e,t)=>{const o=e.filter(n=>G(n.tidsperiode)).reduce((n,l)=>(n.push({dato:l.tidsperiode.fom,erFom:!0}),n.push({dato:l.tidsperiode.tom,erFom:!1}),n),[]),i=t.reduce((n,l)=>(n.push({dato:l.tidsperiode.fom,erFom:!0}),n.push({dato:l.tidsperiode.tom,erFom:!1}),n),[]),r=o.concat(i).sort((n,l)=>{if(n.dato.getTime()-l.dato.getTime()===0){if(!n.erFom)return 1;if(!l.erFom)return-1}return n.dato.getTime()-l.dato.getTime()}).filter((n,l,g)=>g.findIndex(m=>m.dato.getTime()===n.dato.getTime()&&m.erFom===n.erFom)===l),s=[],c=[];return e.forEach(n=>{const l=_(n,r);s.push(...l)}),t.forEach(n=>{const l=_(n,r);c.push(...l)}),{normaliserteEgnePerioder:s,normaliserteAnnenPartsPerioder:c}},ue=(e,t,o,i,d=!1)=>{if(t.length===0)return e;if(e.length===0)return t;const{normaliserteEgnePerioder:r,normaliserteAnnenPartsPerioder:s}=W(e,t),c=r.reduce((f,u)=>{const P=T(s).finnOverlappendePerioder(u);if(P.length===0)return E(u)&&u.ønskerSamtidigUttak&&d?(f.push({...u,ønskerSamtidigUttak:!1}),f):(f.push(u),f);if(y(u)||z(u)||B(u)){const U=P[0];return f.push({...U,visPeriodeIPlan:!0}),f}if(E(u)&&u.ønskerSamtidigUttak){const U=P[0];return f.push(u),C(U)||f.push({...U,visPeriodeIPlan:!1,ønskerSamtidigUttak:!0}),f}else return f.push(u),f},[]);c.sort(H);const n=e[0].tidsperiode.fom,l=s.filter(f=>a(f.tidsperiode.tom).isBefore(n,"day")),g=e[e.length-1].tidsperiode.tom,m=s.filter(f=>a(f.tidsperiode.fom).isAfter(g,"day"));return b([...l,...c,...m],o,i,t)},ee=(e,t)=>{const o=k(e.tidsperiode).getAntallUttaksdager(),i={...e,tidsperiode:{fom:e.tidsperiode.fom,tom:p(t.tidsperiode.fom).forrige()}},d=k(i.tidsperiode).getAntallUttaksdager(),r=o-d,s=p(t.tidsperiode.tom).neste();if(V(e)){const c={...e,id:D(),tidsperiode:{fom:t.tidsperiode.fom,tom:e.tidsperiode.tom}};return[i,t,c]}else{const c={...e,id:D(),tidsperiode:{fom:s,tom:p(s).leggTil(r-1)}};return[i,t,c]}},te=(e,t)=>{const o={...e,tidsperiode:{fom:e.tidsperiode.fom,tom:p(t).forrige()}},i={...e,id:D(),tidsperiode:{fom:p(o.tidsperiode.tom).neste(),tom:e.tidsperiode.tom}};return[o,i]},ce=(e,t)=>{const o={...e,konto:e.konto==F.Foreldrepenger?F.AktivitetsfriKvote:e.konto,morsAktivitetIPerioden:e.konto==F.Foreldrepenger?void 0:e.morsAktivitetIPerioden,erMorForSyk:e.konto==F.Foreldrepenger?void 0:e.erMorForSyk,tidsperiode:{fom:e.tidsperiode.fom,tom:p(t).forrige()}},i={...e,id:D(),tidsperiode:{fom:p(o.tidsperiode.tom).neste(),tom:e.tidsperiode.tom}};return[o,i]},oe=(e,t)=>{if(T([e]).finnOverlappendePerioder(t).length>0){const o=[a(e.tidsperiode.fom),a(e.tidsperiode.tom),a(t.tidsperiode.fom),a(t.tidsperiode.tom)],i=a.min(o),d=a.max(o),r=o.filter(s=>s!==i&&s!==d);return k({fom:a.min(r).toDate(),tom:a.max(r).toDate()}).getAntallUttaksdager()}return 0},pe=({perioder:e,nyPeriode:t,familiehendelsesdato:o,harAktivitetskravIPeriodeUtenUttak:i,erAdopsjon:d,bareFarHarRett:r,erFarEllerMedmor:s,førsteUttaksdagNesteBarnsSak:c})=>{if(e.length===0)return[t];const n=t.tidsperiode.fom,l=t.tidsperiode.tom;if(a(n).isBefore(o,"day")&&a(l).isSameOrAfter(o,"day"))return[...e];const g=e.find(m=>k(m.tidsperiode).inneholderDato(n));if(g){if(Y(g)||Z(g))return[...e];const m=T(e).finnAlleForegåendePerioder(g),f=T(e).finnAllePåfølgendePerioder(g),u=k(t.tidsperiode).getAntallUttaksdager();if(a(g.tidsperiode.fom).isSame(n))return[...m,t,...T([g,...f]).forskyvPerioder(u)];const P=ee(g,t);return V(g)?[...m,P[0],P[1],...T([P[2],...f]).forskyvPerioder(u)]:[...m,...P,...T(f).forskyvPerioder(u)]}else{const m=e[0],f=e[e.length-1],u=a(t.tidsperiode.fom),P=a(t.tidsperiode.tom);if(u.isBefore(m.tidsperiode.fom,"day")){const U=K(t.tidsperiode,m.tidsperiode);if(P.isSameOrAfter(m.tidsperiode.fom,"day")){if(u.isBefore(o,"day"))return[...e];const A=oe(m,t);return[t,...T(e).forskyvPerioder(A)]}return U?[t,...O(U,i,o,d,r,s,c),...e]:[t,...e]}else{const U=K(f.tidsperiode,t.tidsperiode);return U?[...e,...O(U,i,o,d,r,s,c),t]:[...e,t].sort(H)}}};export{$ as A,M,ce as a,te as b,b as c,me as d,ge as f,O as g,pe as l,W as n,ue as s};
