import{af as re,bK as U,f as Y,j as ce,ad as Q,i as ve,ak as Ae,ae as Se,cZ as H,J as v,bJ as Z,U as h,c_ as ge,G as k,c$ as F,d0 as y,y as A,ag as p,V as G,K as g,d1 as R,d2 as K,M as Re,bA as V,C as $,a2 as Te,D as pe,bq as N,bC as Ie,L as j}from"./iframe-DB3LpkTd.js";import{I as w,r as te,j as ne,Q as b,o as _e}from"./annenForelderUtils-CUqgttbr.js";import{g as T}from"./guid-CsArkN6i.js";import{q as Oe}from"./useFpNavigator-CCRyr9PR.js";var I=(e=>(e.ADOPSJON="ADPSJN",e.OMSORGSOVERTAKELSE="OMSRGO",e.FØDSEL="FODSL",e.TERM="TERM",e))(I||{}),_=(e=>(e.UttakFellesperiodeAnnenForelder="FELLESPERIODE_ANNEN_FORELDER",e.UttakFedrekvoteAnnenForelder="FEDREKVOTE_ANNEN_FORELDER",e.UttakMødrekvoteAnnenForelder="MØDREKVOTE_ANNEN_FORELDER",e.UttakForeldrepengerAnnenForelder="FORELDREPENGER_ANNEN_FORELDER",e.Ingen="INGEN",e))(_||{}),D=(e=>(e.AVSLAG_FRATREKK_PLEIEPENGER="AVSLAG_FRATREKK_PLEIEPENGER",e.AVSLAG_UTSETTELSE_TILBAKE_I_TID="AVSLAG_UTSETTELSE_TILBAKE_I_TID",e.INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID="INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID",e.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER="AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER",e.ANNET="ANNET",e))(D||{}),P=(e=>(e.BARE_SØKER_RETT="BARE_SØKER_RETT",e.ALENEOMSORG="ALENEOMSORG",e.BEGGE_RETT="BEGGE_RETT",e))(P||{}),c=(e=>(e.Ferie="LOVBESTEMT_FERIE",e.Arbeid="ARBEID",e.Sykdom="SØKER_SYKDOM",e.InstitusjonSøker="SØKER_INNLAGT",e.InstitusjonBarnet="BARN_INNLAGT",e.HvØvelse="HV_ØVELSE",e.NavTiltak="NAV_TILTAK",e.Fri="FRI",e))(c||{}),B=(e=>(e.ORDINÆRT_ARBEID="ORDINÆRT_ARBEID",e.SELVSTENDIG_NÆRINGSDRIVENDE="SELVSTENDIG_NÆRINGSDRIVENDE",e.FRILANS="FRILANS",e.ANNET="ANNET",e))(B||{});const oe=(e,r,t)=>{if(t!==void 0)return I.ADOPSJON;if(e!==void 0)return I.FØDSEL;if(r!==void 0)return I.TERM;throw new Error("Fødselsdato/ termindato/ omsorgsovertakelsedato mangler")},tr=(e,r,t)=>e?t.formatMessage({id:"adopsjon"}):r?t.formatMessage({id:"fødsel"}):t.formatMessage({id:"termin"}),z=e=>H(e).getAntallUttaksdager()>0,Pe=e=>ge(e.tidsperiode),Ne=(e,r,t)=>!!(v(e.tidsperiode.tom).isBefore(t)&&v(r.tidsperiode.tom).isBefore(t)||v(e.tidsperiode.fom).isSameOrAfter(t)&&v(r.tidsperiode.fom).isSameOrAfter(t)),Me=(e,r,t)=>{if(e.length<=1)return e;const n=[],o=e.filter(i=>U(i)),a=[...e.filter(i=>!U(i)),...o];let d={...a[0]};return a.forEach((i,f)=>{if(f!==0){if(d===void 0){d=i;return}if(H(d).erLik(i,!1,!0)&&H(d).erSammenhengende(i)&&!v(i.tidsperiode.fom).isSame(r,"day")&&Ne(d,i,r)&&!(t!==void 0&&v(i.tidsperiode.fom).isSame(t,"day"))){d.tidsperiode.tom=i.tidsperiode.tom;return}else n.push(d);d=i}}),n.push(d),n.sort(re)},Le=e=>{const{fom:r,tom:t}=e.tidsperiode,n=Z(r),o=Z(t);return n&&o?e:!n&&!o?{...e,tidsperiode:{fom:h(r).neste(),tom:h(t).forrige()}}:!n&&o?{...e,tidsperiode:{fom:h(r).neste(),tom:t}}:{...e,tidsperiode:{fom:r,tom:h(t).forrige()}}},O=(e,r)=>e.gjelderAnnenPart?r?G.mor:G.farMedmor:r?G.farMedmor:G.mor,se=e=>{switch(e){case c.Arbeid:return g.Arbeid;case c.Ferie:return g.Ferie;case c.InstitusjonBarnet:return g.InstitusjonBarnet;case c.InstitusjonSøker:return g.InstitusjonSøker;case c.Sykdom:return g.Sykdom;case c.HvØvelse:return g.HvØvelse;case c.NavTiltak:return g.NavTiltak;case c.Fri:return g.Fri;default:return}},Ue=e=>{switch(e.kontoType){case k.Fedrekvote:return R.UttakFedrekvoteAnnenForelder;case k.Fellesperiode:return R.UttakFellesperiodeAnnenForelder;case k.Mødrekvote:return R.UttakMødrekvoteAnnenForelder;case k.Foreldrepenger:return R.UttakForeldrepengerAnnenForelder;case k.ForeldrepengerFørFødsel:return R.ForeldrepengerFørFødsel;default:return}},de=(e,r,t)=>{if(e)return e.toString();if(r)return t?(100-t).toString():"100"},De=e=>e?k.AktivitetsfriKvote:k.Foreldrepenger,he=(e,r,t,n)=>{if(e&&!r.flerbarnsdager&&!r.samtidigUttak&&v(r.periode.fom).isBefore(v(t).add(6,"weeks"),"day")&&n!==k.AktivitetsfriKvote&&r.morsAktivitet!==Re.Uføre)return!0},Ge=(e,r,t)=>{const n=e.gradering!==void 0&&e.resultat.innvilget,o=F(e.periode),s=r.søkerErFarEllerMedmor&&!r.morHarRett&&!r.farMedmorErAleneOmOmsorg&&!r.harAnnenForelderTilsvarendeRettEØS,a=t!==void 0?t.find(M=>(p(F(M.periode)).erLik(o)||p(F(M.periode)).overlapper(o))&&M.guid!==e.guid):void 0;let d;a&&(d=a.samtidigUttak);const i=de(e.samtidigUttak,d,e.gradering?.arbeidstidprosent),f=ie(e),{termindato:l,fødselsdato:m,omsorgsovertakelsesdato:E}=r,S=te(l,m,E),u=s?De(e.resultat.trekkerMinsterett):e.kontoType;return{id:T(),type:A.Uttak,konto:u,tidsperiode:o,forelder:O(e,r.søkerErFarEllerMedmor),ønskerSamtidigUttak:e.samtidigUttak!==void 0,gradert:n,samtidigUttakProsent:i,ønskerFlerbarnsdager:r.antallBarn>1?e.flerbarnsdager:void 0,stillingsprosent:n?e.gradering.arbeidstidprosent.toString():void 0,arbeidsformer:n?[we(e.gradering.aktivitet.type)]:void 0,orgnumre:n&&e.gradering.aktivitet.arbeidsgiver!==void 0?[e.gradering.aktivitet.arbeidsgiver.id]:void 0,morsAktivitetIPerioden:e.morsAktivitet,erMorForSyk:he(r.søkerErFarEllerMedmor,e,S,u),angittAvAnnenPart:e.angittAvAnnenPart,opprinneligSøkt:f}},ye=(e,r)=>({id:T(),type:A.Utsettelse,årsak:se(e.utsettelseÅrsak),tidsperiode:F(e.periode),forelder:O(e,r),erArbeidstaker:!1,morsAktivitetIPerioden:e.morsAktivitet}),ie=e=>{if(e.resultat.årsak===D.AVSLAG_UTSETTELSE_TILBAKE_I_TID){if(e.utsettelseÅrsak===c.Ferie)return K.Ferie;if(e.utsettelseÅrsak===c.Arbeid)return K.Arbeid}if(e.resultat.årsak===D.INNVILGET_UTTAK_AVSLÅTT_GRADERING_TILBAKE_I_TID)return K.Gradering},Ve=(e,r)=>{const t=ie(e);return{id:T(),type:A.Info,infotype:y.avslåttPeriode,tidsperiode:F(e.periode),avslåttPeriodeType:e.utsettelseÅrsak!==void 0?A.Utsettelse:A.Uttak,kontoType:e.kontoType,forelder:O(e,r),overskrives:!0,visPeriodeIPlan:!0,kanSlettes:e.resultat.årsak!==D.AVSLAG_FRATREKK_PLEIEPENGER,opprinneligSøkt:t}},Ke=(e,r,t,n)=>{const o=F(e.periode);if(e.utsettelseÅrsak!==void 0&&e.resultat.innvilget===!0)return{type:A.Info,infotype:y.utsettelseAnnenPart,id:T(),årsak:se(e.utsettelseÅrsak),tidsperiode:o,forelder:O(e,r),overskrives:!0,visPeriodeIPlan:!0};const s=n!==void 0&&!n.some(l=>(p(F(l.periode)).erLik(o)||p(F(l.periode)).overlapper(o))&&l.guid!==e.guid),a=Ue(e),d=n!==void 0?n.find(l=>(p(F(l.periode)).erLik(o)||p(F(l.periode)).overlapper(o))&&l.guid!==e.guid):void 0;let i;d&&(i=d.samtidigUttak);const f=de(e.samtidigUttak,i,e.gradering?.arbeidstidprosent);return J(e,t)?{type:A.Info,infotype:y.avslåttPeriode,id:T(),tidsperiode:o,forelder:O(e,r),overskrives:!0,visPeriodeIPlan:s,kontoType:e.kontoType,avslåttPeriodeType:A.Uttak,kanSlettes:!1}:{type:A.Info,infotype:y.uttakAnnenPart,id:T(),årsak:a,tidsperiode:o,forelder:O(e,r),overskrives:!0,gradert:e.gradering!==void 0,ønskerSamtidigUttak:f!==void 0,samtidigUttakProsent:f,stillingsprosent:e.gradering!==void 0?e.gradering.arbeidstidprosent.toString():void 0,visPeriodeIPlan:s}},je=(e,r)=>({id:T(),forelder:O(e,r),konto:e.kontoType,tidsperiode:F(e.periode),type:A.Overføring,årsak:e.overføringÅrsak}),He=(e,r,t)=>{const n=t.filter(o=>!J(o,r.termindato));return e.gjelderAnnenPart?Ke(e,r.søkerErFarEllerMedmor,r.termindato,n):e.resultat.innvilget?e.utsettelseÅrsak!==void 0?ye(e,r.søkerErFarEllerMedmor):e.overføringÅrsak!==void 0?je(e,r.søkerErFarEllerMedmor):Ge(e,r,n):Ve(e,r.søkerErFarEllerMedmor)},J=(e,r)=>r&&e.gjelderAnnenPart&&!e.resultat.innvilget&&e.resultat.trekkerDager&&v(e.periode.tom).isBefore(v(w(r)),"d")&&e.kontoType!==k.Fedrekvote,be=(e,r)=>e.resultat.innvilget?!0:e.gjelderAnnenPart?!!J(e,r):e.resultat.årsak!==D.AVSLAG_HULL_MELLOM_FORELDRENES_PERIODER&&e.resultat.trekkerDager===!0,Be=(e,r,t)=>{const n=[];return e.forEach(o=>{Q(o.tidsperiode,r)&&ve(o)?Ae(o,r).forEach(a=>n.push(a)):t!==void 0&&Q(o.tidsperiode,t)?Se(o,t).forEach(a=>n.push(a)):n.push(o)}),n},ae=(e,r,t)=>{const n=e.filter(u=>be(u,r.termindato)),o=n.map(u=>He(u,r,n)),s=new Date(r.familiehendelseDato),a=Be(o,s,t),d=Me([...a].sort(re).filter(z).map(Le).filter(Pe).filter(z),s,t),i=!r.morHarRett&&r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,f=r.familiehendelseType===I.ADOPSJON,l=d.filter(u=>!U(u)),m=d.filter(u=>U(u)),E=!r.erDeltUttak&&i&&!r.farMedmorErAleneOmOmsorg,S=Y(l,E,s,f,i,r.søkerErFarEllerMedmor,t);return Y(ce(S,m,s,t),E,s,f,i,r.søkerErFarEllerMedmor,t)},we=e=>{switch(e){case B.SELVSTENDIG_NÆRINGSDRIVENDE:return j.selvstendignæringsdrivende;case B.FRILANS:return j.frilans;default:return j.arbeidstaker}},Je=e=>{switch(e){case _.UttakFedrekvoteAnnenForelder:return k.Fedrekvote;case _.UttakFellesperiodeAnnenForelder:return k.Fellesperiode;case _.UttakMødrekvoteAnnenForelder:return k.Mødrekvote;default:return}},qe=e=>{switch(e){case _.UttakFedrekvoteAnnenForelder:return R.UttakFedrekvoteAnnenForelder;case _.UttakFellesperiodeAnnenForelder:return R.UttakFellesperiodeAnnenForelder;case _.UttakMødrekvoteAnnenForelder:return R.UttakMødrekvoteAnnenForelder;default:return}},le=(e,r)=>{const{oppholdÅrsak:t}=e,n={guid:T(),periode:{fom:e.fom,tom:e.tom},gjelderAnnenPart:r,resultat:e.resultat,kontoType:e.kontoType,flerbarnsdager:e.flerbarnsdager,gradering:e.gradering,utsettelseÅrsak:e.utsettelseÅrsak,overføringÅrsak:e.overføringÅrsak,samtidigUttak:e.samtidigUttak,morsAktivitet:e.morsAktivitet,oppholdÅrsak:qe(e.oppholdÅrsak)};return t!==void 0&&(n.kontoType=Je(t),r&&(n.gjelderAnnenPart=!1,n.angittAvAnnenPart=!0),r||(n.gjelderAnnenPart=!0)),n},W=e=>e.resultat.innvilget,fe=(e,r,t)=>{const n=t.filter(s=>e.guid!==s.guid&&p(F(e.periode)).erLik(F(s.periode)));if(n.length===0)return!0;const o=n.filter(W);return!(W(e)===!1&&o.length>0)},nr=e=>{if(!(!e||e.perioder.length===0))return w(e.perioder[0].fom)},or=(e,r,t,n,o)=>{if(e===void 0||e==="")return;const s=!0,a=e.perioder.map(E=>le(E,s)).filter(fe);let d;e.termindato!==void 0?d=e.termindato:($(r)||Te(r))&&r.termindato!==void 0&&(d=r.termindato);const i=$(r)?r.fødselsdatoer[0]:void 0,f=pe(r)?r.adopsjonsdato:void 0,l={dekningsgrad:e.dekningsgrad==="HUNDRE"?V.HUNDRE_PROSENT:V.ÅTTI_PROSENT,antallBarn:e.antallBarn??r.antallBarn,morErAleneOmOmsorg:!1,morErUfør:!1,morHarRett:!0,farMedmorErAleneOmOmsorg:!1,farMedmorHarRett:!0,søkerErFarEllerMedmor:t,termindato:d,fødselsdato:i,omsorgsovertakelsesdato:f,erDeltUttak:!0,erBarnetFødt:i!==void 0,familiehendelseDato:n,familiehendelseType:oe(i,d,f),harAnnenForelderTilsvarendeRettEØS:!1,ønskerJustertUttakVedFødsel:void 0,barn:[]},m=ae(a,l,o);return{saksnummer:"",erAnnenPartsSak:s,grunnlag:l,saksperioder:a,uttaksplan:m.filter(E=>U(E))}},xe=(e,r,t)=>{const{dekningsgrad:o,familiehendelse:{fødselsdato:s,termindato:a,omsorgsovertakelse:d,antallBarn:i},harAnnenForelderTilsvarendeRettEØS:f,morUføretrygd:l,rettighetType:m,sakTilhørerMor:E,ønskerJustertUttakVedFødsel:S}=e,u=e.gjeldendeVedtak?e.gjeldendeVedtak.perioder:[],q=!E,M=t&&t.length>0?ne(t[0]):void 0,L=s??M,x={dekningsgrad:o==="HUNDRE"?V.HUNDRE_PROSENT:V.ÅTTI_PROSENT,antallBarn:i,morErAleneOmOmsorg:E&&m===P.ALENEOMSORG,morErUfør:l,morHarRett:E||m===P.BEGGE_RETT,farMedmorErAleneOmOmsorg:!E&&m===P.ALENEOMSORG,farMedmorHarRett:!E||m===P.BEGGE_RETT,søkerErFarEllerMedmor:q,termindato:a,fødselsdato:L,omsorgsovertakelsesdato:d,erDeltUttak:m===P.BEGGE_RETT,erBarnetFødt:L!==void 0,familiehendelseDato:te(a,L,d),familiehendelseType:oe(L,a,d),ønskerJustertUttakVedFødsel:L===void 0?S:void 0,harAnnenForelderTilsvarendeRettEØS:f},C=u.map(ke=>le(ke,!1)).filter(fe),Fe=ae(C,x,r);return{saksnummer:e.saksnummer,erAnnenPartsSak:!1,grunnlag:x,saksperioder:C,uttaksplan:Fe}},me=e=>e===I.TERM||e===I.FØDSEL?"fødsel":"adopsjon",Ce=(e,r)=>{const{søkerErFarEllerMedmor:t}=r;return e.kjønn==="K"?t?"medmor":"mor":"far"},X=(e,r)=>e.fødselsdatoer?b(e.fødselsdatoer):r.fødselsdato?Array(r.antallBarn).fill(r.fødselsdato):[],Ye=(e,r,t)=>{switch(e){case"fødsel":return r.fødselsdato?{type:N.FØDT,antallBarn:r.antallBarn,fødselsdatoer:X(t,r),termindato:r.termindato,fnr:t?.fnr}:{type:N.UFØDT,antallBarn:r.antallBarn,termindato:r.termindato};case"adopsjon":return{type:N.ADOPTERT_STEBARN,adopsjonsdato:r.omsorgsovertakelsesdato,antallBarn:r.antallBarn,fødselsdatoer:X(t,r),fnr:t?.fnr};case"omsorgsovertakelse":throw new Error("Kan ikke sende endringssøknad for omsorgsovertakelse")}},ee=(e,r)=>e.fornavn!==void 0&&e.fornavn!==""?e.fornavn:r.formatMessage({id:"annen.forelder"}),Qe=(e,r,t,n,o)=>{switch(e){case"fødsel":case"adopsjon":return n?{fornavn:ee(t,o),etternavn:t.etternavn,erMorUfør:r.morErUfør,harRettPåForeldrepengerINorge:!!r.morHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS,erAleneOmOmsorg:r.farMedmorErAleneOmOmsorg}:{fornavn:ee(t,o),etternavn:t.etternavn,harRettPåForeldrepengerINorge:!!r.farMedmorHarRett&&!r.harAnnenForelderTilsvarendeRettEØS,fnr:t.fnr,kanIkkeOppgis:!1,harRettPåForeldrepengerIEØS:r.harAnnenForelderTilsvarendeRettEØS,erAleneOmOmsorg:r.farMedmorErAleneOmOmsorg||r.morErAleneOmOmsorg};case"omsorgsovertakelse":throw new Error("Kan ikke sende endringssøknad for omsorgsovertakelse")}},Ze=(e,r,t,n,o,s,a)=>{if(s===void 0&&r===void 0||!a)return;const d=s!==void 0?e.find(l=>s.includes(l.fnr)&&l.annenForelder!==void 0):void 0,i=r!==void 0?e.find(l=>_e(l.fødselsdato,r)&&l.annenForelder!==void 0):void 0,f=d??i;if(f!==void 0&&f.annenForelder?.fnr===a){const l=f.annenForelder,{fornavn:m}=l,E=m!==void 0&&m.trim()!==""?m:o.formatMessage({id:"annen.forelder"}),S={...l,fornavn:E};return Qe(n,t,S,t.søkerErFarEllerMedmor,o)}},Ee=e=>e.fødselsdatoer!==void 0&&e.fødselsdatoer.length>0?{type:N.FØDT,antallBarn:e.antallBarn,fødselsdatoer:b(e.fødselsdatoer),termindato:ne(e.termindato),fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0}:e.termindato!==void 0?{type:N.UFØDT,antallBarn:e.antallBarn,termindato:v(e.termindato).format(Ie)}:{type:N.IKKE_UTFYLT,antallBarn:e.antallBarn,fødselsdatoer:e.fødselsdatoer?b(e.fødselsdatoer):[],fnr:e.fnr!==void 0&&e.fnr.length>0?e.fnr.filter(r=>!!r):void 0},$e=e=>e.annenForelder!==void 0?{fornavn:e.annenForelder.fornavn,etternavn:e.annenForelder.etternavn,fnr:e.annenForelder.fnr,kanIkkeOppgis:!1}:{kanIkkeOppgis:!1},ze=e=>{const r=Oe(e);if(r==="K")return"medmor";if(r==="M")return"far";throw new Error("Kan ikke utlede kjønn fra fødselsnummer.")},sr=e=>{const r=Ee(e),t=$e(e);return{barn:r,annenForelder:t,erEndringssøknad:!1}},ue=(e,r,t,n,o,s)=>{const a=r!==void 0?r.fnr:void 0,d={fornavn:e.formatMessage({id:"annen.forelder"}),etternavn:"",fnr:a??"",harRettPåForeldrepengerINorge:t.søkerErFarEllerMedmor?t.morHarRett&&!t.harAnnenForelderTilsvarendeRettEØS:t.farMedmorHarRett&&!t.harAnnenForelderTilsvarendeRettEØS,harRettPåForeldrepengerIEØS:t.harAnnenForelderTilsvarendeRettEØS,kanIkkeOppgis:!1,erMorUfør:t.søkerErFarEllerMedmor?t.morErUfør:void 0,erAleneOmOmsorg:t.farMedmorErAleneOmOmsorg||t.morErAleneOmOmsorg};return Ze(n,w(t.fødselsdato),t,o,e,s,a)||d},dr=(e,r,t,n)=>{const o=xe(e.sak,void 0,e.fødselsdatoer),{grunnlag:s}=o,a=me(s.familiehendelseType),d=Ee(e),i=ue(r,e.sak.annenPart,s,t,a,e.fnr),f=e.sak.sakTilhørerMor?"mor":ze(n),l={situasjon:e.sak.gjelderAdopsjon?"adopsjon":"fødsel",rolle:f};return{barn:d,annenForelder:i,søkersituasjon:l,erEndringssøknad:!1,dekningsgrad:s.dekningsgrad}},ir=(e,r,t,n,o)=>{const{grunnlag:s,uttaksplan:a}=r,{dekningsgrad:d,familiehendelseType:i,søkerErFarEllerMedmor:f,ønskerJustertUttakVedFødsel:l}=s,m=me(i),E=Ye(m,s,o),S=Ce(e,s),u=ue(t,n,s,e.barn,m,o?.fnr);return{søkersituasjon:{situasjon:m,rolle:S},barn:E,annenForelder:{...u,erAleneOmOmsorg:f?s.farMedmorErAleneOmOmsorg:s.morErAleneOmOmsorg},erEndringssøknad:!0,dekningsgrad:d,uttaksplan:a,saksnummer:r.saksnummer,ønskerJustertUttakVedFødsel:l}};export{xe as a,dr as b,sr as c,tr as d,nr as g,ir as l,or as m};
