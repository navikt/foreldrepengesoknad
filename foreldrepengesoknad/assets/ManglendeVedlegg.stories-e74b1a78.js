import{j as e}from"./jsx-runtime-69eee039.js";import{w as Z}from"./withIntl-37694412.js";import{w as ee}from"./withRouter-45b25a28.js";import{w as ne,F as te}from"./ForeldrepengerStateMock-712e501b.js";import{l as y}from"./vedleggUtils-1fdebe38.js";import{A as p}from"./AttachmentType-f6ad37cf.js";import{S as M}from"./Skjemanummer-77149054.js";import{A as re}from"./AxiosMock-ad51d490.js";import{_ as oe}from"./søkerinfoKvinneMedEttBarn-8f2bf17a.js";import{p as se,u as ae,d as b,q as de,i as d,B as S,G as ie,b as _,_ as L,R as le,s as ge,t as pe,e as R}from"./validationUtils-8694f281.js";import"./index-e13aeee6.js";import"./index-7c191284.js";import{b as me,q as I}from"./dateUtils-af0e9454.js";import{S as O}from"./mapSøkerinfoDTO-248af1a5.js";import{u as ce}from"./useOnValidSubmit-06334c7f.js";import{a as ke,L as ue}from"./useSøknad-368a450f.js";import{u as fe,a as Ee,b as Se,s as ye,g as Me,c as ve}from"./useSaveLoadedRoute-44666777.js";import{Q as je}from"./index-47edccfa.js";import{s as Ae}from"./Periodene-a5e0e5ab.js";import{f as Ne,i as Te}from"./util-f5394a61.js";import{F as xe}from"./FormikFileUploader-2af4534d.js";import{i as Ve}from"./AnnenForelder-5c5d4f7f.js";import{a as he}from"./submitUtils-90494ef4.js";import{L as Fe}from"./Label-2ad8abda.js";import{B as P}from"./Link-00530630.js";import"./IntlProvider-c3950eb6.js";import"./extends-2a43ab49.js";import"./index-ecbee218.js";import"./Attachment-a8e5b8d1.js";import"./apiInterceptor-c6c2844c.js";import"./index-b3a39e30.js";import"./clsx.m-266f4de0.js";import"./v4-a960c1f4.js";import"./api-98fb1897.js";import"./amplitude-bdf1e125.js";import"./globalUtil-c820f73d.js";import"./periodeUtils-d5cd0616.js";import"./AttachmentList-858ddbe5.js";import"./Attachment-b8a0caca.js";const be=4,_e="/soknad/uttaksplan-info",Le={søknad:{type:"foreldrepenger",harGodkjentVilkår:!0,søkersituasjon:{situasjon:"fødsel",rolle:"mor"},barn:{type:"ufødt",terminbekreftelse:[],termindato:"2021-03-15",terminbekreftelsedato:"2021-03-15",antallBarn:"1",datoForAleneomsorg:"",dokumentasjonAvAleneomsorg:[]},annenForelder:{kanIkkeOppgis:!0},søker:{språkkode:"nb"},informasjonOmUtenlandsopphold:{tidligereOpphold:[],senereOpphold:[]},erEndringssøknad:!1,uttaksplan:[]},version:be,currentRoute:_e,søknadGjelderEtNyttBarn:!0};var m=(n=>(n.vedlegg="vedlegg",n))(m||{});const U=se(),Re={[m.vedlegg]:{isAnswered:({vedlegg:n,manglendeVedleggTyper:o,erLikEllerMindreEnnFireUkerTilUttaketStarter:i})=>i?!0:o.every(a=>n.filter(l=>!!l).flat().some(l=>l.type===a)),isIncluded:()=>!0}},Ie=je(Re),Oe=()=>({[m.vedlegg]:[]}),j=(n,o)=>n===p.MORS_AKTIVITET_DOKUMENTASJON?{navn:o}:void 0,Pe=n=>n.reduce((i,a)=>isNaN(+a)?i+"."+a:i+"["+a+"]","").replace(".søknad.",""),A=()=>{const n=ae(),o=ke(),{uttaksplan:i,erEndringssøknad:a}=o,l=Ne(o),N=Array.from(l.keys()),q=r=>(r.vedlegg.forEach((f,E)=>{if(f){const g=Pe(N[E].split("."));L.set(o,g,f)}}),[]),{handleSubmit:W,isSubmitting:T}=ce(q,O.OPPSUMMERING,r=>he(r)),J=fe(),z=Ee(),v=Ve(o.annenForelder)?o.annenForelder.fornavn:"",x=i.filter(r=>r.tidsperiode.fom!==void 0&&!me(r)).sort(Ae).shift(),V=x!==void 0&&b(x.tidsperiode.fom).isSameOrBefore(b().add(4,"weeks"),"day"),X=Array.from(l.values()).map(r=>r.type);return Se(O.MANGLENDE_VEDLEGG),e.jsx(U.FormikWrapper,{initialValues:Oe(),onSubmit:W,renderForm:({values:r})=>{const f=Ie.getVisbility({...r,manglendeVedleggTyper:X,erLikEllerMindreEnnFireUkerTilUttaketStarter:V});return e.jsx(de,{bannerTitle:d(n,"søknad.pageheading"),activeStepId:"dokumentasjon",pageTitle:d(n,"søknad.manglendeVedlegg"),onCancel:J,onContinueLater:z,steps:ye(n,a),children:e.jsxs(U.Form,{includeButtons:!1,children:[e.jsx(S,{padBottom:"l",children:e.jsx(ie,{children:e.jsx(_,{id:V?"manglendeVedlegg.veileder":"manglendeVedlegg.uttaksplan.advarsel.forTidligUtenDokumentasjon"})})}),N.map((E,g)=>{var h,F;const Y=E.replace("søknad.",""),t=L.get(o,Y.replace(".vedlegg","").split(".")),s=l.get(E);return s.type===p.SEN_ENDRING?null:e.jsxs(S,{children:[e.jsx(Fe,{children:d(n,`manglendeVedlegg.title.${s.type}`,j(s.type,v))}),e.jsx(le,{header:d(n,`manglendeVedlegg.apneLabel.${s.type}`,j(s.type,v)),children:e.jsx("div",{style:{backgroundColor:"#f1f1f1",padding:"1.5rem"},children:e.jsx(P,{children:d(n,`manglendeVedlegg.info.${s.type}`,j(s.type,v))})})}),(t==null?void 0:t.tidsperiode)&&(t==null?void 0:t.type)&&e.jsx(S,{margin:"l",children:e.jsx(P,{children:d(n,Te(s.type)?"manglendeVedlegg.uttak.periode.tidsperiode":"manglendeVedlegg.periode.tidsperiode",{type:d(n,s.type===p.ANNEN_INNTEKT?`inntektstype.${t.type.toLowerCase()}`:t.type),fom:I(t.tidsperiode.fom),tom:t.tidsperiode.tom?I(t.tidsperiode.tom):"-"})})}),e.jsx(ge,{name:m.vedlegg,render:()=>e.jsx(xe,{name:`${m.vedlegg}.${g}`,legend:"",label:d(n,"manglendeVedlegg.lastopp.manglende.vedlegg"),attachments:r.vedlegg&&r.vedlegg.length>g&&r.vedlegg[g]?r.vedlegg[g]:[],attachmentType:s.type,skjemanummer:s.skjemanummer},`${m.vedlegg}.${g}`)})]},s.type+((h=t==null?void 0:t.tidsperiode)==null?void 0:h.fom)+((F=t==null?void 0:t.tidsperiode)==null?void 0:F.tom))}),e.jsx(S,{children:e.jsxs(pe,{children:[e.jsx(R,{variant:"secondary",as:ue,to:a?Me("dokumentasjon"):ve("dokumentasjon"),children:e.jsx(_,{id:"backlink.label"})}),f.areAllQuestionsAnswered()&&e.jsx(R,{type:"submit",disabled:T,loading:T,children:d(n,"søknad.gåVidere")})]})})]})})}})},$=A;try{A.displayName="ManglendeVedlegg",A.__docgenInfo={description:"",displayName:"ManglendeVedlegg",props:{}}}catch{}const H=oe,c=Le,An={title:"steps/ManglendeVedlegg",component:$,decorators:[ee,Z,ne]},Q=({context:n,søkerinfo:o})=>{const i=a=>{a.onPost("/storage/vedlegg").reply(200,{data:{}},{location:""})};return e.jsx(re,{mock:i,children:e.jsx(te,{søknad:n,søkerinfo:o,children:e.jsx($,{})})})},k=Q.bind({});k.args={context:{...c,søknad:{...c.søknad,barn:{...c.søknad.barn,dokumentasjonAvAleneomsorg:[y(p.ALENEOMSORG,M.DOK_AV_ALENEOMSORG)],terminbekreftelse:[y(p.TERMINBEKREFTELSE,M.TERMINBEKREFTELSE)]}}},søkerinfo:H};const u=Q.bind({});u.args={context:{...c,søknad:{...c.søknad,søker:{...c.søknad.søker,andreInntekterSiste10Mnd:[{pågående:!0,tidsperiode:{fom:"2021-08-01",tom:""},type:"ETTERLØNN_SLUTTPAKKE",vedlegg:[y(p.ANNEN_INNTEKT,M.ETTERLØNN_ELLER_SLUTTVEDERLAG)]},{pågående:!0,tidsperiode:{fom:"2021-09-01",tom:""},type:"ETTERLØNN_SLUTTPAKKE",vedlegg:[y(p.ANNEN_INNTEKT,M.ETTERLØNN_ELLER_SLUTTVEDERLAG)]}]}}},søkerinfo:H};var B,G,D;k.parameters={...k.parameters,docs:{...(B=k.parameters)==null?void 0:B.docs,source:{originalSource:`({
  context,
  søkerinfo
}) => {
  const restMock = (apiMock: MockAdapter) => {
    apiMock.onPost('/storage/vedlegg').reply(200, {
      data: {}
    }, {
      location: ''
    });
  };
  return <AxiosMock mock={restMock}>
            <ForeldrepengerStateMock søknad={context} søkerinfo={søkerinfo}>
                <ManglendeVedlegg />
            </ForeldrepengerStateMock>
        </AxiosMock>;
}`,...(D=(G=k.parameters)==null?void 0:G.docs)==null?void 0:D.source}}};var K,w,C;u.parameters={...u.parameters,docs:{...(K=u.parameters)==null?void 0:K.docs,source:{originalSource:`({
  context,
  søkerinfo
}) => {
  const restMock = (apiMock: MockAdapter) => {
    apiMock.onPost('/storage/vedlegg').reply(200, {
      data: {}
    }, {
      location: ''
    });
  };
  return <AxiosMock mock={restMock}>
            <ForeldrepengerStateMock søknad={context} søkerinfo={søkerinfo}>
                <ManglendeVedlegg />
            </ForeldrepengerStateMock>
        </AxiosMock>;
}`,...(C=(w=u.parameters)==null?void 0:w.docs)==null?void 0:C.source}}};const Nn=["Default","ManglerVedleggForUlikePerioder"];export{k as Default,u as ManglerVedleggForUlikePerioder,Nn as __namedExportsOrder,An as default};
//# sourceMappingURL=ManglendeVedlegg.stories-e74b1a78.js.map
