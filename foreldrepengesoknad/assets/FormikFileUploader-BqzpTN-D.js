import{j as s}from"./jsx-runtime-_e34SzbC.js";import{u as V,l as _,b as d,m as k,i as f}from"./Tidsperioden-CgKXkiJn.js";import{r as B}from"./index-DVXBtNgz.js";import"./index--IHLcpuH.js";import{d as L}from"./globalUtil-DleJFKun.js";import{i as T,m as w}from"./vedleggUtils-DQwwH6_U.js";import"./_baseToString-CUxX9raG.js";import"./_createSet-BJbToUt4.js";import{S as D}from"./infobox.module-BfW8cKo0.js";import{g as N}from"./apiInterceptor-ChqlQpSB.js";import{A as R}from"./AttachmentList-BQANkr5i.js";import{B as b}from"./Link-SOWRV7cb.js";function C(e){const t={withCredentials:!0,timeout:45e3,headers:{"content-type":"multipart/form-data"}},i=new FormData;return i.append("id",e.id),i.append("vedlegg",e.file,e.filename),N().post("/rest/storage/foreldrepenger/vedlegg",i,t)}const U={saveAttachment:C},h=[".pdf",".jpeg",".jpg",".png"],x=16,z=x*1024*1024,G=(e,t,i)=>e.map(r=>{const n=w(r,t,i);return n.pending=!0,n}),M=e=>{const t=e.split(".").pop();return h.includes(`.${t.toLowerCase()}`)},X=e=>e<=z,O=(e,t,i)=>e.filter(r=>{const n=M(r.filename);n||t(o=>o.concat(f(i,"vedlegg.feilmelding.ugyldig.type",{filename:r.filename})));const a=X(r.filesize);return a||t(o=>o.concat(f(i,"vedlegg.feilmelding.ugyldig.størrelse",{filename:r.filename,maxStørrelse:x}))),n&&a}),$=(e,t,i,r,n,a)=>{e.forEach(async(o,c)=>{try{const m=await U.saveAttachment(o);o.pending=!1,o.url=m.headers.location,o.uploaded=!0,o.uuid=m.data,t(n+c,o)}catch{i(n+c),r(p=>p.concat(f(a,"vedlegg.feilmelding.opplasting.feilet",{filename:o.filename})))}})},y=({attachments:e,name:t,onFileInputClick:i,attachmentType:r,skjemanummer:n,label:a,legend:o,...c})=>{const m=V(),{setFieldValue:p}=_(),[g,u]=B.useState([]);return s.jsxs(s.Fragment,{children:[s.jsx(d,{padBottom:"xl",children:s.jsx(k,{legend:o,buttonLabel:a,name:t,accept:h.join(", "),onFilesSelect:(l,{push:S,replace:j,remove:A})=>{const E=G(l,r,n),F=O(E,u,m);F.forEach(I=>S(I)),$(F,j,A,u,e.length,m)},onClick:i,error:g.length>0?g.map(l=>s.jsx(b,{children:l},l)):void 0,...c})}),s.jsx(d,{padBottom:"xl",visible:e.length>0,children:s.jsx(R,{attachments:e.filter(l=>!T(l)),showFileSize:!0,onDelete:l=>{p(t,L(e,l))}})}),s.jsx(d,{padBottom:"l",children:s.jsx(D,{})})]})},oe=y;y.__docgenInfo={description:"",methods:[],displayName:"FormikFileUploader"};export{oe as F};
