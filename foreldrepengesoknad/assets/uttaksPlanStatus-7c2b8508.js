import{S as d,b as c,P as a,d as b,n as _,o as E,U as F,h as j,g as B,a as $,p as R}from"./Perioden-31b9a852.js";import{i as l,O as G,a4 as g,d as u,U as T,l as H,Q as w,I as h,ac as x,ad as W,ae as z,z as J}from"./Tidsperioden-230fda20.js";import"./jsx-runtime-d079401a.js";import"./index-f1f2c4b1.js";import{c as A}from"./stringUtils-eb3a9bfa.js";import{g as V}from"./barnUtils-2bd29a1c.js";var f=(t=>(t.UttakFellesperiodeAnnenForelder="UTTAK_FELLESP_ANNEN_FORELDER",t.UttakFedrekvoteAnnenForelder="UTTAK_FEDREKVOTE_ANNEN_FORELDER",t.UttakMødrekvoteAnnenForelder="UTTAK_MØDREKVOTE_ANNEN_FORELDER",t.UttakForeldrepengerAnnenForelder="UTTAK_FORELDREPENGER_ANNEN_FORELDER",t.ForeldrepengerFørFødsel="UTTAK_FORELDREPENGER_FØR_FØDSEL_ANNEN_FORELDER",t.Ingen="INGEN",t))(f||{}),P=(t=>(t.institusjonsoppholdAnnenForelder="INSTITUSJONSOPPHOLD_ANNEN_FORELDER",t.sykdomAnnenForelder="SYKDOM_ANNEN_FORELDER",t.aleneomsorg="ALENEOMSORG",t.ikkeRettAnnenForelder="IKKE_RETT_ANNEN_FORELDER",t))(P||{});const Q=/^[0-9]*$/,q=t=>{let e=2,r=0;for(let n=t.length-2;n>=0;--n)r+=parseInt(t.charAt(n),10)*e,++e>7&&(e=2);const s=11-r%11;return s===11?0:s},C=t=>Q.test(t)&&t.length===9,Y=t=>t.charAt(0)==="8"||t.charAt(0)==="9",yt=t=>!t||C(t)===!1||Y(t)===!1||t==="999999999"?!1:q(t)===parseInt(t.charAt(8),10),X=RegExp(/^[-]?[0-9,.\s]*$/),Z=t=>t.replace(/,/g,".").replace(/\s/g,"").replace(/%/g,""),m=t=>{if(t!=null&&t.length>0&&X.test(t)){const e=Z(t);return(e.match(/\./g)||[]).length>1?void 0:parseFloat(e)}},Ot=t=>t.filter(e=>e.konto===d.Fellesperiode||e.konto===d.Fedrekvote||e.konto===d.Mødrekvote||e.konto===d.Foreldrepenger||e.konto===d.AktivitetsfriKvote).map(e=>e.konto),S=(t,e,r,s,n)=>{let o;switch(e){case d.Mødrekvote:o=r.mor;break;case d.Fedrekvote:o=r.farMedmor;break;default:o=void 0}if(o)return t.formatMessage({id:"uttaksplan.stønadskontotype.foreldernavn.kvote"},{navn:V(A(o),t.locale)});if(s===!0&&n===!1){if(e===d.AktivitetsfriKvote)return t.formatMessage({id:"uttaksplan.stønadskontotype.AKTIVITETSFRI_KVOTE_BFHR"});if(e===d.Foreldrepenger)return t.formatMessage({id:"uttaksplan.stønadskontotype.AKTIVITETSKRAV_KVOTE_BFHR"})}return t.formatMessage({id:`uttaksplan.stønadskontotype.${e}`})},tt=(t,e,r,s,n,o,k)=>{const i=U(r,s);if(n!==void 0){const v=V(i,t.locale),p=e===d.Fellesperiode?"uttaksplan.periodeAnnenPart.tittel.gradertEllerSamtidigUttakFellesperiode":"uttaksplan.periodeAnnenPart.tittel.gradertEllerSamtidigUttak";return l(t,p,{navn:A(v),prosent:n})}return S(t,e,s,o,k)},et=10,L=2*7,rt=6*7,It=(t,e,r,s)=>G(t)&&e&&r&&s==="fødsel",st=t=>c(t)&&t.forelder===g.farMedmor&&t.konto===d.Fedrekvote&&!t.erMorForSyk&&t.morsAktivitetIPerioden===void 0&&!t.ønskerFlerbarnsdager&&t.ønskerSamtidigUttak===!0,M=(t,e,r)=>st(t)&&O(t.tidsperiode,e,r),nt=(t,e)=>c(t)&&t.forelder===g.farMedmor&&!e,at=(t,e)=>{const r=e!==void 0?u(e).subtract(L,"day"):u(t).subtract(L,"day"),s=u.min(r,u(t));return T(s.toDate()).denneEllerNeste()},y=t=>{const e=T(t).denneEllerNeste();return T(u(e).add(rt,"day").toDate()).forrige()},ot=(t,e,r)=>{const s=at(e,r);return u(t.fom).isSameOrAfter(s,"day")},_t=(t,e)=>c(t)&&u(t.tidsperiode.fom).isBefore(e,"day"),ht=(t,e)=>{const r=y(e);return u(t.tom).isSameOrBefore(r,"day")},O=(t,e,r)=>ot(t,e,r)&&u(t.fom).isSameOrBefore(y(e),"day"),Lt=(t,e,r)=>t.filter(s=>M(s,e,r)),Dt=(t,e,r,s,n,o,k)=>t!==void 0&&H(t)&&n&&k==="fødsel"&&G(e)&&r===a.Uttak&&(s===d.Fedrekvote||s===d.Foreldrepenger||s===d.AktivitetsfriKvote)&&O(t,e,o),Kt=(t,e)=>{const r=y(t),s=N({tidsperiode:{fom:e,tom:r}});return Math.min(s,et)},dt=(t,e,r,s,n,o)=>s==="fødsel"&&M(r,n,o)?e+l(t,"rundtFødsel"):e,bt=(t,e,r,s)=>(M(t,e,s)||nt(t,r))&&w(t.tidsperiode,e),jt=(t,e,r)=>t.filter(s=>(c(s)||b(s))&&O(s.tidsperiode,e,r)),Gt=(t,e,r)=>!!t&&e!==void 0&&u(r).isSame(e,"d"),Vt=t=>({fom:h(t.fom),tom:h(t.tom)}),Bt=t=>{const e=m(t);return e?e>0:!1},$t=t=>{const e=m(t);return e?e<=100:!1},Ht=t=>{const e=m(t);return e?e<100:!1},D=t=>t!==void 0&&isNaN(parseFloat(t))===!1,K=t=>{if(t===void 0)return;const e=parseFloat(t);if(!isNaN(e))return Math.round(e)===e?Math.round(e):e},it=(t,e)=>{if(e)return e;if(t){let r=(100-t)*100;return r=Math.round(r)/100,r}},lt=(t,e,r,s)=>{const n=A(r);return s?l(t,`uttaksplan.oppholdsårsaktype.foreldernavn.far.${e}`,{foreldernavn:n}):l(t,`uttaksplan.oppholdsårsaktype.foreldernavn.mor.${e}`,{foreldernavn:n})},I=t=>t===f.UttakFedrekvoteAnnenForelder?d.Fedrekvote:t===f.UttakMødrekvoteAnnenForelder?d.Mødrekvote:t===f.UttakFellesperiodeAnnenForelder?d.Fellesperiode:t===f.UttakForeldrepengerAnnenForelder?d.Foreldrepenger:d.ForeldrepengerFørFødsel,wt=t=>{switch(t){case d.Fedrekvote:return f.UttakFedrekvoteAnnenForelder;case d.Mødrekvote:return f.UttakMødrekvoteAnnenForelder;case d.Fellesperiode:return f.UttakFellesperiodeAnnenForelder;default:return}},U=(t,e)=>{let r="";return e.farMedmor?r=t===g.mor?e.mor:e.farMedmor:r=t===g.mor?e.mor:t,A(r)},ut=(t,e,r,s,n,o,k,i)=>{const v=S(t,e.konto,r,k,i),p=dt(t,v,e,o,s,n);return e.gradert&&D(e.stillingsprosent)||e.ønskerSamtidigUttak&&D(e.samtidigUttakProsent)?`${p} ${l(t,"gradering.prosent",{stillingsprosent:it(K(e.stillingsprosent),e.samtidigUttakProsent?K(e.samtidigUttakProsent):void 0)})}`:p},kt=(t,e,r,s)=>{switch(e.infotype){case E.uttakAnnenPart:return tt(t,I(e.årsak),e.forelder,r,e.samtidigUttakProsent);case E.utsettelseAnnenPart:return l(t,`uttaksplan.periodetype.info.utsettelse.${e.årsak}`,{navn:U(e.forelder,r)});case E.avslåttPeriode:return e.forelder===g.mor&&s||e.forelder===g.farMedmor&&!s?l(t,"uttaksplan.periodetype.info.avslåttPeriode.annenPart",{navn:U(e.forelder,r)}):l(t,`uttaksplan.periodetype.info.${e.infotype}`)}},xt=(t,e,r,s,n,o,k,i)=>{switch(e.type){case a.Uttak:return ut(t,e,r,s,n,o,k,i);case a.PeriodeUtenUttak:return l(t,"uttaksplan.periodetype.periodeUtenUttak.tittel");case a.Overføring:return S(t,e.konto,r);case a.Utsettelse:return e.årsak?l(t,"uttaksplan.periodeliste.utsettelsesårsak",{årsak:l(t,`uttaksplan.utsettelsesårsak.${e.årsak}`)}):l(t,"uttaksplan.periodeliste.utsettelsesårsak.ukjent");case a.Opphold:return lt(t,e.årsak,U(e.forelder,r),e.forelder==="mor");case a.Hull:return l(t,"uttaksplan.periodetype.hull.tittel");case a.Info:return kt(t,e,r,k)}},Wt=(t,e)=>{if(e===void 0)return!1;const r=ft(t,e);return r?r.resultat.innvilget:!1},ft=(t,e)=>e.saksperioder.find(r=>x(W(r.periode),t.tidsperiode)),zt=(t,e)=>t.type===a.Utsettelse||t.type===a.Uttak||t.type===a.Overføring||t.type===a.Opphold||t.type===a.Info?U(t.forelder,e):"Ingen forelder registrert",Jt=t=>{switch(t){case a.Uttak:return"uttaksplan.slettPeriode.uttak";case a.Overføring:return"uttaksplan.slettPeriode.overføring";case a.Opphold:return"uttaksplan.slettPeriode.opphold";case a.Utsettelse:return"uttaksplan.slettPeriode.utsettelse";case a.Info:return"uttaksplan.slettPeriode.info";default:return""}},ct=(t,e)=>t.tidsperiode.fom!==void 0&&t.tidsperiode.tom!==void 0&&u(t.tidsperiode.fom).isSameOrAfter(e,"day")&&u(t.tidsperiode.tom).isSameOrAfter(e,"day"),Qt=(t,e)=>ct(t,e)===!1,gt=t=>t.type===a.Utsettelse&&!z(J(t.tidsperiode.fom)),Ft=t=>t.type===a.Utsettelse&&(t.årsak===F.Ferie||t.årsak===F.Arbeid),qt=t=>gt(t)&&Ft(t),Ct=t=>t===F.Sykdom||t===F.InstitusjonBarnet||t===F.InstitusjonSøker||t===P.institusjonsoppholdAnnenForelder||t===P.sykdomAnnenForelder,Yt=(t,e)=>e.some(r=>j(t).erLik(r,!0,!0)),Xt=(t,e)=>{if(c(t)){const r=e.filter(s=>_(s)).find(s=>_(s)&&u(t.tidsperiode.fom).isSame(s.tidsperiode.fom)&&s.ønskerSamtidigUttak===!0&&s.id!==t.id);return r!==void 0?r:void 0}},Zt=(t,e,r)=>{const s=t.find(n=>n.id===e.id);return s&&s.isValid!==r?t.map(n=>n.id===s.id?{...n,isValid:r}:n):s?t:[...t,{id:e.id,isValid:r}]},N=t=>{const e=j(t).getAntallUttaksdager();if(c(t)){const r=t.stillingsprosent!==void 0,s=t.samtidigUttakProsent!==void 0;if(r&&s||r){const n=(100-m(t.stillingsprosent))/100;return e*n}else return s?e*(m(t.samtidigUttakProsent)/100):e}return e},mt=t=>[...t.filter(c),...pt(t.filter(B)),...Et(t.filter(b)),...At(t.filter($)),...vt(t.filter(R))],Ut=(t,e,r)=>{const s=mt(e);return t.map(n=>{let o=r?0:n.dager;const k=s.filter(i=>i.konto===n.konto);return k&&(k.forEach(i=>{(i.type===a.Uttak||i.type===a.Overføring||R(i))&&(o=r?o+N(i):o-N(i))}),o=r?Math.floor(o):Math.ceil(o)),{konto:n.konto,dager:o}})},te=(t,e)=>Ut(t,e,!0),pt=t=>t.length===0?[]:t.map(e=>({id:e.id,tidsperiode:e.tidsperiode,type:a.Uttak,konto:I(e.årsak),forelder:e.forelder})),Et=t=>t.length===0?[]:t.map(e=>({id:e.id,tidsperiode:e.tidsperiode,type:a.Uttak,konto:e.konto,forelder:e.forelder})),At=t=>{if(t.length===0)return[];const e=[];return t.filter(r=>R(r)===!1).forEach(r=>{r.infotype===E.uttakAnnenPart&&e.push(r)}),e.map(r=>{const{type:s,årsak:n,...o}=r;return{type:a.Uttak,konto:I(r.årsak),...o}})},vt=t=>t.length===0?[]:t.filter(e=>e.avslåttPeriodeType===a.Uttak||e.avslåttPeriodeType===a.Utsettelse).map(e=>({type:a.Uttak,konto:e.kontoType,tidsperiode:e.tidsperiode,id:e.id,forelder:e.forelder}));export{lt as A,Xt as B,mt as C,te as D,Ut as E,Qt as F,Wt as G,Ct as H,qt as I,zt as J,Bt as K,$t as L,Ht as M,It as N,f as O,st as P,ot as Q,ht as R,Lt as S,et as T,_t as U,xt as a,jt as b,Yt as c,S as d,yt as e,N as f,at as g,dt as h,y as i,Kt as j,bt as k,P as l,m,M as n,nt as o,Vt as p,Dt as q,I as r,O as s,wt as t,Gt as u,Z as v,Zt as w,Ot as x,Jt as y,U as z};
