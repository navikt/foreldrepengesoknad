import{d as i,I as m,g as S,U as T}from"./Tidsperioden-50230361.js";import{e as y,g as A,a as D,b as h}from"./barnUtils-91b846b3.js";import"./jsx-runtime-1caa8f64.js";import"./index-753920cd.js";import"./index-1cdf6ce0.js";import"./_baseToString-43959ddd.js";import"./_createSet-fe2162c5.js";import{g as L}from"./dateUtils-2d535cd3.js";var v=(e=>(e.FØDT="født",e.UFØDT="ufødt",e.ADOPTERT="adoptert",e.IKKE_UTFYLT="ikkeUtfylt",e))(v||{});const M=(e,t)=>e?v.ADOPTERT:t.fødselsdato!==void 0?v.FØDT:v.UFØDT,E=(e,t)=>e===void 0||t===void 0?!1:i(e).isSameOrAfter(i(t).subtract(1,"day"),"day")&&i(e).isSameOrBefore(i(t).add(1,"day"),"day"),O=(e,t)=>{const o=e.barn!==void 0?e.barn.map(l=>l.fnr).flat():[],r=m(e.familiehendelse.fødselsdato),s=t.filter(l=>o.includes(l.fnr)),d=r!==void 0?t.filter(l=>E(l.fødselsdato,r)&&!s.find(n=>n.fnr===l.fnr)):[],a=s.concat(d),g=m(L(e.familiehendelse.termindato,e.familiehendelse.fødselsdato,e.familiehendelse.omsorgsovertakelse)),c=M(e.gjelderAdopsjon,e.familiehendelse);let p;return a&&a.length>0?p=a.map(l=>l.fødselsdato):r!==void 0&&(p=Array(e.familiehendelse.antallBarn).fill(r)),{id:S(),type:c,antallBarn:e.familiehendelse.antallBarn,termindato:m(e.familiehendelse.termindato),omsorgsovertagelse:m(e.familiehendelse.omsorgsovertakelse),kanSøkeOmEndring:e.kanSøkeOmEndring,sak:e,fødselsdatoer:p,familiehendelsesdato:g,sortableDato:m(e.familiehendelse.termindato),startdatoFørsteStønadsperiode:e.gjeldendeVedtak!==void 0&&e.gjeldendeVedtak.perioder.length>0?T(m(e.gjeldendeVedtak.perioder[0].fom)).denneEllerNeste():void 0,fornavn:a!==void 0&&a.length>0?a.filter(l=>l.fornavn!==void 0&&l.fornavn.trim()!=="").map(l=>[l.fornavn,l.mellomnavn!==void 0?l.mellomnavn:""].join(" ")):void 0,fnr:a!==void 0&&a.length>0?a.filter(l=>l.fnr!==void 0).map(l=>l.fnr):void 0,alleBarnaLever:a!==void 0&&a.length>0?a.every(l=>h(l)):!1}},P=(e,t)=>{const o=e.mellomnavn!==void 0?[e.fornavn,e.mellomnavn].join(" "):e.fornavn;return{id:S(),type:v.IKKE_UTFYLT,antallBarn:1,fødselsdatoer:[e.fødselsdato],fornavn:o!==void 0?[o]:void 0,fnr:[e.fnr],sortableDato:e.fødselsdato,alleBarnaLever:h(e),annenForelder:t}},U=(e,t,o)=>{const r=[e].concat(t).sort(I);if(!(r.find(d=>!h(d)&&D(d))||r.length==0))return{id:S(),type:v.IKKE_UTFYLT,antallBarn:r.length,fødselsdatoer:r.map(d=>d.fødselsdato),fornavn:r.map(d=>[d.fornavn,d.mellomnavn!==void 0?d.mellomnavn:""].join(" ")),fnr:r.map(d=>d.fnr),sortableDato:r[0].fødselsdato,alleBarnaLever:r.every(d=>h(d)),annenForelder:o}},j=(e,t)=>e.filter(o=>o.barn!==void 0&&o.barn.length>0||o.familiehendelse.termindato!==void 0||o.familiehendelse.fødselsdato!==void 0||o.familiehendelse.omsorgsovertakelse!==void 0).map(o=>O(o,t)),b=(e,t,o)=>{const r=e.filter(n=>!o.find(f=>E(n.fødselsdato,m(f.familiehendelse.fødselsdato)))),s="tempFnr",d=r.map(n=>n.fnr===void 0?{...n,fnr:s+S().toString()}:n),a=t.map(n=>n.fnr).flat(),g=t.filter(n=>n.fødselsdatoer!==void 0&&n.fødselsdatoer.length>0).map(n=>n.fødselsdatoer).flat(),c=[];return d.filter(n=>!(n.dødsdato!==void 0&&g.find(f=>i(f).isSame(i(n.fødselsdato),"day")))).forEach(n=>{if(!a.includes(n.fnr)&&!y(n.fødselsdato)){const f=A(n.fnr,n.fødselsdato,d),u=n.annenForelder!==void 0?{fnr:n.annenForelder.fnr,fornavn:n.annenForelder.fornavn,mellomnavn:n.annenForelder.mellomnavn,etternavn:n.annenForelder.etternavn}:void 0;if(a.push(n.fnr),f.length===0){if(!D(n)){const F=P(n,u);c.push(F)}}else{const F=U(n,f,u);f.forEach(B=>{a.push(B.fnr)}),F!==void 0&&c.push(F)}}}),c.map(n=>n.fnr&&n.fnr.length>0?{...n,fnr:n.fnr.filter(f=>f&&!f.startsWith(s))}:n)},q=(e,t)=>{const o=e.filter(a=>!a.sakAvsluttet),r=e.filter(a=>a.sakAvsluttet),s=j(o,t),d=b(t,s,r);return s.concat(d)},w=(e,t)=>{var s,d;const o=t.filter(a=>a.sak!==void 0&&a.id!==e.id&&a.familiehendelsesdato!==void 0&&i(a.familiehendelsesdato).isAfter(e.familiehendelsesdato,"day"));o.sort(k);const r=o[o.length-1];if(r!==void 0)return{familiehendelsesdato:r.familiehendelsesdato,startdatoFørsteStønadsperiode:r.startdatoFørsteStønadsperiode,fnr:r.fnr,annenForelderFnr:(d=(s=r.sak)==null?void 0:s.annenPart)==null?void 0:d.fnr}},I=(e,t)=>i(e.fødselsdato).isAfter(t.fødselsdato,"d")?1:i(e.fødselsdato).isBefore(t.fødselsdato,"d")||e.fornavn<t.fornavn?-1:1,k=(e,t)=>i(e.sortableDato).isBefore(t.sortableDato,"d")?1:i(e.sortableDato).isAfter(t.sortableDato,"d")?-1:0;export{v as V,w as a,E as b,I as c,q as g,k as s};
