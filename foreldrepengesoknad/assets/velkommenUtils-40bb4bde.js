import{j as i,a as g,F as S}from"./jsx-runtime-670450c2.js";import{i as f,a as N,s as R,B as y,d as m,g as V}from"./validationUtils-00d66cf2.js";import"./index-7e4e529b.js";import"./index-f1f749bf.js";import{r as A,I as u,a7 as U,n as M}from"./dateUtils-becbdc23.js";import{Q as I}from"./index-47edccfa.js";import{g as b}from"./getTypedFormComponents-a42e978b.js";import{B as v}from"./Link-40b5f3c6.js";import{r as x,o as z,s as K,t as q,v as P,n as T}from"./useSøknad-54892a90.js";import{j as w}from"./personUtils-c468cfc0.js";var D=(e=>(e.harForståttRettigheterOgPlikter="harForståttRettigheterOgPlikter",e.valgteBarn="valgteBarn",e))(D||{});const he=e=>({harForståttRettigheterOgPlikter:e,valgteBarn:void 0}),G={valgteBarn:{isIncluded:({selectableBarn:e})=>e.length>0,isAnswered:({valgteBarn:e})=>e!==void 0,visibilityFilter:({selectableBarn:e})=>e.length>0},harForståttRettigheterOgPlikter:{isAnswered:({harForståttRettigheterOgPlikter:e})=>e===!0,isIncluded:({valgteBarn:e,selectableBarn:t})=>e!==void 0||t.length===0}},Y=b(),Fe=I(G),Be=e=>t=>{if(t!==!0)return f(e,"valideringsfeil.velkommen.harForståttRettigheterOgPlikter.påkrevd")},C=e=>t=>{if(t===void 0)return f(e,"steg.footer.spørsmålMåBesvares")};const Q=({sakErFerdigbehandlet:e})=>{const t=N();return i(R,{className:"blokk-xxxs",variant:e?"success":"warning",children:g(v,{size:"small",children:[f(t,e?"velkommen.sak.status.ferdigBehandlet":"velkommen.sak.status.underBehandling")," "]})})};try{SknadStatus.displayName="SknadStatus",SknadStatus.__docgenInfo={description:"",displayName:"SknadStatus",props:{sakErFerdigbehandlet:{defaultValue:null,description:"",name:"sakErFerdigbehandlet",required:!0,type:{name:"boolean"}}}}}catch{}var k=(e=>(e.FØDT="født",e.UFØDT="ufødt",e.ADOPTERT="adoptert",e.IKKE_UTFYLT="ikkeUtfylt",e))(k||{}),H=(e=>(e.SØKNAD_GJELDER_NYTT_BARN="søknad_gjeder_nytt_barn",e))(H||{});const J=e=>({label:g(S,{children:[i(v,{className:"radioTittle",size:"medium",children:f(e,"omBarnet.gjelderAnnetBarn")}),i(y,{margin:"l",children:g(v,{size:"small",children:[" ",f(e,"velkommen.intro.harSaker.barnVelger.info")]})})]}),value:"søknad_gjeder_nytt_barn",className:"radioGroupButton"}),j=e=>i(y,{className:"radioDescription",margin:"l",children:i(Q,{sakErFerdigbehandlet:e})}),W=(e,t,a)=>{const r=K(e,a);return f(a,"velkommen.barnVelger.ufødtBarn",{antallBarnTekst:r,termin:A(t)})},X=(e,t)=>{const a=W(e.antallBarn,e.termindato,t),r=e.sak!==void 0?j(e.sak.åpenBehandling===void 0):void 0,d=e.sak!==void 0?f(t,"velkommen.barnVelger.saksnummer",{saksnummer:e.sak.saksnummer}):"",l=e.sak!==void 0;return{label:g(S,{children:[i(v,{className:"radioTittle",size:"medium",children:a}),l&&g(S,{children:[i(v,{size:"small",className:"radioDescription",children:d}),r]})]}),value:e.id,className:"radioGroupButton"}},Z=(e,t)=>{const a=x(e.fornavn,e.fødselsdatoer,e.omsorgsovertagelse,e.alleBarnaLever,e.antallBarn,t),r=z(e.fødselsdatoer),d=e.type==="født"||e.type==="ikkeUtfylt"?r:A(e.omsorgsovertagelse),l=e.type==="født"||e.type==="ikkeUtfylt"?f(t,"velkommen.barnVelger.født"):f(t,"velkommen.barnVelger.adopsjon"),s=e.sak!==void 0?f(t,"velkommen.barnVelger.saksnummer",{saksnummer:e.sak.saksnummer}):"",p=e.sak!==void 0?j(e.sak.åpenBehandling===void 0):void 0;return{label:g(S,{children:[i(v,{size:"medium",className:"radioTittle",children:a}),e.alleBarnaLever&&g(v,{size:"small",className:"radioDescription",children:[l," ",d]}),i(v,{size:"small",children:s}),p!==void 0&&p]}),value:e.id,name:D.valgteBarn,className:"radioGroupButton"}},$=(e,t)=>{switch(e.type){case"født":case"adoptert":case"ikkeUtfylt":return Z(e,t);case"ufødt":return X(e,t);default:return}},_=e=>{const t=N();return i(y,{visible:e.visibility.isVisible(D.valgteBarn),children:i(y,{margin:"xl",children:i(Y.RadioGroup,{legend:f(t,"velkommen.intro.harSaker.barnVelger.label"),name:D.valgteBarn,validate:C(t),radios:e.selectableBarn.map(a=>$(a,t)).concat([J(t)])})})})};try{_.displayName="BarnVelger",_.__docgenInfo={description:"",displayName:"BarnVelger",props:{selectableBarn:{defaultValue:null,description:"",name:"selectableBarn",required:!0,type:{name:"SelectableBarn[]"}},visibility:{defaultValue:null,description:"",name:"visibility",required:!0,type:{name:"QuestionVisibility<VelkommenFormField, any>"}},formValues:{defaultValue:null,description:"",name:"formValues",required:!0,type:{name:"VelkommenFormData"}},setFieldValue:{defaultValue:null,description:"",name:"setFieldValue",required:!0,type:{name:"(field: string, value: any, shouldValidate?: boolean | undefined) => void"}}}}}catch{}const ee=(e,t)=>e?k.ADOPTERT:t.fødselsdato!==void 0?k.FØDT:k.UFØDT,O=(e,t)=>e===void 0||t===void 0?!1:m(e).isSameOrAfter(m(t).subtract(1,"day"),"day")&&m(e).isSameOrBefore(m(t).add(1,"day"),"day"),te=(e,t)=>{const a=e.barn!==void 0?e.barn.map(o=>o.fnr).flat():[],r=u(e.familiehendelse.fødselsdato),d=t.filter(o=>a.includes(o.fnr)),l=r!==void 0?t.filter(o=>O(o.fødselsdato,r)&&!d.find(n=>n.fnr===o.fnr)):[],s=d.concat(l),p=u(U(e.familiehendelse.termindato,e.familiehendelse.fødselsdato,e.familiehendelse.omsorgsovertakelse)),h=ee(e.gjelderAdopsjon,e.familiehendelse);let F;return s&&s.length>0?F=s.map(o=>o.fødselsdato):r!==void 0&&(F=Array(e.familiehendelse.antallBarn).fill(r)),{id:V(),type:h,antallBarn:e.familiehendelse.antallBarn,termindato:u(e.familiehendelse.termindato),omsorgsovertagelse:u(e.familiehendelse.omsorgsovertakelse),kanSøkeOmEndring:e.kanSøkeOmEndring,sak:e,fødselsdatoer:F,familiehendelsesdato:p,sortableDato:u(e.familiehendelse.termindato),startdatoFørsteStønadsperiode:e.gjeldendeVedtak!==void 0&&e.gjeldendeVedtak.perioder.length>0?M(u(e.gjeldendeVedtak.perioder[0].fom)).denneEllerNeste():void 0,fornavn:s!==void 0&&s.length>0?s.filter(o=>o.fornavn!==void 0&&o.fornavn.trim()!=="").map(o=>[o.fornavn,o.mellomnavn!==void 0?o.mellomnavn:""].join(" ")):void 0,fnr:s!==void 0&&s.length>0?s.filter(o=>o.fnr!==void 0).map(o=>o.fnr):void 0,alleBarnaLever:s!==void 0&&s.length>0?s.every(o=>T(o)):!1}},ne=(e,t)=>{const a=e.mellomnavn!==void 0?[e.fornavn,e.mellomnavn].join(" "):e.fornavn;return{id:V(),type:k.IKKE_UTFYLT,antallBarn:1,fødselsdatoer:[e.fødselsdato],fornavn:a!==void 0?[a]:void 0,fnr:[e.fnr],sortableDato:e.fødselsdato,alleBarnaLever:T(e),annenForelder:t}},ae=(e,t,a)=>{const r=[e].concat(t).sort(le);if(!(r.find(l=>!T(l)&&P(l))||r.length==0))return{id:V(),type:k.IKKE_UTFYLT,antallBarn:r.length,fødselsdatoer:r.map(l=>l.fødselsdato),fornavn:r.map(l=>[l.fornavn,l.mellomnavn!==void 0?l.mellomnavn:""].join(" ")),fnr:r.map(l=>l.fnr),sortableDato:r[0].fødselsdato,alleBarnaLever:r.every(l=>T(l)),annenForelder:a}},re=(e,t)=>e.filter(a=>a.barn!==void 0&&a.barn.length>0||a.familiehendelse.termindato!==void 0||a.familiehendelse.fødselsdato!==void 0||a.familiehendelse.omsorgsovertakelse!==void 0).map(a=>te(a,t)),se=(e,t,a)=>{const r=e.filter(n=>!a.find(c=>O(n.fødselsdato,u(c.familiehendelse.fødselsdato)))),d="tempFnr",l=r.map(n=>n.fnr===void 0?{...n,fnr:d+V().toString()}:n),s=t.map(n=>n.fnr).flat(),p=t.filter(n=>n.fødselsdatoer!==void 0&&n.fødselsdatoer.length>0).map(n=>n.fødselsdatoer).flat(),h=[];return l.filter(n=>!(n.dødsdato!==void 0&&p.find(c=>m(c).isSame(m(n.fødselsdato),"day")))).forEach(n=>{if(!s.includes(n.fnr)&&!w(n.fødselsdato)){const c=q(n.fnr,n.fødselsdato,l),E=n.annenForelder!==void 0?{fnr:n.annenForelder.fnr,fornavn:n.annenForelder.fornavn,mellomnavn:n.annenForelder.mellomnavn,etternavn:n.annenForelder.etternavn}:void 0;if(s.push(n.fnr),c.length===0){if(!P(n)){const B=ne(n,E);h.push(B)}}else{const B=ae(n,c,E);c.forEach(L=>{s.push(L.fnr)}),B!==void 0&&h.push(B)}}}),h.map(n=>n.fnr&&n.fnr.length>0?{...n,fnr:n.fnr.filter(c=>c&&!c.startsWith(d))}:n)},Se=(e,t)=>{const a=e.filter(s=>!s.sakAvsluttet),r=e.filter(s=>s.sakAvsluttet),d=re(a,t),l=se(t,d,r);return d.concat(l)},ye=(e,t)=>{var d,l;const a=t.filter(s=>s.sak!==void 0&&s.id!==e.id&&s.familiehendelsesdato!==void 0&&m(s.familiehendelsesdato).isAfter(e.familiehendelsesdato,"day"));a.sort(oe);const r=a[a.length-1];if(r!==void 0)return{familiehendelsesdato:r.familiehendelsesdato,startdatoFørsteStønadsperiode:r.startdatoFørsteStønadsperiode,fnr:r.fnr,annenForelderFnr:(l=(d=r.sak)==null?void 0:d.annenPart)==null?void 0:l.fnr}};function le(e,t){return m(e.fødselsdato).isAfter(t.fødselsdato,"d")?1:m(e.fødselsdato).isBefore(t.fødselsdato,"d")||e.fornavn<t.fornavn?-1:1}function oe(e,t){return m(e.sortableDato).isBefore(t.sortableDato,"d")?1:m(e.sortableDato).isAfter(t.sortableDato,"d")?-1:0}export{_ as B,H as S,Y as V,he as a,D as b,Be as c,ye as d,le as e,O as f,Se as g,oe as s,Fe as v};
//# sourceMappingURL=velkommenUtils-40bb4bde.js.map
