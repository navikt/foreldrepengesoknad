import{d as l,e as E,b as m,U as B,l as M}from"./Tidsperioden-DK48m8pr.js";import{t as L,g as P}from"./dateUtils-BCcl9vH3.js";import"./jsx-runtime-CexXSJP5.js";import"./index-CSpfAsmC.js";import{g as u}from"./guid-CsArkN6i.js";import"./index-BP8_t0zE.js";import{t as T}from"./useFpNavigator-TuZ2eeKl.js";import"./_baseToString-7VaozA17.js";import"./_createSet-W-93wHM-.js";import{g as y,a as S,b as h}from"./barnUtils-cNO6Yn7t.js";var c=(e=>(e.FØDT="født",e.UFØDT="ufødt",e.ADOPTERT="adoptert",e.IKKE_UTFYLT="ikkeUtfylt",e))(c||{});l.extend(E);l.extend(L);const U=(e,a,t)=>e?c.ADOPTERT:a.fødselsdato!==void 0||t&&t.length>0?c.FØDT:c.UFØDT,D=(e,a)=>e===void 0||a===void 0?!1:l.utc(e).isSameOrAfter(l(a).subtract(1,"day"),"day")&&l.utc(e).isSameOrBefore(l(a).add(1,"day"),"day"),A=(e,a)=>{const t=e.familiehendelse.termindato;if(M(t)){const o=l(t).subtract(17,"week"),i=l(t).add(6,"week");return a.filter(r=>l(r.fødselsdato).isBetween(o,i,"day","[]"))}return[]},O=(e,a)=>{const t=m(e.familiehendelse.fødselsdato),o=e.barn!==void 0?e.barn.map(d=>d.fnr).flat():[],i=a.filter(d=>o.includes(d.fnr)),r=t!==void 0?a.filter(d=>D(d.fødselsdato,t)&&!i.find(s=>s.fnr===d.fnr)):[];return i.concat(r)},b=(e,a)=>{let t;(e.barn||e.familiehendelse.fødselsdato)&&(t=O(e,a)),e.familiehendelse.termindato&&!e.familiehendelse.fødselsdato&&!e.barn&&(t=A(e,a));const o=m(P(e.familiehendelse.termindato,e.familiehendelse.fødselsdato,e.familiehendelse.omsorgsovertakelse)),i=U(e.gjelderAdopsjon,e.familiehendelse,t),r=m(e.familiehendelse.fødselsdato);let d;return t&&t.length>0?d=t.map(s=>l.utc(s.fødselsdato).toDate()):r!==void 0&&(d=Array(e.familiehendelse.antallBarn).fill(r)),{id:u(),type:i,antallBarn:e.familiehendelse.antallBarn,termindato:m(e.familiehendelse.termindato),omsorgsovertagelse:m(e.familiehendelse.omsorgsovertakelse),kanSøkeOmEndring:e.kanSøkeOmEndring,sak:e,fødselsdatoer:d,familiehendelsesdato:o,sortableDato:m(e.familiehendelse.termindato),startdatoFørsteStønadsperiode:e.gjeldendeVedtak!==void 0&&e.gjeldendeVedtak.perioder.length>0?B(m(e.gjeldendeVedtak.perioder[0].fom)).denneEllerNeste():void 0,fornavn:t!==void 0&&t.length>0?t.filter(s=>s.fornavn!==void 0&&s.fornavn.trim()!=="").map(s=>[s.fornavn,s.mellomnavn!==void 0?s.mellomnavn:""].join(" ")):void 0,fnr:t!==void 0&&t.length>0?t.filter(s=>s.fnr!==void 0).map(s=>s.fnr):void 0,alleBarnaLever:t!==void 0&&t.length>0?t.every(s=>h(s)):!1}},j=(e,a)=>{const t=e.mellomnavn!==void 0?[e.fornavn,e.mellomnavn].join(" "):e.fornavn;return{id:u(),type:c.IKKE_UTFYLT,antallBarn:1,fødselsdatoer:[l.utc(e.fødselsdato).toDate()],fornavn:t!==void 0?[t]:void 0,fnr:[e.fnr],sortableDato:l.utc(e.fødselsdato).toDate(),alleBarnaLever:h(e),annenForelder:a}},_=(e,a,t)=>{const o=[e].concat(a).sort(K);if(!(o.find(r=>!h(r)&&S(r))||o.length==0))return{id:u(),type:c.IKKE_UTFYLT,antallBarn:o.length,fødselsdatoer:o.map(r=>l.utc(r.fødselsdato).toDate()),fornavn:o.map(r=>[r.fornavn,r.mellomnavn!==void 0?r.mellomnavn:""].join(" ")),fnr:o.map(r=>r.fnr),sortableDato:l.utc(o[0].fødselsdato).toDate(),alleBarnaLever:o.every(r=>h(r)),annenForelder:t}},I=(e,a)=>e.filter(t=>t.barn!==void 0&&t.barn.length>0||t.familiehendelse.termindato!==void 0||t.familiehendelse.fødselsdato!==void 0||t.familiehendelse.omsorgsovertakelse!==void 0).map(t=>b(t,a)),k=(e,a,t)=>{const o=e.filter(n=>!t.find(f=>D(n.fødselsdato,m(f.familiehendelse.fødselsdato)))),i="tempFnr",r=o.map(n=>n.fnr===void 0?{...n,fnr:i+u().toString()}:n),d=a.map(n=>n.fnr).flat(),s=a.filter(n=>n.fødselsdatoer!==void 0&&n.fødselsdatoer.length>0).map(n=>n.fødselsdatoer).flat(),F=[];return r.filter(n=>!(n.dødsdato!==void 0&&s.find(f=>l(f).isSame(l.utc(n.fødselsdato),"day")))).forEach(n=>{if(!d.includes(n.fnr)&&!T(n.fødselsdato)){const f=y(n.fnr,n.fødselsdato,r),p=n.annenForelder!==void 0?{fnr:n.annenForelder.fnr,fornavn:n.annenForelder.fornavn,mellomnavn:n.annenForelder.mellomnavn,etternavn:n.annenForelder.etternavn}:void 0;if(d.push(n.fnr),f.length===0){if(!S(n)){const v=j(n,p);F.push(v)}}else{const v=_(n,f,p);f.forEach(g=>{d.push(g.fnr)}),v!==void 0&&F.push(v)}}}),F.map(n=>n.fnr&&n.fnr.length>0?{...n,fnr:n.fnr.filter(f=>f&&!f.startsWith(i))}:n)},Q=(e,a)=>{const t=e.filter(d=>!d.sakAvsluttet),o=e.filter(d=>d.sakAvsluttet),i=I(t,a),r=k(a,i,o);return i.concat(r)},X=(e,a)=>{var i,r;const t=a.filter(d=>d.sak!==void 0&&d.id!==e.id&&d.familiehendelsesdato!==void 0&&l(d.familiehendelsesdato).isAfter(e.familiehendelsesdato,"day"));t.sort(R);const o=t[t.length-1];if(o!==void 0)return{familiehendelsesdato:o.familiehendelsesdato,startdatoFørsteStønadsperiode:o.startdatoFørsteStønadsperiode,fnr:o.fnr,annenForelderFnr:(r=(i=o.sak)==null?void 0:i.annenPart)==null?void 0:r.fnr}},K=(e,a)=>l(e.fødselsdato).isAfter(a.fødselsdato,"d")?1:l(e.fødselsdato).isBefore(a.fødselsdato,"d")||e.fornavn<a.fornavn?-1:1,R=(e,a)=>l(e.sortableDato).isBefore(a.sortableDato,"d")?1:l(e.sortableDato).isAfter(a.sortableDato,"d")?-1:0;export{c as V,X as a,K as b,D as c,Q as g,R as s};
