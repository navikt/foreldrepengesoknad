import{aD as D,l as c,b8 as l,a2 as T,b9 as P,ba as I,k as n,b7 as p,bb as y,bc as Y,bd as q}from"./iframe-Gt43Wc9l.js";import{H as v,p as H,q as S}from"./HvemPlanleggerUtils-C51ux6aO.js";import{e as A,a as z,b as C}from"./barnetUtils-DkaYc6sq.js";const J=({famDato:e,tilgjengeligeStønadskontoer:t,fellesperiodeDagerMor:r,startdato:o})=>{if(r===void 0)return{søker1:[],søker2:[]};const a=D(o??e).denneEllerNeste(),i=[],k=[],g=t.find(s=>s.konto===c.Fellesperiode).dager-r,d=t.find(s=>s.konto===c.ForeldrepengerFørFødsel),u=t.find(s=>s.konto===c.Mødrekvote),f=t.find(s=>s.konto===c.Fedrekvote);let m=a;if(d!==void 0){const s=l(D(m).trekkFra(15),d.dager),F={forelder:T.mor,kontoType:c.ForeldrepengerFørFødsel,fom:s.fom,tom:s.tom};i.push(F),m=D(F.tom).neste()}if(u!==void 0){const s=l(m,u.dager),F={forelder:T.mor,kontoType:c.Mødrekvote,fom:s.fom,tom:s.tom};i.push(F),m=D(F.tom).neste()}if(r!==void 0&&r>0){const s=l(m,r),F={forelder:T.mor,kontoType:c.Fellesperiode,fom:s.fom,tom:s.tom};i.push(F),m=D(F.tom).neste()}if(g!==void 0&&g>0){const s=l(m,g),F={forelder:T.farMedmor,kontoType:c.Fellesperiode,fom:s.fom,tom:s.tom};k.push(F),m=D(F.tom).neste()}if(f!==void 0){const s=l(m,f.dager),F={forelder:T.farMedmor,kontoType:c.Fedrekvote,fom:s.fom,tom:s.tom};k.push(F)}return{søker1:[...i].sort(P),søker2:[...k].sort(P)}},Q=(e,t,r,o,a,i)=>{const k=D(e).denneEllerNeste(),g=[];if(r!==!0)if(i){const d={kontoType:c.AktivitetsfriKvote,fom:l(k,o.dager).fom,tom:l(k,o.dager).tom};g.push(d)}else{let d=k;if(I(e)&&a&&o){const f={kontoType:c.AktivitetsfriKvote,fom:l(k,o.dager).fom,tom:l(k,o.dager).tom};g.push(f),d=D(f.tom).neste()}const u={kontoType:t.konto,fom:l(d,t.dager).fom,tom:l(d,t.dager).tom};g.push(u)}else{const d={kontoType:c.AktivitetsfriKvote,fom:l(k,o.dager).fom,tom:l(k,o.dager).tom};g.push(d);const u={kontoType:c.Foreldrepenger,fom:l(D(d.tom).neste(),t.dager).fom,tom:l(D(d.tom).neste(),t.dager).tom};g.push(u)}return{søker1:g,søker2:[]}},V=(e,t)=>{const r=D(e).denneEllerNeste();return{søker1:[{kontoType:t.konto,fom:l(r,t.dager).fom,tom:l(r,t.dager).tom}],søker2:[]}},X=(e,t,r,o,a,i,k)=>t?Q(e,r,o,a,i,k):V(e,r),Z=(e,t,r)=>{const o=D(e).denneEllerNeste(),a=[];if(r!==void 0){const g={kontoType:r.konto,fom:D(o).trekkFra(15),tom:D(o).forrige()};a.push(g)}const i=l(o,t.dager),k={kontoType:t.konto,fom:i.fom,tom:i.tom};return a.push(k),{søker1:[...a].sort(P),søker2:[]}},$=(e,t,r,o,a,i,k,g)=>{const d=D(g??e).denneEllerNeste(),u=[];if(r!==!0)if(k){const f={kontoType:c.AktivitetsfriKvote,fom:l(d,o.dager).fom,tom:l(d,o.dager).tom};u.push(f)}else{let f=d;if(I(e)&&a&&!i&&o){const s={kontoType:c.AktivitetsfriKvote,fom:l(d,o.dager).fom,tom:l(d,o.dager).tom};u.push(s),f=D(s.tom).neste()}const m={kontoType:t.konto,fom:l(f,t.dager).fom,tom:l(f,t.dager).tom};u.push(m)}else if(i){const f={kontoType:c.Foreldrepenger,fom:l(d,t.dager).fom,tom:l(d,t.dager).tom};u.push(f)}else{const f={kontoType:c.AktivitetsfriKvote,fom:l(d,o.dager).fom,tom:l(d,o.dager).tom};u.push(f);const m={kontoType:c.Foreldrepenger,fom:l(D(f.tom).neste(),t.dager).fom,tom:l(D(f.tom).neste(),t.dager).tom};u.push(m)}return{søker1:[...u].sort(P),søker2:[]}},b=(e,t,r,o,a,i,k,g,d,u)=>t?$(e,r,a,i,k,g,d,u):Z(e,r,o),K=({situasjon:e,famDato:t,erFarEllerMedmor:r,tilgjengeligeStønadskontoer:o,erMorUfør:a,bareFarMedmorHarRett:i,erAleneOmOmsorg:k,startdato:g,farOgFar:d})=>{const u=o.find(s=>s.konto===c.Foreldrepenger),f=o.find(s=>s.konto===c.ForeldrepengerFørFødsel),m=o.find(s=>s.konto===c.AktivitetsfriKvote);return e==="adopsjon"?X(t,r,u,a,m,i,d):b(t,r,u,f,a,m,i,k,d,g)},le=e=>Object.values(e.kontoer).reduce((t,r)=>{const o=h(r.dager);return{uker:t.uker+o.uker,dager:t.dager+o.dager}},{uker:0,dager:0}),h=e=>{const t=Math.floor(e/5);return{uker:t,dager:e-t*5,totaltAntallDager:e}},_=(e,t)=>{const r=e.kontoer.find(o=>o.konto===t);return r?r.dager:0},w=(e,t)=>{const r=e.kontoer.find(o=>o.konto===t);return r?h(r.dager):{uker:0,dager:0,totaltAntallDager:0}},x=e=>_(e,c.ForeldrepengerFørFødsel),ee=e=>_(e,c.Mødrekvote),te=e=>_(e,c.Fedrekvote),ke=e=>w(e,c.AktivitetsfriKvote),M=e=>_(e,c.AktivitetsfriKvote),re=e=>w(e,c.Fellesperiode),R=e=>w(e,c.Foreldrepenger);n.extend(q);const oe=3,O=e=>n(e).isoWeekday(),L=e=>O(e)!==6&&O(e)!==7,U=e=>{const t=n(e).toDate(),r=e&&new Date(t.getFullYear(),t.getMonth(),t.getDate(),12);switch(O(e)){case 6:return n.utc(r).add(48,"hours").format(p);case 7:return n.utc(r).add(24,"hours").format(p);default:return e}},E=e=>{const t=n(e).toDate(),r=e&&new Date(t.getFullYear(),t.getMonth(),t.getDate(),12);switch(O(e)){case 6:return n.utc(r).subtract(24,"hours").format(p);case 7:return n.utc(r).subtract(48,"hours").format(p);default:return e}},se=(e,t)=>{if(L(e)===!1)throw new Error("trekkUttaksdagerFraDato: Dato må være uttaksdag");let r=e,o=0,a=0;for(;a<Math.abs(t);){const i=n.utc(e).add(--o*24,"hours").format(p);L(i)&&(r=i,a++)}return r},N=e=>A(e)?e.overtakelsesdato:z(e)?e.termindato:e.fødselsdato,W=e=>{if(A(e))throw new Error("Kan ikke være adoptert");const t=N(e);return C(e)&&e.termindato&&n(t).isBefore(n(Y(e.termindato)))?U(t):se(U(t),oe*5)},ae=(e,t,r,o=0)=>{const a=parseInt(o.toString(),10),i=re(t).totaltAntallDager,k=h(a),g=h(i-a),d=x(t),u=ee(t),f=te(t),m=N(r),s=A(r)||e.type===v.FAR_OG_FAR?U(U(m)):W(r),F=e.type===v.FAR_OG_FAR?y(n(s).toDate()).leggTil(u+k.totaltAntallDager-1):y(n(s).toDate()).leggTil(d+u+k.totaltAntallDager-1),G=U(n(F).add(1,"day").format(p)),B=y(n(G).toDate()).leggTil(g.totaltAntallDager+f-1);return e.type===v.FAR_OG_FAR&&!A(r)?{familiehendelsedato:m,startdatoPeriode1:s,sluttdatoPeriode1:n(B).format(p),startdatoPeriode2:void 0,sluttdatoPeriode2:void 0}:{familiehendelsedato:m,startdatoPeriode1:s,startdatoPeriode2:G,sluttdatoPeriode1:n(F).format(p),sluttdatoPeriode2:n(B).format(p)}},j=(e,t,r,o)=>{const a=N(r);if(e.type===v.FAR_OG_FAR){const f=M(t),m=R(t),s=y(n(E(a)).toDate()).leggTil(f+(A(r)?0:29)),F=A(r)?n(a):n(a).add(6,"weeks");return{familiehendelsedato:a,startdatoPeriode1:U(F.format(p)),sluttdatoPeriode1:E(n(s).format(p)),startdatoPeriode2:U(n(s).add(1,"day").format(p)),sluttdatoPeriode2:n(y(s).leggTil(m.totaltAntallDager)).format(p)}}if(o==="kunSøker2HarRett"&&(H(e)||S(e))){const f=M(t),m=R(t),s=y(n(E(a)).toDate()).leggTil(f+(A(r)?0:29)),F=A(r)?n(a):n(a).add(6,"weeks");return{familiehendelsedato:a,startdatoPeriode1:U(F.format(p)),sluttdatoPeriode1:n(s).format(p),startdatoPeriode2:U(n(s).add(1,"day").format(p)),sluttdatoPeriode2:n(y(s).leggTil(m.totaltAntallDager)).format(p)}}const i=R(t),k=M(t),g=x(t),d=A(r)||e.type===v.FAR?U(a):W(r),u=y(n(d).toDate()).leggTil(i.totaltAntallDager+k+g-1);return{familiehendelsedato:a,startdatoPeriode1:d,sluttdatoPeriode1:n(u).format(p),startdatoPeriode2:void 0,sluttdatoPeriode2:void 0}},ce=(e,t,r,o,a)=>t.type===v.FAR_OG_FAR&&!A(o)?j(t,r,o,e):e==="beggeHarRett"?ae(t,r,o,a):j(t,r,o,e),ue=e=>{const{kontoer:t}=e;return{uker:t.reduce((r,o)=>Math.round(o.dager/5)+r,0),dager:t.reduce((r,o,a)=>{const i=o.dager+r;return a===t.length-1?i%5:i},0)}},fe=({erDeltUttak:e,famDato:t,tilgjengeligeStønadskontoer:r,fellesperiodeDagerMor:o,erAdopsjon:a,erFarEllerMedmor:i,erMorUfør:k,bareFarMedmorHarRett:g,erAleneOmOmsorg:d,startdato:u,farOgFar:f})=>e?J({famDato:t,tilgjengeligeStønadskontoer:r,fellesperiodeDagerMor:o,startdato:u}):K({situasjon:a?"adopsjon":"fødsel",famDato:t,erFarEllerMedmor:i,tilgjengeligeStønadskontoer:r,erMorUfør:k,bareFarMedmorHarRett:g,erAleneOmOmsorg:d,startdato:u,farOgFar:f}),ge=(e,t,r)=>e?t.filter(o=>r?o.forelder===T.farMedmor:o.forelder===T.mor):t,me=(e,t,r)=>e?t.filter(o=>r?o.forelder===T.mor:o.forelder===T.farMedmor):[];export{ke as a,R as b,ue as c,re as d,h as e,ce as f,N as g,ge as h,me as i,le as j,E as k,fe as l};
