import{r as u,R as m}from"./index-BX3iQpgp.js";import{a as E,m as g}from"./VStack-D5W2V_Wo.js";const h=globalThis!=null&&globalThis.document?u.useLayoutEffect:()=>{};function f(s){return s.sort((e,t)=>{const n=e.compareDocumentPosition(t);if(n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(n&Node.DOCUMENT_POSITION_DISCONNECTED||n&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}const O=s=>typeof s=="object"&&"nodeType"in s&&s.nodeType===Node.ELEMENT_NODE;function x(s,e,t){let n=s+1;return t&&n>=e&&(n=0),n}function I(s,e,t){let n=s-1;return t&&n<0&&(n=e),n}const o=s=>s;class C{constructor(){this.descendants=new Map,this.register=e=>{if(e!=null)return O(e)?this.registerNode(e):t=>{this.registerNode(t,e)}},this.unregister=e=>{this.descendants.delete(e);const t=f(Array.from(this.descendants.keys()));this.assignIndex(t)},this.destroy=()=>{this.descendants.clear()},this.assignIndex=e=>{this.descendants.forEach(t=>{const n=e.indexOf(t.node);t.index=n,t.node.dataset.index=t.index.toString()})},this.count=()=>this.descendants.size,this.enabledCount=()=>this.enabledValues().length,this.values=()=>Array.from(this.descendants.values()).sort((t,n)=>t.index-n.index),this.enabledValues=()=>this.values().filter(e=>!e.disabled),this.item=e=>{if(this.count()!==0)return this.values()[e]},this.enabledItem=e=>{if(this.enabledCount()!==0)return this.enabledValues()[e]},this.first=()=>this.item(0),this.firstEnabled=()=>this.enabledItem(0),this.last=()=>this.item(this.descendants.size-1),this.lastEnabled=()=>{const e=this.enabledValues().length-1;return this.enabledItem(e)},this.indexOf=e=>{var t,n;return e&&(n=(t=this.descendants.get(e))===null||t===void 0?void 0:t.index)!==null&&n!==void 0?n:-1},this.enabledIndexOf=e=>e==null?-1:this.enabledValues().findIndex(t=>t.node.isSameNode(e)),this.next=(e,t=!0)=>{const n=x(e,this.count(),t);return this.item(n)},this.nextEnabled=(e,t=!0)=>{const n=this.item(e);if(!n)return;const i=this.enabledIndexOf(n.node),r=x(i,this.enabledCount(),t);return this.enabledItem(r)},this.prev=(e,t=!0)=>{const n=I(e,this.count()-1,t);return this.item(n)},this.prevEnabled=(e,t=!0)=>{const n=this.item(e);if(!n)return;const i=this.enabledIndexOf(n.node),r=I(i,this.enabledCount()-1,t);return this.enabledItem(r)},this.registerNode=(e,t)=>{if(!e)return;const n=this.descendants.get(e);if(n){this.descendants.set(e,Object.assign({index:n.index,node:e},t));return}const i=Array.from(this.descendants.keys()).concat(e),r=f(i);t!=null&&t.disabled&&(t.disabled=!!t.disabled);const d=Object.assign({node:e,index:-1},t);this.descendants.set(e,d),this.assignIndex(r)}}}function v(){const[s,e]=E({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"}),t=o(r=>m.createElement(s,Object.assign({},r.value),r.children));function n(r){const d=e(),[l,b]=u.useState(-1),a=u.useRef(null);h(()=>()=>{a.current&&d.unregister(a.current)},[]),h(()=>{if(!a.current)return;const c=Number(a.current.dataset.index);l!==c&&!Number.isNaN(c)&&b(c)});const N=o(r?d.register(r):d.register);return{descendants:d,index:l,enabledIndex:d.enabledIndexOf(a.current),register:g([N,a])}}function i(){return u.useRef(new C).current}return[t,e,i,n]}export{v as c,h as u};
