import{d}from"./dayjs.min-a42Le6oL.js";import{i as I}from"./isoWeek-tto3dG8J.js";import{S as w,c as T,d as B}from"./HvemPlanleggerUtils-CHTffTZd.js";import{I as s,t as N}from"./dateUtils-C_C2kvi-.js";import"./index-Dl6G-zuu.js";import{b as n,a as V,e as j}from"./barnetUtils-Dtg6gkcN.js";var f=(t=>(t.Mødrekvote="MØDREKVOTE",t.Fedrekvote="FEDREKVOTE",t.Fellesperiode="FELLESPERIODE",t.Foreldrepenger="FORELDREPENGER",t.ForeldrepengerFørFødsel="FORELDREPENGER_FØR_FØDSEL",t.AktivitetsfriKvote="AKTIVITETSFRI_KVOTE",t))(f||{});const b=t=>Object.values(t.kontoer).reduce((e,r)=>e+r.dager/5,0),A=(t,e)=>{const r=t.kontoer.find(o=>o.konto===e);return r?r.dager/5:0},M=t=>A(t,f.ForeldrepengerFørFødsel),W=t=>A(t,f.Mødrekvote),x=t=>A(t,f.Fedrekvote),H=t=>A(t,f.Fellesperiode),P=t=>A(t,f.Foreldrepenger),g=t=>A(t,f.AktivitetsfriKvote);d.extend(I);const Y=3,p=t=>d(t).isoWeekday(),y=t=>p(t)!==6&&p(t)!==7,k=t=>{switch(p(t)){case 6:return d.utc(t).add(48,"hours").format(s);case 7:return d.utc(t).add(24,"hours").format(s);default:return t}},c=t=>{const e=d(t).toDate(),r=t&&new Date(e.getFullYear(),e.getMonth(),e.getDate(),12);switch(p(t)){case 6:return d.utc(r).subtract(24,"hours").format(s);case 7:return d.utc(r).subtract(48,"hours").format(s);default:return t}},q=(t,e)=>{if(y(t)===!1)throw new Error("trekkUttaksdagerFraDato: Dato må være uttaksdag");let r=t,o=0,a=0;for(;a<Math.abs(e);){const i=d.utc(t).add(--o*24,"hours").format(s);y(i)&&(r=i,a++)}return r},_=t=>n(t)?t.overtakelsesdato:V(t)?t.termindato:t.fødselsdato,h=t=>{if(n(t))throw new Error("Kan ikke være adoptert");const e=_(t);return j(t)&&t.termindato&&d(e).isBefore(d(N(t.termindato)))?e:q(k(e),Y*5)},z=(t,e,r,o=0)=>{const i=H(e)-o,D=M(e),E=W(e),R=x(e),U=_(r),l=n(r)||t.type===w.FAR_OG_FAR?k(U):h(r),F=t.type===w.FAR_OG_FAR?c(d(l).add(E,"weeks").add(o,"weeks").subtract(1,"day").format(s)):c(d(l).add(D,"weeks").add(E,"weeks").add(o,"weeks").subtract(1,"day").format(s)),u=k(d(F).add(1,"day").format(s)),m=c(d(u).add(i,"weeks").add(R,"weeks").subtract(1,"day").format(s));return t.type===w.FAR_OG_FAR&&!n(r)?{familiehendelsedato:U,startdatoPeriode1:l,sluttdatoPeriode1:m,startdatoPeriode2:void 0,sluttdatoPeriode2:void 0}:{familiehendelsedato:U,startdatoPeriode1:l,startdatoPeriode2:u,sluttdatoPeriode1:F,sluttdatoPeriode2:m}},C=(t,e,r,o)=>{const a=_(r);if(t.type===w.FAR_OG_FAR){if(n(r)){const K=g(e),L=P(e),v=d(a).add(K,"weeks").add(n(r)?0:6,"weeks").subtract(1,"day"),G=n(r)?d(a).add(1,"day"):d(a).add(6,"weeks");return{familiehendelsedato:a,startdatoPeriode1:k(G.format(s)),sluttdatoPeriode1:c(v.format(s)),startdatoPeriode2:k(d(v).add(1,"day").format(s)),sluttdatoPeriode2:c(d(v).add(L,"weeks").format(s))}}const l=d(a).add(1,"day"),F=g(e),u=P(e),m=d(a).add(F,"weeks").subtract(1,"day");return{familiehendelsedato:a,startdatoPeriode1:k(l.format(s)),sluttdatoPeriode1:c(d(m).add(u,"weeks").format(s)),startdatoPeriode2:void 0,sluttdatoPeriode2:void 0}}if(o==="kunSøker2HarRett"&&(T(t)||B(t))){const l=g(e),F=P(e),u=d(a).add(l,"weeks").add(n(r)?0:6,"weeks").subtract(1,"day"),m=n(r)?d(a).add(1,"day"):d(a).add(6,"weeks");return{familiehendelsedato:a,startdatoPeriode1:k(m.format(s)),sluttdatoPeriode1:c(u.format(s)),startdatoPeriode2:k(d(u).add(1,"day").format(s)),sluttdatoPeriode2:c(d(u).add(F,"weeks").format(s))}}const i=P(e),D=g(e),E=M(e),R=n(r)||t.type===w.FAR?k(a):h(r),U=c(d(R).add(i,"weeks").add(D,"weeks").add(E,"weeks").subtract(1,"day").format(s));return{familiehendelsedato:a,startdatoPeriode1:R,sluttdatoPeriode1:U,startdatoPeriode2:void 0,sluttdatoPeriode2:void 0}},tt=(t,e,r,o,a)=>t==="beggeHarRett"?z(e,r,o,a):C(e,r,o,t),O=(t,e)=>{const r=d(t).toDate(),o=d(e).toDate(),a=7*24*60*60*1e3,i=Math.abs(r.getTime()-o.getTime());return Math.round(i/a)},et=t=>{const{startdatoPeriode1:e,sluttdatoPeriode1:r,startdatoPeriode2:o,sluttdatoPeriode2:a}=t;let i=O(r,e);return o&&a&&(i+=O(a,o)),i};export{f as S,g as a,P as b,et as c,H as d,b as e,tt as f,_ as g,M as h,O as w};
