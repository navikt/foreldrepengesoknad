import{j as t,c as J,f as H,F as m,u as Z,g as Q,a as W,h as ee,i as te,V as S,L as ne,S as ae,X as se,k as q,A as le,U as ie,P as re,e as oe}from"./dates-05f2e343.js";import{r as i}from"./_baseToString-0ec4c824.js";import"./_createSet-cf25111a.js";import"./tslib.es6-c380bd65.js";import"./index-9d475cdf.js";import"./_commonjsHelpers-de833af9.js";import"./index-05e4a7e3.js";import"./index-2ffc1685.js";import"./v4-a960c1f4.js";const R=({multiple:e,accept:n,onFilesSelect:s,hasUplodedAttachements:a})=>{const I=i.useCallback(r=>{if(r.target.files){const T=Array.from(r.target.files);s(T),r.target.value=""}},[s]),E=i.useRef(null),c=i.useCallback(()=>{E.current&&E.current.click()},[E.current]);return t.jsxs(t.Fragment,{children:[t.jsx("input",{ref:E,className:"fileInput",type:"file",accept:n,onChange:r=>I(r),multiple:e===!0,"data-testid":"file-upload"}),t.jsxs(J,{className:"upload_button",variant:a?"secondary":"primary",type:"button",onClick:c,icon:t.jsx(H,{}),iconPosition:"right",children:[a&&t.jsx(m,{id:"FileInput.Vedlegg.Lastoppknapp.Flere"}),!a&&t.jsx(m,{id:"FileInput.Vedlegg.Lastoppknapp"})]})]})};try{R.displayName="FileInput",R.__docgenInfo={description:"",displayName:"FileInput",props:{onFilesSelect:{defaultValue:null,description:"",name:"onFilesSelect",required:!0,type:{name:"(files: File[]) => void"}},multiple:{defaultValue:null,description:"",name:"multiple",required:!0,type:{name:"boolean"}},accept:{defaultValue:null,description:"",name:"accept",required:!0,type:{name:"string"}},hasUplodedAttachements:{defaultValue:null,description:"",name:"hasUplodedAttachements",required:!0,type:{name:"boolean"}}}}}catch{}const de=()=>{const e=Z();return{i18n:(n,s)=>e.formatMessage({id:n},s)}},u=()=>Math.floor((1+Math.random())*65536).toString().substring(1),ce=()=>`${u()}${u()}-${u()}-${u()}-${u()}-${u()}${u()}${u()}`,ue=e=>Q(e,{unitSeparator:" ",thousandsSeparator:" ",decimalPlaces:1,fixedDecimals:!1}),pe=()=>"V".concat(ce().replace(/-/g,"")),Ee=(e,n,s)=>({id:pe(),file:e,filename:e.name,filesize:e.size,uploaded:!1,pending:!1,type:n,skjemanummer:s});const L=({attachment:e,showFileSize:n,onDelete:s})=>{const{i18n:a}=de();return t.jsx("div",{className:"attachmentPanel",children:t.jsxs(W,{gap:"4",children:[e.pending&&t.jsx(ee,{type:"S"}),!e.pending&&t.jsx(te,{width:24,height:24}),t.jsxs(S,{gap:"1",children:[e.url?t.jsx(ne,{href:e.url,target:"_blank",children:e.filename}):t.jsx("span",{children:e.filename}),n&&t.jsx("div",{children:ue(e.filesize)})]}),s&&t.jsxs(t.Fragment,{children:[t.jsx(ae,{}),t.jsx(se,{onClick:()=>s(e),height:24,width:24,cursor:"pointer","aria-label":a("Attachment.Vedlegg.Slett",{navn:e.filename})})]})]})})};try{L.displayName="AttachmentInfo",L.__docgenInfo={description:"",displayName:"AttachmentInfo",props:{attachment:{defaultValue:null,description:"",name:"attachment",required:!0,type:{name:"Attachment"}},showFileSize:{defaultValue:null,description:"",name:"showFileSize",required:!1,type:{name:"boolean"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!1,type:{name:"((file: Attachment) => void)"}}}}}catch{}const N=e=>{const{attachments:n,showFileSize:s,onDelete:a}=e;return t.jsx(t.Fragment,{children:n.length>0&&t.jsx(S,{gap:"2",children:n.map(I=>t.jsx(i.Fragment,{children:t.jsx(L,{attachment:I,onDelete:a,showFileSize:s})},q()))})})};try{N.displayName="AttachmentList",N.__docgenInfo={description:"",displayName:"AttachmentList",props:{attachments:{defaultValue:null,description:"",name:"attachments",required:!0,type:{name:"Attachment[]"}},showFileSize:{defaultValue:null,description:"",name:"showFileSize",required:!1,type:{name:"boolean"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!1,type:{name:"((file: Attachment) => void)"}}}}}catch{}var d=(e=>(e.GENERAL="GENERAL",e.TIMEOUT="TIMEOUT",e.VALID_EXTENSION="VALID_EXTENSION",e.MAX_SIZE="MAX_SIZE",e))(d||{});const me=16777,O=({failedAttachment:e,onDelete:n})=>t.jsxs(le,{variant:"warning",closeButton:!0,onClose:()=>n(e),children:[e.error===d.GENERAL&&t.jsx(m,{id:"FailedAttachment.Vedlegg.Feilmelding.Opplasting.Feilet",values:{filename:e.filename}}),e.error===d.TIMEOUT&&t.jsx(m,{id:"FailedAttachment.Vedlegg.Feilmelding.Timeout",values:{filename:e.filename}}),e.error===d.MAX_SIZE&&t.jsx(m,{id:"FailedAttachment.Vedlegg.Feilmelding.Ugyldig.Størrelse",values:{filename:e.filename,maxStørrelse:me}}),e.error===d.VALID_EXTENSION&&t.jsx(m,{id:"FailedAttachment.Vedlegg.Feilmelding.Ugyldig.Type",values:{filename:e.filename}})]});try{O.displayName="FailedAttachment",O.__docgenInfo={description:"",displayName:"FailedAttachment",props:{failedAttachment:{defaultValue:null,description:"",name:"failedAttachment",required:!0,type:{name:"Attachment"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"(file: Attachment) => void"}}}}}catch{}const F=e=>{const{failedAttachments:n,onDelete:s}=e;return t.jsx(t.Fragment,{children:n.length>0&&t.jsx(S,{gap:"2",children:n.map(a=>t.jsx(i.Fragment,{children:t.jsx(O,{failedAttachment:a,onDelete:s})},q()))})})};try{F.displayName="FailedAttachmentList",F.__docgenInfo={description:"",displayName:"FailedAttachmentList",props:{failedAttachments:{defaultValue:null,description:"",name:"failedAttachments",required:!0,type:{name:"Attachment[]"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"(file: Attachment) => void"}}}}}catch{}const w=[".pdf",".jpeg",".jpg",".png"],Ie=16777,Ae=.0009765625,ge=(e,n,s)=>{const a=Ee(e,n,s);return a.pending=!0,a},_e=e=>{const n=e.split(".").pop();return w.includes(`.${n.toLowerCase()}`)},fe=e=>e*Ae<=Ie,he=async(e,n)=>{var s;if(!_e(e.file.name)){e.pending=!1,e.error=d.VALID_EXTENSION;return}if(!fe(e.filesize)){e.pending=!1,e.error=d.MAX_SIZE;return}try{const a=await n(e);e.pending=!1,e.url=a.headers.location,e.uploaded=!0,e.uuid=a.data}catch(a){e.pending=!1,((s=a==null?void 0:a.response)==null?void 0:s.status)===408?e.error=d.TIMEOUT:e.error=d.GENERAL}},Se=[],V=({existingAttachments:e=Se,updateAttachments:n,attachmentType:s,skjemanummer:a,saveAttachment:I,multiple:E=!0})=>{const[c,r]=i.useState(e);i.useEffect(()=>{n(c.filter(l=>!l.error&&l.pending===!1))},[c]);const T=async l=>{for(const o of l)await he(o,I),r(p=>p.map(v=>v.filename===o.filename?o:v))},X=i.useCallback(l=>{const o=l.map(p=>ge(p,s,a));r(p=>p.filter($=>!o.some(Y=>Y.filename===$.filename)).concat(o)),T(o)},[]),x=i.useCallback(l=>{r(o=>o.filter(p=>p.filename!==l.filename))},[]),K=i.useMemo(()=>c.filter(l=>!l.error),[c]),C=i.useMemo(()=>c.filter(l=>!!l.error),[c]);return t.jsx(ie,{children:t.jsxs(S,{gap:"6",children:[t.jsx(N,{attachments:K,showFileSize:!0,onDelete:x}),t.jsx(R,{accept:w.join(", "),onFilesSelect:X,hasUplodedAttachements:K.length>0,multiple:E}),t.jsx(F,{failedAttachments:C,onDelete:x})]})})},z=V;try{V.displayName="FileUploader",V.__docgenInfo={description:"",displayName:"FileUploader",props:{updateAttachments:{defaultValue:null,description:"",name:"updateAttachments",required:!0,type:{name:"(attachments: Attachment[]) => void"}},attachmentType:{defaultValue:null,description:"",name:"attachmentType",required:!0,type:{name:"enum",value:[{value:'"omsorgsovertakelse"'},{value:'"adopsjonsvedtak"'},{value:'"terminbekreftelse"'},{value:'"fødselsattest"'},{value:'"anneninntektDokumentasjon"'},{value:'"utsettelseSykdomUttaksplan"'},{value:'"morsaktivitetdokumentasjon"'},{value:'"dokumentasjonOverføringAvKvote"'},{value:'"dokumentasjonAvAleneomsorg"'},{value:'"senEndring"'},{value:'"hvØvelse"'},{value:'"navTiltak"'},{value:'"tilbakebetaling"'}]}},skjemanummer:{defaultValue:null,description:"",name:"skjemanummer",required:!0,type:{name:"enum",value:[{value:'"I000060"'},{value:'"I000062"'},{value:'"I000042"'},{value:'"I000051"'},{value:'"I000065"'},{value:'"I000061"'},{value:'"I000036"'},{value:'"I000110"'},{value:'"I000111"'},{value:'"I000112"'},{value:'"I000037"'},{value:'"I000039"'},{value:'"I000038"'},{value:'"I000023"'},{value:'"I000044"'},{value:'"I000063"'},{value:'"I000007"'},{value:'"I000109"'},{value:'"I000114"'},{value:'"I000049"'},{value:'"I000001"'},{value:'"I000116"'},{value:'"I000117"'},{value:'"I000032"'},{value:'"I000066"'}]}},existingAttachments:{defaultValue:{value:"[] as Attachment[]"},description:"",name:"existingAttachments",required:!1,type:{name:"Attachment[]"}},saveAttachment:{defaultValue:null,description:"",name:"saveAttachment",required:!0,type:{name:"SaveAttachment"}},multiple:{defaultValue:{value:"true"},description:"",name:"multiple",required:!1,type:{name:"boolean"}}}}}catch{}var f=(e=>(e.ANNET="I000060",e.TERMINBEKREFTELSE="I000062",e.OMSORGSOVERTAKELSE="I000042",e.BEKREFTELSE_DELTAR_KVALIFISERINGSPROGRAM="I000051",e.BEKREFTELSE_FRA_ARBEIDSGIVER="I000065",e.BEKREFTELSE_FRA_STUDIESTED="I000061",e.BEKREFTELSE_PÅ_AVTALT_FERIE="I000036",e.DOK_AV_ALENEOMSORG="I000110",e.DOK_BEGRUNNELSE_SØKE_TILBAKE_I_TID="I000111",e.DOK_DELTAKELSE_I_INTRODUKSJONSPROGRAMMET="I000112",e.DOK_INNLEGGELSE="I000037",e.DOK_MILITÆR_SILVIL_TJENESTE="I000039",e.DOK_MORS_UTDANNING_ARBEID_SYKDOM="I000038",e.DOK_OVERFØRING_FOR_SYK="I000023",e.ETTERLØNN_ELLER_SLUTTVEDERLAG="I000044",e.FØDSELSATTEST="I000063",e.INNTEKTSOPPLYSNINGER_FRILANS_ELLER_SELVSTENDIG="I000007",e.SKJEMA_FOR_TILRETTELEGGING_OG_OMPLASSERING="I000109",e.TILBAKEBETALING="I000114",e.TILRETTELEGGING_FOR_ARBEIDSTAKERE="I000049",e.TILRETTELEGGING_FOR_FRILANS_ELLER_SELVSTENDIG="I000001",e.HV_ØVELSE="I000116",e.NAV_TILTAK="I000117",e.RESULTATREGNSKAP="I000032",e.KOPI_SKATTEMELDING="I000066",e))(f||{}),h=(e=>(e.OMSORGSOVERTAKELSE="omsorgsovertakelse",e.ADOPSJONSVEDTAK="adopsjonsvedtak",e.TERMINBEKREFTELSE="terminbekreftelse",e.FØDSELSATTEST="fødselsattest",e.ANNEN_INNTEKT="anneninntektDokumentasjon",e.UTSETTELSE_SYKDOM="utsettelseSykdomUttaksplan",e.MORS_AKTIVITET_DOKUMENTASJON="morsaktivitetdokumentasjon",e.OVERFØRING_KVOTE="dokumentasjonOverføringAvKvote",e.ALENEOMSORG="dokumentasjonAvAleneomsorg",e.SEN_ENDRING="senEndring",e.HV_ØVELSE="hvØvelse",e.NAV_TILTAK="navTiltak",e.TILBAKEBETALING="tilbakebetaling",e))(h||{});const xe={title:"FileUploader",component:z},y=({saveAttachment:e,existingAttachments:n})=>t.jsx(re,{value:oe({locale:"nb",messages:{}}),children:t.jsx(z,{attachmentType:h.OMSORGSOVERTAKELSE,skjemanummer:f.OMSORGSOVERTAKELSE,saveAttachment:e,existingAttachments:n,updateAttachments:()=>{}})}),A=y.bind({});A.args={existingAttachments:[{id:"1",filename:"Dette er en fil som er lastet opp.jpg",filesize:234,file:{},pending:!1,uploaded:!0,type:h.TERMINBEKREFTELSE,skjemanummer:f.TERMINBEKREFTELSE},{id:"2",filename:"Dette er en fil som holder på å bli lastet opp.jpg",filesize:2344,file:{},pending:!0,uploaded:!1,type:h.TERMINBEKREFTELSE,skjemanummer:f.TERMINBEKREFTELSE}]};const g=y.bind({});g.args={saveAttachment:()=>Promise.resolve({headers:{location:""},data:"test"})};const _=y.bind({});var D,M,G;A.parameters={...A.parameters,docs:{...(D=A.parameters)==null?void 0:D.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <RawIntlProvider value={createIntl({
    locale: 'nb',
    messages: {}
  })}>
            <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />
        </RawIntlProvider>;
}`,...(G=(M=A.parameters)==null?void 0:M.docs)==null?void 0:G.source}}};var j,k,b;g.parameters={...g.parameters,docs:{...(j=g.parameters)==null?void 0:j.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <RawIntlProvider value={createIntl({
    locale: 'nb',
    messages: {}
  })}>
            <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />
        </RawIntlProvider>;
}`,...(b=(k=g.parameters)==null?void 0:k.docs)==null?void 0:b.source}}};var B,U,P;_.parameters={..._.parameters,docs:{...(B=_.parameters)==null?void 0:B.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <RawIntlProvider value={createIntl({
    locale: 'nb',
    messages: {}
  })}>
            <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />
        </RawIntlProvider>;
}`,...(P=(U=_.parameters)==null?void 0:U.docs)==null?void 0:P.source}}};const Ke=["VisEksisterendeVedlegg","OpplastingOk","OpplastingFeiler"];export{_ as OpplastingFeiler,g as OpplastingOk,A as VisEksisterendeVedlegg,Ke as __namedExportsOrder,xe as default};
//# sourceMappingURL=FileUploader.stories-6dc96af0.js.map
