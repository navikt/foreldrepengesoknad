import{j as t,u as J}from"./index-c6d741e6.js";import{r as l}from"./index-61bf1805.js";import{b as H,e as Z,F as p,f as Q,a as W,g as ee,h as te,V as v,L as ne,S as ae,X as se,i as X,A as le,U as ie}from"./UiIntlProvider-1a3d0d10.js";import"./_baseToString-e22f1573.js";import"./_createSet-96a73193.js";import"./tslib.es6-5c05e4ef.js";import"./core-60498980.js";import"./_commonjsHelpers-de833af9.js";import"./index-9d475cdf.js";import"./index-a4278c14.js";import"./index-2801d3c9.js";import"./v4-a960c1f4.js";var T=(e=>(e.ANNET="I000060",e.TERMINBEKREFTELSE="I000062",e.OMSORGSOVERTAKELSE="I000042",e.BEKREFTELSE_DELTAR_KVALIFISERINGSPROGRAM="I000051",e.BEKREFTELSE_FRA_ARBEIDSGIVER="I000065",e.BEKREFTELSE_FRA_STUDIESTED="I000061",e.BEKREFTELSE_PÅ_AVTALT_FERIE="I000036",e.DOK_AV_ALENEOMSORG="I000110",e.DOK_BEGRUNNELSE_SØKE_TILBAKE_I_TID="I000111",e.DOK_DELTAKELSE_I_INTRODUKSJONSPROGRAMMET="I000112",e.DOK_INNLEGGELSE="I000037",e.DOK_MILITÆR_SILVIL_TJENESTE="I000039",e.DOK_MORS_UTDANNING_ARBEID_SYKDOM="I000038",e.DOK_OVERFØRING_FOR_SYK="I000023",e.ETTERLØNN_ELLER_SLUTTVEDERLAG="I000044",e.FØDSELSATTEST="I000063",e.INNTEKTSOPPLYSNINGER_FRILANS_ELLER_SELVSTENDIG="I000007",e.SKJEMA_FOR_TILRETTELEGGING_OG_OMPLASSERING="I000109",e.TILBAKEBETALING="I000114",e.TILRETTELEGGING_FOR_ARBEIDSTAKERE="I000049",e.TILRETTELEGGING_FOR_FRILANS_ELLER_SELVSTENDIG="I000001",e.HV_ØVELSE="I000116",e.NAV_TILTAK="I000117",e.RESULTATREGNSKAP="I000032",e.KOPI_SKATTEMELDING="I000066",e))(T||{}),h=(e=>(e.OMSORGSOVERTAKELSE="omsorgsovertakelse",e.ADOPSJONSVEDTAK="adopsjonsvedtak",e.TERMINBEKREFTELSE="terminbekreftelse",e.FØDSELSATTEST="fødselsattest",e.ANNEN_INNTEKT="anneninntektDokumentasjon",e.UTSETTELSE_SYKDOM="utsettelseSykdomUttaksplan",e.MORS_AKTIVITET_DOKUMENTASJON="morsaktivitetdokumentasjon",e.OVERFØRING_KVOTE="dokumentasjonOverføringAvKvote",e.ALENEOMSORG="dokumentasjonAvAleneomsorg",e.SEN_ENDRING="senEndring",e.HV_ØVELSE="hvØvelse",e.NAV_TILTAK="navTiltak",e.TILBAKEBETALING="tilbakebetaling",e))(h||{});const O=({multiple:e,accept:n,onFilesSelect:s,hasUplodedAttachements:a})=>{const u=l.useCallback(r=>{if(r.target.files){const L=Array.from(r.target.files);s(L),r.target.value=""}},[s]),E=l.useRef(null),d=l.useCallback(()=>{E.current&&E.current.click()},[]);return t.jsxs(t.Fragment,{children:[t.jsx("input",{ref:E,className:"fileInput",type:"file",accept:n,onChange:r=>u(r),multiple:e===!0,"data-testid":"file-upload"}),t.jsxs(H,{className:"upload_button",variant:a?"secondary":"primary",type:"button",onClick:d,icon:t.jsx(Z,{}),iconPosition:"right",children:[a&&t.jsx(p,{id:"FileInput.Vedlegg.Lastoppknapp.Flere"}),!a&&t.jsx(p,{id:"FileInput.Vedlegg.Lastoppknapp"})]})]})};try{O.displayName="FileInput",O.__docgenInfo={description:"",displayName:"FileInput",props:{onFilesSelect:{defaultValue:null,description:"",name:"onFilesSelect",required:!0,type:{name:"(files: File[]) => void"}},multiple:{defaultValue:null,description:"",name:"multiple",required:!0,type:{name:"boolean"}},accept:{defaultValue:null,description:"",name:"accept",required:!0,type:{name:"string"}},hasUplodedAttachements:{defaultValue:null,description:"",name:"hasUplodedAttachements",required:!0,type:{name:"boolean"}}}}}catch{}const re=()=>{const e=J();return{i18n:(n,s)=>e.formatMessage({id:n},s)}},c=()=>Math.floor((1+Math.random())*65536).toString().substring(1),oe=()=>`${c()}${c()}-${c()}-${c()}-${c()}-${c()}${c()}${c()}`,de=e=>Q(e,{unitSeparator:" ",thousandsSeparator:" ",decimalPlaces:1,fixedDecimals:!1}),ce=()=>"V".concat(oe().replace(/-/g,"")),ue=(e,n,s)=>({id:ce(),file:e,filename:e.name,filesize:e.size,uploaded:!1,pending:!1,type:n,skjemanummer:s});const F=({attachment:e,showFileSize:n,onDelete:s})=>{const{i18n:a}=re();return t.jsx("div",{className:"attachmentPanel",children:t.jsxs(W,{gap:"4",children:[e.pending&&t.jsx(ee,{type:"S"}),!e.pending&&t.jsx(te,{width:24,height:24}),t.jsxs(v,{gap:"1",children:[e.url?t.jsx(ne,{href:e.url,target:"_blank",children:e.filename}):t.jsx("span",{children:e.filename}),n&&t.jsx("div",{children:de(e.filesize)})]}),s&&t.jsxs(t.Fragment,{children:[t.jsx(ae,{}),t.jsx(se,{onClick:()=>s(e),height:24,width:24,cursor:"pointer","aria-label":a("Attachment.Vedlegg.Slett",{navn:e.filename})})]})]})})};try{F.displayName="AttachmentInfo",F.__docgenInfo={description:"",displayName:"AttachmentInfo",props:{attachment:{defaultValue:null,description:"",name:"attachment",required:!0,type:{name:"Attachment"}},showFileSize:{defaultValue:null,description:"",name:"showFileSize",required:!1,type:{name:"boolean"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!1,type:{name:"((file: Attachment) => void)"}}}}}catch{}const V=e=>{const{attachments:n,showFileSize:s,onDelete:a}=e;return t.jsx(t.Fragment,{children:n.length>0&&t.jsx(v,{gap:"2",children:n.map(u=>t.jsx(l.Fragment,{children:t.jsx(F,{attachment:u,onDelete:a,showFileSize:s})},X()))})})};try{V.displayName="AttachmentList",V.__docgenInfo={description:"",displayName:"AttachmentList",props:{attachments:{defaultValue:null,description:"",name:"attachments",required:!0,type:{name:"Attachment[]"}},showFileSize:{defaultValue:null,description:"",name:"showFileSize",required:!1,type:{name:"boolean"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!1,type:{name:"((file: Attachment) => void)"}}}}}catch{}var o=(e=>(e.GENERAL="GENERAL",e.TIMEOUT="TIMEOUT",e.VALID_EXTENSION="VALID_EXTENSION",e.MAX_SIZE="MAX_SIZE",e))(o||{});const pe=16777,y=({failedAttachment:e,onDelete:n})=>t.jsxs(le,{variant:"warning",closeButton:!0,onClose:()=>n(e),children:[e.error===o.GENERAL&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Opplasting.Feilet",values:{filename:e.filename}}),e.error===o.TIMEOUT&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Timeout",values:{filename:e.filename}}),e.error===o.MAX_SIZE&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Ugyldig.Størrelse",values:{filename:e.filename,maxStørrelse:pe}}),e.error===o.VALID_EXTENSION&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Ugyldig.Type",values:{filename:e.filename}})]});try{y.displayName="FailedAttachment",y.__docgenInfo={description:"",displayName:"FailedAttachment",props:{failedAttachment:{defaultValue:null,description:"",name:"failedAttachment",required:!0,type:{name:"Attachment"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"(file: Attachment) => void"}}}}}catch{}const x=e=>{const{failedAttachments:n,onDelete:s}=e;return t.jsx(t.Fragment,{children:n.length>0&&t.jsx(v,{gap:"2",children:n.map(a=>t.jsx(l.Fragment,{children:t.jsx(y,{failedAttachment:a,onDelete:s})},X()))})})};try{x.displayName="FailedAttachmentList",x.__docgenInfo={description:"",displayName:"FailedAttachmentList",props:{failedAttachments:{defaultValue:null,description:"",name:"failedAttachments",required:!0,type:{name:"Attachment[]"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"(file: Attachment) => void"}}}}}catch{}const C=[".pdf",".jpeg",".jpg",".png"],Ee=16777,me=.0009765625,Ie=(e,n,s)=>{const a=ue(e,n,s);return a.pending=!0,a},Ae=e=>{const n=e.split(".").pop();return n?C.includes(`.${n.toLowerCase()}`):!1},_e=e=>e*me<=Ee,fe=async(e,n)=>{var s;if(!Ae(e.file.name)){e.pending=!1,e.error=o.VALID_EXTENSION;return}if(!_e(e.filesize)){e.pending=!1,e.error=o.MAX_SIZE;return}try{const a=await n(e);e.pending=!1,e.url=a.headers.location,e.uploaded=!0,e.uuid=a.data}catch(a){e.pending=!1,((s=a==null?void 0:a.response)==null?void 0:s.status)===408?e.error=o.TIMEOUT:e.error=o.GENERAL}},ge=[],K=({existingAttachments:e=ge,updateAttachments:n,attachmentType:s,skjemanummer:a,saveAttachment:u,multiple:E=!0})=>{const[d,r]=l.useState(e);l.useEffect(()=>{n(d.filter(i=>!i.error&&i.pending===!1))},[d,n]);const L=l.useCallback(i=>{const R=async I=>{for(const f of I)await fe(f,u),r(N=>N.map(g=>g.filename===f.filename?f:g))},m=i.map(I=>Ie(I,s,a));r(I=>I.filter(N=>!m.some(g=>g.filename===N.filename)).concat(m)),R(m)},[s,a,u]),M=l.useCallback(i=>{r(R=>R.filter(m=>m.filename!==i.filename))},[]),G=l.useMemo(()=>d.filter(i=>!i.error),[d]),Y=l.useMemo(()=>d.filter(i=>!!i.error),[d]);return t.jsx(ie,{children:t.jsxs(v,{gap:"6",children:[t.jsx(V,{attachments:G,showFileSize:!0,onDelete:M}),t.jsx(O,{accept:C.join(", "),onFilesSelect:L,hasUplodedAttachements:G.length>0,multiple:E}),t.jsx(x,{failedAttachments:Y,onDelete:M})]})})},$=K;try{K.displayName="FileUploader",K.__docgenInfo={description:"",displayName:"FileUploader",props:{updateAttachments:{defaultValue:null,description:"",name:"updateAttachments",required:!0,type:{name:"(attachments: Attachment[]) => void"}},attachmentType:{defaultValue:null,description:"",name:"attachmentType",required:!0,type:{name:"enum",value:[{value:'"omsorgsovertakelse"'},{value:'"adopsjonsvedtak"'},{value:'"terminbekreftelse"'},{value:'"fødselsattest"'},{value:'"anneninntektDokumentasjon"'},{value:'"utsettelseSykdomUttaksplan"'},{value:'"morsaktivitetdokumentasjon"'},{value:'"dokumentasjonOverføringAvKvote"'},{value:'"dokumentasjonAvAleneomsorg"'},{value:'"senEndring"'},{value:'"hvØvelse"'},{value:'"navTiltak"'},{value:'"tilbakebetaling"'}]}},skjemanummer:{defaultValue:null,description:"",name:"skjemanummer",required:!0,type:{name:"enum",value:[{value:'"I000060"'},{value:'"I000062"'},{value:'"I000042"'},{value:'"I000051"'},{value:'"I000065"'},{value:'"I000061"'},{value:'"I000036"'},{value:'"I000110"'},{value:'"I000111"'},{value:'"I000112"'},{value:'"I000037"'},{value:'"I000039"'},{value:'"I000038"'},{value:'"I000023"'},{value:'"I000044"'},{value:'"I000063"'},{value:'"I000007"'},{value:'"I000109"'},{value:'"I000114"'},{value:'"I000049"'},{value:'"I000001"'},{value:'"I000116"'},{value:'"I000117"'},{value:'"I000032"'},{value:'"I000066"'}]}},existingAttachments:{defaultValue:{value:"[] as Attachment[]"},description:"",name:"existingAttachments",required:!1,type:{name:"Attachment[]"}},saveAttachment:{defaultValue:null,description:"",name:"saveAttachment",required:!0,type:{name:"SaveAttachment"}},multiple:{defaultValue:{value:"true"},description:"",name:"multiple",required:!1,type:{name:"boolean"}}}}}catch{}const Ke={title:"FileUploader",component:$},D=({saveAttachment:e,existingAttachments:n})=>t.jsx($,{attachmentType:h.OMSORGSOVERTAKELSE,skjemanummer:T.OMSORGSOVERTAKELSE,saveAttachment:e,existingAttachments:n,updateAttachments:()=>{}}),A=D.bind({});A.args={existingAttachments:[{id:"1",filename:"Dette er en fil som er lastet opp.jpg",filesize:234,file:{},pending:!1,uploaded:!0,type:h.TERMINBEKREFTELSE,skjemanummer:T.TERMINBEKREFTELSE},{id:"2",filename:"Dette er en fil som holder på å bli lastet opp.jpg",filesize:2344,file:{},pending:!0,uploaded:!1,type:h.TERMINBEKREFTELSE,skjemanummer:T.TERMINBEKREFTELSE}]};const _=D.bind({});_.args={saveAttachment:()=>Promise.resolve({headers:{location:""},data:"test"})};const S=D.bind({});var j,k,b;A.parameters={...A.parameters,docs:{...(j=A.parameters)==null?void 0:j.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />;
}`,...(b=(k=A.parameters)==null?void 0:k.docs)==null?void 0:b.source}}};var B,U,q;_.parameters={..._.parameters,docs:{...(B=_.parameters)==null?void 0:B.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />;
}`,...(q=(U=_.parameters)==null?void 0:U.docs)==null?void 0:q.source}}};var P,z,w;S.parameters={...S.parameters,docs:{...(P=S.parameters)==null?void 0:P.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />;
}`,...(w=(z=S.parameters)==null?void 0:z.docs)==null?void 0:w.source}}};const De=["VisEksisterendeVedlegg","OpplastingOk","OpplastingFeiler"];export{S as OpplastingFeiler,_ as OpplastingOk,A as VisEksisterendeVedlegg,De as __namedExportsOrder,Ke as default};
//# sourceMappingURL=FileUploader.stories-89b62e74.js.map
