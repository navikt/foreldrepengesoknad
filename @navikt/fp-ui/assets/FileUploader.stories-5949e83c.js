import{j as t}from"./jsx-runtime-4ca860c5.js";import{r as l}from"./index-61bf1805.js";import{u as J}from"./index-5e19d261.js";import{b as H,U as Z,c as Q,d as W,a as ee,e as te,F as ne,S as ae,X as se,g as X,A as le}from"./fridagerUtils-d3616702.js";import{F as p,V as L,L as ie,U as re}from"./UiIntlProvider-2204afe1.js";import"./_baseToString-42dba5cf.js";import"./_createSet-13baae69.js";import"./_commonjsHelpers-de833af9.js";import"./tslib.es6-74570fde.js";import"./index-9d475cdf.js";import"./index-2801d3c9.js";import"./v4-a960c1f4.js";var T=(e=>(e.ANNET="I000060",e.TERMINBEKREFTELSE="I000062",e.OMSORGSOVERTAKELSE="I000042",e.BEKREFTELSE_DELTAR_KVALIFISERINGSPROGRAM="I000051",e.BEKREFTELSE_FRA_ARBEIDSGIVER="I000065",e.BEKREFTELSE_FRA_STUDIESTED="I000061",e.BEKREFTELSE_PÅ_AVTALT_FERIE="I000036",e.DOK_AV_ALENEOMSORG="I000110",e.DOK_BEGRUNNELSE_SØKE_TILBAKE_I_TID="I000111",e.DOK_DELTAKELSE_I_INTRODUKSJONSPROGRAMMET="I000112",e.DOK_INNLEGGELSE="I000037",e.DOK_MILITÆR_SILVIL_TJENESTE="I000039",e.DOK_MORS_UTDANNING_ARBEID_SYKDOM="I000038",e.DOK_OVERFØRING_FOR_SYK="I000023",e.ETTERLØNN_ELLER_SLUTTVEDERLAG="I000044",e.FØDSELSATTEST="I000063",e.INNTEKTSOPPLYSNINGER_FRILANS_ELLER_SELVSTENDIG="I000007",e.SKJEMA_FOR_TILRETTELEGGING_OG_OMPLASSERING="I000109",e.TILBAKEBETALING="I000114",e.HV_ØVELSE="I000116",e.NAV_TILTAK="I000117",e.RESULTATREGNSKAP="I000032",e.KOPI_SKATTEMELDING="I000066",e))(T||{}),v=(e=>(e.OMSORGSOVERTAKELSE="omsorgsovertakelse",e.ADOPSJONSVEDTAK="adopsjonsvedtak",e.TERMINBEKREFTELSE="terminbekreftelse",e.FØDSELSATTEST="fødselsattest",e.ANNEN_INNTEKT="anneninntektDokumentasjon",e.UTSETTELSE_SYKDOM="utsettelseSykdomUttaksplan",e.MORS_AKTIVITET_DOKUMENTASJON="morsaktivitetdokumentasjon",e.OVERFØRING_KVOTE="dokumentasjonOverføringAvKvote",e.ALENEOMSORG="dokumentasjonAvAleneomsorg",e.SEN_ENDRING="senEndring",e.HV_ØVELSE="hvØvelse",e.NAV_TILTAK="navTiltak",e.TILBAKEBETALING="tilbakebetaling",e))(v||{});const F=({multiple:e,accept:n,onFilesSelect:a,hasUplodedAttachements:s})=>{const i=Q("fileInput"),O=l.useCallback(u=>{if(u.target.files){const g=Array.from(u.target.files);a(g),u.target.value=""}},[a]),r=l.useRef(null),E=l.useCallback(()=>{r.current&&r.current.click()},[]);return t.jsxs(t.Fragment,{children:[t.jsx("input",{ref:r,className:i.element("input"),type:"file",accept:n,onChange:u=>O(u),multiple:e===!0,"data-testid":"file-upload"}),t.jsxs(H,{className:i.element("upload_button"),variant:s?"secondary":"primary",type:"button",onClick:E,icon:t.jsx(Z,{}),iconPosition:"right",children:[s&&t.jsx(p,{id:"FileInput.Vedlegg.Lastoppknapp.Flere"}),!s&&t.jsx(p,{id:"FileInput.Vedlegg.Lastoppknapp"})]})]})};try{F.displayName="FileInput",F.__docgenInfo={description:"",displayName:"FileInput",props:{onFilesSelect:{defaultValue:null,description:"",name:"onFilesSelect",required:!0,type:{name:"(files: File[]) => void"}},multiple:{defaultValue:null,description:"",name:"multiple",required:!0,type:{name:"boolean"}},accept:{defaultValue:null,description:"",name:"accept",required:!0,type:{name:"string"}},hasUplodedAttachements:{defaultValue:null,description:"",name:"hasUplodedAttachements",required:!0,type:{name:"boolean"}}}}}catch{}const oe=()=>{const e=J();return{i18n:(n,a)=>e.formatMessage({id:n},a)}},c=()=>Math.floor((1+Math.random())*65536).toString().substring(1),de=()=>`${c()}${c()}-${c()}-${c()}-${c()}-${c()}${c()}${c()}`,ce=e=>W(e,{unitSeparator:" ",thousandsSeparator:" ",decimalPlaces:1,fixedDecimals:!1}),ue=()=>"V".concat(de().replace(/-/g,"")),pe=(e,n,a)=>({id:ue(),file:e,filename:e.name,filesize:e.size,uploaded:!1,pending:!1,type:n,skjemanummer:a});const V=({attachment:e,showFileSize:n,onDelete:a})=>{const{i18n:s}=oe();return t.jsx("div",{className:"attachmentPanel",children:t.jsxs(ee,{gap:"4",children:[e.pending&&t.jsx(te,{type:"S"}),!e.pending&&t.jsx(ne,{width:24,height:24}),t.jsxs(L,{gap:"1",children:[e.url?t.jsx(ie,{href:e.url,target:"_blank",children:e.filename}):t.jsx("span",{children:e.filename}),n&&t.jsx("div",{children:ce(e.filesize)})]}),a&&t.jsxs(t.Fragment,{children:[t.jsx(ae,{}),t.jsx(se,{tabIndex:0,onClick:()=>a(e),onKeyDown:i=>{(i.code==="Space"||i.code==="Enter")&&a(e)},height:24,width:24,cursor:"pointer","aria-label":s("Attachment.Vedlegg.Slett",{navn:e.filename})})]})]})})};try{V.displayName="AttachmentInfo",V.__docgenInfo={description:"",displayName:"AttachmentInfo",props:{attachment:{defaultValue:null,description:"",name:"attachment",required:!0,type:{name:"Attachment"}},showFileSize:{defaultValue:null,description:"",name:"showFileSize",required:!1,type:{name:"boolean"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!1,type:{name:"((file: Attachment) => void)"}}}}}catch{}const y=e=>{const{attachments:n,showFileSize:a,onDelete:s}=e;return t.jsx(t.Fragment,{children:n.length>0&&t.jsx(L,{gap:"2",children:n.map(i=>t.jsx(l.Fragment,{children:t.jsx(V,{attachment:i,onDelete:s,showFileSize:a})},X()))})})};try{y.displayName="AttachmentList",y.__docgenInfo={description:"",displayName:"AttachmentList",props:{attachments:{defaultValue:null,description:"",name:"attachments",required:!0,type:{name:"Attachment[]"}},showFileSize:{defaultValue:null,description:"",name:"showFileSize",required:!1,type:{name:"boolean"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!1,type:{name:"((file: Attachment) => void)"}}}}}catch{}var d=(e=>(e.GENERAL="GENERAL",e.TIMEOUT="TIMEOUT",e.VALID_EXTENSION="VALID_EXTENSION",e.MAX_SIZE="MAX_SIZE",e))(d||{});const Ee=16777,x=({failedAttachment:e,onDelete:n})=>t.jsxs(le,{variant:"warning",closeButton:!0,onClose:()=>n(e),children:[e.error===d.GENERAL&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Opplasting.Feilet",values:{filename:e.filename}}),e.error===d.TIMEOUT&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Timeout",values:{filename:e.filename}}),e.error===d.MAX_SIZE&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Ugyldig.Størrelse",values:{filename:e.filename,maxStørrelse:Ee}}),e.error===d.VALID_EXTENSION&&t.jsx(p,{id:"FailedAttachment.Vedlegg.Feilmelding.Ugyldig.Type",values:{filename:e.filename}})]});try{x.displayName="FailedAttachment",x.__docgenInfo={description:"",displayName:"FailedAttachment",props:{failedAttachment:{defaultValue:null,description:"",name:"failedAttachment",required:!0,type:{name:"Attachment"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"(file: Attachment) => void"}}}}}catch{}const K=e=>{const{failedAttachments:n,onDelete:a}=e;return t.jsx(t.Fragment,{children:n.length>0&&t.jsx(L,{gap:"2",children:n.map(s=>t.jsx(l.Fragment,{children:t.jsx(x,{failedAttachment:s,onDelete:a})},X()))})})};try{K.displayName="FailedAttachmentList",K.__docgenInfo={description:"",displayName:"FailedAttachmentList",props:{failedAttachments:{defaultValue:null,description:"",name:"failedAttachments",required:!0,type:{name:"Attachment[]"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"(file: Attachment) => void"}}}}}catch{}const C=[".pdf",".jpeg",".jpg",".png"],me=16777,Ie=.0009765625,Ae=(e,n,a)=>{const s=pe(e,n,a);return s.pending=!0,s},fe=e=>{const n=e.split(".").pop();return n?C.includes(`.${n.toLowerCase()}`):!1},ge=e=>e*Ie<=me,_e=async(e,n)=>{var a;if(!fe(e.file.name)){e.pending=!1,e.error=d.VALID_EXTENSION;return}if(!ge(e.filesize)){e.pending=!1,e.error=d.MAX_SIZE;return}try{const s=await n(e);e.pending=!1,e.url=s.headers.location,e.uploaded=!0,e.uuid=s.data}catch(s){e.pending=!1,((a=s==null?void 0:s.response)==null?void 0:a.status)===408?e.error=d.TIMEOUT:e.error=d.GENERAL}},Se=[],D=({existingAttachments:e=Se,updateAttachments:n,attachmentType:a,skjemanummer:s,saveAttachment:i,multiple:O=!0})=>{const[r,E]=l.useState(e);l.useEffect(()=>{n(r.filter(o=>!o.error&&o.pending===!1))},[r]);const u=l.useCallback(o=>{const R=async I=>{for(const _ of I)await _e(_,i),E(N=>N.map(S=>S.filename===_.filename?_:S))},m=o.map(I=>Ae(I,a,s));E(I=>I.filter(N=>!m.some(S=>S.filename===N.filename)).concat(m)),R(m)},[a,s,i]),g=l.useCallback(o=>{E(R=>R.filter(m=>m.filename!==o.filename))},[]),j=l.useMemo(()=>r.filter(o=>!o.error),[r]),Y=l.useMemo(()=>r.filter(o=>!!o.error),[r]);return t.jsx(re,{children:t.jsxs(L,{gap:"6",children:[t.jsx(y,{attachments:j,showFileSize:!0,onDelete:g}),t.jsx(F,{accept:C.join(", "),onFilesSelect:u,hasUplodedAttachements:j.length>0,multiple:O}),t.jsx(K,{failedAttachments:Y,onDelete:g})]})})},$=D;try{D.displayName="FileUploader",D.__docgenInfo={description:"",displayName:"FileUploader",props:{updateAttachments:{defaultValue:null,description:"",name:"updateAttachments",required:!0,type:{name:"(attachments: Attachment[]) => void"}},attachmentType:{defaultValue:null,description:"",name:"attachmentType",required:!0,type:{name:"enum",value:[{value:'"omsorgsovertakelse"'},{value:'"adopsjonsvedtak"'},{value:'"terminbekreftelse"'},{value:'"fødselsattest"'},{value:'"anneninntektDokumentasjon"'},{value:'"utsettelseSykdomUttaksplan"'},{value:'"morsaktivitetdokumentasjon"'},{value:'"dokumentasjonOverføringAvKvote"'},{value:'"dokumentasjonAvAleneomsorg"'},{value:'"senEndring"'},{value:'"hvØvelse"'},{value:'"navTiltak"'},{value:'"tilbakebetaling"'}]}},skjemanummer:{defaultValue:null,description:"",name:"skjemanummer",required:!0,type:{name:"enum",value:[{value:'"I000060"'},{value:'"I000062"'},{value:'"I000042"'},{value:'"I000051"'},{value:'"I000065"'},{value:'"I000061"'},{value:'"I000036"'},{value:'"I000110"'},{value:'"I000111"'},{value:'"I000112"'},{value:'"I000037"'},{value:'"I000039"'},{value:'"I000038"'},{value:'"I000023"'},{value:'"I000044"'},{value:'"I000063"'},{value:'"I000007"'},{value:'"I000109"'},{value:'"I000114"'},{value:'"I000116"'},{value:'"I000117"'},{value:'"I000032"'},{value:'"I000066"'}]}},existingAttachments:{defaultValue:{value:"[] as Attachment[]"},description:"",name:"existingAttachments",required:!1,type:{name:"Attachment[]"}},saveAttachment:{defaultValue:null,description:"",name:"saveAttachment",required:!0,type:{name:"SaveAttachment"}},multiple:{defaultValue:{value:"true"},description:"",name:"multiple",required:!1,type:{name:"boolean"}}}}}catch{}const De={title:"FileUploader",component:$},M=({saveAttachment:e,existingAttachments:n})=>t.jsx($,{attachmentType:v.OMSORGSOVERTAKELSE,skjemanummer:T.OMSORGSOVERTAKELSE,saveAttachment:e,existingAttachments:n,updateAttachments:()=>{}}),A=M.bind({});A.args={existingAttachments:[{id:"1",filename:"Dette er en fil som er lastet opp.jpg",filesize:234,file:{},pending:!1,uploaded:!0,type:v.TERMINBEKREFTELSE,skjemanummer:T.TERMINBEKREFTELSE},{id:"2",filename:"Dette er en fil som holder på å bli lastet opp.jpg",filesize:2344,file:{},pending:!0,uploaded:!1,type:v.TERMINBEKREFTELSE,skjemanummer:T.TERMINBEKREFTELSE}]};const f=M.bind({});f.args={saveAttachment:()=>Promise.resolve({headers:{location:""},data:"test"})};const h=M.bind({});var G,k,b;A.parameters={...A.parameters,docs:{...(G=A.parameters)==null?void 0:G.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />;
}`,...(b=(k=A.parameters)==null?void 0:k.docs)==null?void 0:b.source}}};var U,B,q;f.parameters={...f.parameters,docs:{...(U=f.parameters)==null?void 0:U.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />;
}`,...(q=(B=f.parameters)==null?void 0:B.docs)==null?void 0:q.source}}};var P,z,w;h.parameters={...h.parameters,docs:{...(P=h.parameters)==null?void 0:P.docs,source:{originalSource:`({
  saveAttachment,
  existingAttachments
}) => {
  return <FileUploader attachmentType={AttachmentType.OMSORGSOVERTAKELSE} skjemanummer={Skjemanummer.OMSORGSOVERTAKELSE} saveAttachment={saveAttachment} existingAttachments={existingAttachments} updateAttachments={() => undefined} />;
}`,...(w=(z=h.parameters)==null?void 0:z.docs)==null?void 0:w.source}}};const Me=["VisEksisterendeVedlegg","OpplastingOk","OpplastingFeiler"];export{h as OpplastingFeiler,f as OpplastingOk,A as VisEksisterendeVedlegg,Me as __namedExportsOrder,De as default};
//# sourceMappingURL=FileUploader.stories-5949e83c.js.map
