import{j as u}from"./jsx-runtime-CLpGMVip.js";import{g as N,T as E,d as f,e as c,i as g,f as I,h as _,j as m,n as M,u as q,b as C}from"./TidsperiodeSpørsmål-DUTmoS6G.js";import{r as j}from"./index-CR__hKHy.js";import{i as F,a as P,b as k,f as v,g as x,c as O,d as H,e as S,h as B,A as $,P as y}from"./PeriodeListeItem-ClXllo37.js";const h=t=>({setStartdato:e=>K(t,e),setUttaksdager:e=>{const r=N(t.fom,e);t.fom=r.fom,t.tom=r.tom},getAntallUttaksdager:()=>E({fom:t.fom,tom:t.tom}).getAntallUttaksdager(),erLik:(e,r=!1,n=!1)=>J(t,e,r,n),erSammenhengende:e=>G(t,e),starterFør:e=>f(t.fom).isBefore(e,"day"),slutterEtter:e=>f(t.tom).isAfter(e,"day"),slutterSammeDagEllerEtter:e=>f(t.tom).isSameOrAfter(e,"day")});function G(t,e){const r=c(t.tom).neste(),n=e.fom;return f(r).isSame(n,"day")}function J(t,e,r=!1,n=!1){if(n===!1&&(F(t)||F(e)))return!1;if(P(t)&&P(e))return!0;if(k(t)&&k(e)){const o=U({...t,skalIkkeHaUttakFørTermin:t.skalIkkeHaUttakFørTermin||!1},r),a=U({...e,skalIkkeHaUttakFørTermin:e.skalIkkeHaUttakFørTermin||!1},r);return o===a}const s=U(t,r),i=U(e,r);return s===i}function U(t,e=!1){const{fom:r,tom:n,id:s,...i}=t,o={};return Object.keys(i).sort((a,d)=>a.localeCompare(d)).filter(a=>i[a]!==void 0).forEach(a=>{o[a]=i[a]}),e&&(o.fom=r?v(r):void 0,o.tom=n?v(n):void 0),JSON.stringify({...o})}function K(t,e){const r=E({fom:t.fom,tom:t.tom}).setStartdato(e);return{...t,fom:r.fom,tom:r.tom}}const R=t=>({getPeriode:e=>V(t,e),getOpphold:()=>Z(t),getUttak:()=>z(t),getOverføringer:()=>W(t),getHull:()=>X(t),getHullOgInfoOgPerioderUtenUttak:()=>Y(t),getUtsettelser:()=>Q(t),getPerioderEtterFamiliehendelsesdato:e=>b(t,e),getPerioderFørFamiliehendelsesdato:e=>ie(t,e),getPerioderMedUgyldigTidsperiode:()=>ae(t),getFørstePerioderEtterFamiliehendelsesdato:e=>fe(t,e),getForeldrepengerFørTermin:()=>ue(t),getFørsteUttaksdag:()=>de(t),getFørsteUttaksdagEtterSistePeriode:()=>ge(t),getFørsteUttaksdagEksluderInfoperioderOgFrittUttak:()=>me(t),getAntallUttaksdager:()=>le(t),finnOverlappendePerioder:e=>p(t,e),finnPeriodeMedDato:e=>ee(t,e),finnFørstePeriodeEtterDato:e=>te(t,e),finnAlleForegåendePerioder:e=>D(t,e),finnAllePåfølgendePerioder:e=>L(t,e),finnDenForegåendePerioden:e=>re(t,e),finnPåfølgendePeriode:e=>ne(t,e),forskyvPerioder:e=>oe(t,e),sort:()=>[...t].sort(T)});function T(t,e){const r=x(t),n=x(e);return g(r)===!1||g(n)===!1?k(t)&&t.skalIkkeHaUttakFørTermin?-1:g(r)?1:-1:E(n).erOmsluttetAv(r)?1:f(r.fom).isBefore(n.fom,"day")?-1:1}function V(t,e){return t.find(r=>r.id===e)}function z(t){return t.filter(e=>O(e))}function Q(t){return t.filter(e=>F(e))}function W(t){return t.filter(e=>H(e))}function X(t){return t.filter(e=>P(e))}function Y(t){return t.filter(e=>P(e)||S(e))}function Z(t){return t.filter(e=>B(e))}function p(t,e){return t.filter(r=>{if(r.id===e.id||!g({fom:e.fom,tom:e.tom}))return!1;const{fom:n,tom:s}=r;if(!n||!s)return!1;const i=I(n,{fom:e.fom,tom:e.tom})||I(s,{fom:e.fom,tom:e.tom}),o=f(e.fom).isSameOrAfter(n,"day")&&f(e.tom).isSameOrBefore(s,"day");return i||o})}function ee(t,e){return t.find(r=>f(e).isBetween(r.fom,r.tom,"day","[]"))}function te(t,e){return t.find(r=>f(r.fom).isAfter(e,"day"))}function D(t,e){return t.filter(r=>f(r.tom).isBefore(e.fom,"day"))}function L(t,e){return t.filter(r=>f(r.fom).isAfter(e.tom,"day"))}function re(t,e){const r=D(t,e);if(r.length>0)return r.pop()}function ne(t,e){const r=L(t,e);if(r.length>0)return r[0]}function oe(t,e){let r=e;return t.reduce((n,s)=>{if(F(s)){n.push(s);const i=h(s).getAntallUttaksdager();return i>=r?r=0:r-=i,n}if(P(s)||S(s)){const i=h(s).getAntallUttaksdager();if(i>r){const o=c(c(s.fom).denneEllerNeste()).leggTil(r),a={...s,fom:o,tom:s.tom};return r=0,n.push(a),n}else return i===r?(r=0,n):(r-=i,n)}return n.push(se(s,r)),n},[])}function se(t,e){if(e===0)return t;const r=c(c(t.fom).denneEllerNeste()).leggTil(e);return h(t).setStartdato(r)}function ie(t,e){return t.filter(r=>k(r)||g({fom:r.fom,tom:r.tom})&&f(r.fom).isBefore(e,"day"))}function b(t,e){return t.filter(r=>g({fom:r.fom,tom:r.tom})&&f(r.fom).isSameOrAfter(e,"day")&&k(r)===!1)}function fe(t,e){const r=b(t,e).sort(T);return r.length>0?r[0]:void 0}function ae(t){return t.filter(e=>g({fom:e.fom,tom:e.tom})===!1&&k(e)===!1)}function de(t){const e=t.filter(r=>r.fom!==void 0).sort(T).shift();if(e)return e.fom}function me(t){const e=t.filter(r=>r.fom!==void 0&&!S(r)).sort(T).shift();if(e)return e.fom}function le(t){return t.reduce((e,r)=>e+h(r).getAntallUttaksdager(),0)}function ue(t){return t.find(r=>O(r)&&r.kontoType===_.ForeldrepengerFørFødsel)}function ge(t){if(t.length!==0)return c(t[t.length-1].tom).neste()}const ce=(t,e,r)=>!e||!t?!1:!!(f(t.tidsperiode.tom).isBefore(r)&&f(e.tom).isBefore(r)),Pe=(t,e,r)=>!e||!t?!1:!!(f(t.tidsperiode.fom).isSameOrAfter(r)&&f(e.fom).isSameOrAfter(r)),ke=(t,e,r)=>Pe(t,e,r)||ce(t,e,r),Fe=(t,e)=>{const r=[];if(t.length===0)return r;let n,s,i=!1;return t.forEach((o,a)=>{const d=a+1;let l;if(i){i=!1;return}d<t.length?l=t[d]:l=void 0;const w=ke(n,o,e);if(l!==void 0&&(i=E({fom:o.fom,tom:o.tom}).erLik({fom:l.fom,tom:l.tom})),i&&l!==void 0){n={perioder:[{...o},{...l}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},samtidigUttak:!0},r.push(n),n=void 0,s=void 0,i=!0;return}if(O(o)||H(o)||B(o)){const A=o.forelder;n?s===o.forelder&&w?(n.perioder=[...n.perioder,{...o}],n.tidsperiode.tom=m(o.tom)):n={forelder:A,perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)}}:n={forelder:A,perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},samtidigUttak:!!o.samtidigUttak},r.includes(n)||r.push(n),s=o.forelder;return}S(o)&&(n={perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},erPeriodeUtenUttak:!0},r.push(n),s=void 0,n=void 0),F(o)&&(n={perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},erUtsettelse:!0},r.push(n),s=void 0,n=void 0),P(o)&&(n={perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},erHull:!0},r.push(n),s=void 0,n=void 0)}),r},ye=(t,e)=>t.findIndex(r=>g(r.tidsperiode)&&f(r.tidsperiode.fom).isSameOrAfter(e,"d")),Ue=({perioder:t,handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n})=>{const s=M(q(C.FAMILIEHENDELSEDATO)),i=Fe(t,s),o=ye(i,s),a=R(t).getPerioderEtterFamiliehendelsesdato(s);return u.jsx("div",{children:u.jsx($,{children:i.map((d,l)=>a.length===0?u.jsxs(j.Fragment,{children:[u.jsx(y,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d}),i.length-1===l?u.jsx(y,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d,erFamiliehendelse:!0}):null]},`${d.tidsperiode.fom}-${d.tidsperiode.tom}`):u.jsxs(j.Fragment,{children:[o===l?u.jsx(y,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d,erFamiliehendelse:!0}):null,u.jsx(y,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d})]},`${d.tidsperiode.fom}-${d.tidsperiode.tom}`))})})};Ue.__docgenInfo={description:"",methods:[],displayName:"PeriodeListe",props:{perioder:{required:!0,tsType:{name:"Array",elements:[{name:"Planperiode"}],raw:"Planperiode[]"},description:""},handleUpdatePeriode:{required:!0,tsType:{name:"signature",type:"function",raw:"(oppdatertPeriode: Planperiode) => void",signature:{arguments:[{type:{name:"Planperiode"},name:"oppdatertPeriode"}],return:{name:"void"}}},description:""},handleDeletePeriode:{required:!0,tsType:{name:"signature",type:"function",raw:"(slettetPeriode: Planperiode) => void",signature:{arguments:[{type:{name:"Planperiode"},name:"slettetPeriode"}],return:{name:"void"}}},description:""},handleDeletePerioder:{required:!0,tsType:{name:"signature",type:"function",raw:"(slettedePerioder: Planperiode[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"Planperiode"}],raw:"Planperiode[]"},name:"slettedePerioder"}],return:{name:"void"}}},description:""}}};export{Ue as P};
