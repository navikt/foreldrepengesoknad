import{j as f,T as h,x as N,U as c,y as g,z as A,A as m,l as u,r as I}from"./iframe-vW1I2eor.js";import{e as _,n as M,u as q,b as C}from"./TidsperiodeSpørsmål-DL90sw9M.js";import{i as F,a as P,b as k,f as j,c as E,d as T,e as H,h as B,j as x,A as $,P as v}from"./PeriodeListeItem-Cw8I-2hB.js";const U=t=>({setStartdato:e=>J(t,e),setUttaksdager:e=>{const r=N(t.fom,e);t.fom=r.fom,t.tom=r.tom},getAntallUttaksdager:()=>h({fom:t.fom,tom:t.tom}).getAntallUttaksdager(),erLik:(e,r=!1,n=!1)=>G(t,e,r,n),erSammenhengende:e=>z(t,e),starterFør:e=>f(t.fom).isBefore(e,"day"),slutterEtter:e=>f(t.tom).isAfter(e,"day"),slutterSammeDagEllerEtter:e=>f(t.tom).isSameOrAfter(e,"day")});function z(t,e){const r=c(t.tom).neste(),n=e.fom;return f(r).isSame(n,"day")}function G(t,e,r=!1,n=!1){if(n===!1&&(F(t)||F(e)))return!1;if(P(t)&&P(e))return!0;if(k(t)&&k(e)){const o=y({...t,skalIkkeHaUttakFørTermin:t.skalIkkeHaUttakFørTermin||!1},r),a=y({...e,skalIkkeHaUttakFørTermin:e.skalIkkeHaUttakFørTermin||!1},r);return o===a}const s=y(t,r),i=y(e,r);return s===i}function y(t,e=!1){const{fom:r,tom:n,id:s,...i}=t,o={};return Object.keys(i).sort((a,d)=>a.localeCompare(d)).filter(a=>i[a]!==void 0).forEach(a=>{o[a]=i[a]}),e&&(o.fom=r?j(r):void 0,o.tom=n?j(n):void 0),JSON.stringify({...o})}function J(t,e){const r=h({fom:t.fom,tom:t.tom}).setStartdato(e);return{...t,fom:r.fom,tom:r.tom}}const K=t=>({getPeriode:e=>R(t,e),getOpphold:()=>Z(t),getUttak:()=>V(t),getOverføringer:()=>W(t),getHull:()=>X(t),getHullOgInfoOgPerioderUtenUttak:()=>Y(t),getUtsettelser:()=>Q(t),getPerioderEtterFamiliehendelsesdato:e=>b(t,e),getPerioderFørFamiliehendelsesdato:e=>ie(t,e),getPerioderMedUgyldigTidsperiode:()=>ae(t),getFørstePerioderEtterFamiliehendelsesdato:e=>fe(t,e),getForeldrepengerFørTermin:()=>ue(t),getFørsteUttaksdag:()=>de(t),getFørsteUttaksdagEtterSistePeriode:()=>ge(t),getFørsteUttaksdagEksluderInfoperioderOgFrittUttak:()=>me(t),getAntallUttaksdager:()=>le(t),finnOverlappendePerioder:e=>p(t,e),finnPeriodeMedDato:e=>ee(t,e),finnFørstePeriodeEtterDato:e=>te(t,e),finnAlleForegåendePerioder:e=>D(t,e),finnAllePåfølgendePerioder:e=>L(t,e),finnDenForegåendePerioden:e=>re(t,e),finnPåfølgendePeriode:e=>ne(t,e),forskyvPerioder:e=>oe(t,e),sort:()=>[...t].sort(S)});function S(t,e){const r=x(t),n=x(e);return g(r)===!1||g(n)===!1?k(t)&&t.skalIkkeHaUttakFørTermin?-1:g(r)?1:-1:h(n).erOmsluttetAv(r)?1:f(r.fom).isBefore(n.fom,"day")?-1:1}function R(t,e){return t.find(r=>r.id===e)}function V(t){return t.filter(e=>T(e))}function Q(t){return t.filter(e=>F(e))}function W(t){return t.filter(e=>H(e))}function X(t){return t.filter(e=>P(e))}function Y(t){return t.filter(e=>P(e)||E(e))}function Z(t){return t.filter(e=>B(e))}function p(t,e){return t.filter(r=>{if(r.id===e.id||!g({fom:e.fom,tom:e.tom}))return!1;const{fom:n,tom:s}=r;if(!n||!s)return!1;const i=A(n,{fom:e.fom,tom:e.tom})||A(s,{fom:e.fom,tom:e.tom}),o=f(e.fom).isSameOrAfter(n,"day")&&f(e.tom).isSameOrBefore(s,"day");return i||o})}function ee(t,e){return t.find(r=>f(e).isBetween(r.fom,r.tom,"day","[]"))}function te(t,e){return t.find(r=>f(r.fom).isAfter(e,"day"))}function D(t,e){return t.filter(r=>f(r.tom).isBefore(e.fom,"day"))}function L(t,e){return t.filter(r=>f(r.fom).isAfter(e.tom,"day"))}function re(t,e){const r=D(t,e);if(r.length>0)return r.pop()}function ne(t,e){const r=L(t,e);if(r.length>0)return r[0]}function oe(t,e){let r=e;return t.reduce((n,s)=>{if(F(s)){n.push(s);const i=U(s).getAntallUttaksdager();return i>=r?r=0:r-=i,n}if(P(s)||E(s)){const i=U(s).getAntallUttaksdager();if(i>r){const o=c(c(s.fom).denneEllerNeste()).leggTil(r),a={...s,fom:o,tom:s.tom};return r=0,n.push(a),n}else return i===r?(r=0,n):(r-=i,n)}return n.push(se(s,r)),n},[])}function se(t,e){if(e===0)return t;const r=c(c(t.fom).denneEllerNeste()).leggTil(e);return U(t).setStartdato(r)}function ie(t,e){return t.filter(r=>k(r)||g({fom:r.fom,tom:r.tom})&&f(r.fom).isBefore(e,"day"))}function b(t,e){return t.filter(r=>g({fom:r.fom,tom:r.tom})&&f(r.fom).isSameOrAfter(e,"day")&&k(r)===!1)}function fe(t,e){const r=b(t,e).sort(S);return r.length>0?r[0]:void 0}function ae(t){return t.filter(e=>g({fom:e.fom,tom:e.tom})===!1&&k(e)===!1)}function de(t){const e=t.filter(r=>r.fom!==void 0).sort(S).shift();if(e)return e.fom}function me(t){const e=t.filter(r=>r.fom!==void 0&&!E(r)).sort(S).shift();if(e)return e.fom}function le(t){return t.reduce((e,r)=>e+U(r).getAntallUttaksdager(),0)}function ue(t){return t.find(r=>T(r)&&r.kontoType===_.ForeldrepengerFørFødsel)}function ge(t){if(t.length!==0)return c(t[t.length-1].tom).neste()}const ce=(t,e,r)=>!e||!t?!1:!!(f(t.tidsperiode.tom).isBefore(r)&&f(e.tom).isBefore(r)),Pe=(t,e,r)=>!e||!t?!1:!!(f(t.tidsperiode.fom).isSameOrAfter(r)&&f(e.fom).isSameOrAfter(r)),ke=(t,e,r)=>Pe(t,e,r)||ce(t,e,r),Fe=(t,e)=>{const r=[];if(t.length===0)return r;let n,s,i=!1;return t.forEach((o,a)=>{const d=a+1;let l;if(i){i=!1;return}d<t.length?l=t[d]:l=void 0;const w=ke(n,o,e);if(l!==void 0&&(i=h({fom:o.fom,tom:o.tom}).erLik({fom:l.fom,tom:l.tom})),i&&l!==void 0){n={perioder:[{...o},{...l}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},samtidigUttak:!0},r.push(n),n=void 0,s=void 0,i=!0;return}if(T(o)||H(o)||B(o)){const O=o.forelder;n?s===o.forelder&&w?(n.perioder=[...n.perioder,{...o}],n.tidsperiode.tom=m(o.tom)):n={forelder:O,perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)}}:n={forelder:O,perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},samtidigUttak:!!o.samtidigUttak},r.includes(n)||r.push(n),s=o.forelder;return}E(o)&&(n={perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},erPeriodeUtenUttak:!0},r.push(n),s=void 0,n=void 0),F(o)&&(n={perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},erUtsettelse:!0},r.push(n),s=void 0,n=void 0),P(o)&&(n={perioder:[{...o}],tidsperiode:{fom:m(o.fom),tom:m(o.tom)},erHull:!0},r.push(n),s=void 0,n=void 0)}),r},ve=(t,e)=>t.findIndex(r=>g(r.tidsperiode)&&f(r.tidsperiode.fom).isSameOrAfter(e,"d")),ye=({perioder:t,handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n})=>{const s=M(q(C.FAMILIEHENDELSEDATO)),i=Fe(t,s),o=ve(i,s),a=K(t).getPerioderEtterFamiliehendelsesdato(s);return u.jsx("div",{children:u.jsx($,{children:i.map((d,l)=>a.length===0?u.jsxs(I.Fragment,{children:[u.jsx(v,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d}),i.length-1===l?u.jsx(v,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d,erFamiliehendelse:!0}):null]},`${d.tidsperiode.fom}-${d.tidsperiode.tom}`):u.jsxs(I.Fragment,{children:[o===l?u.jsx(v,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d,erFamiliehendelse:!0}):null,u.jsx(v,{handleUpdatePeriode:e,handleDeletePeriode:r,handleDeletePerioder:n,permisjonsperiode:d})]},`${d.tidsperiode.fom}-${d.tidsperiode.tom}`))})})};ye.__docgenInfo={description:"",methods:[],displayName:"PeriodeListe",props:{perioder:{required:!0,tsType:{name:"Array",elements:[{name:"Planperiode"}],raw:"Planperiode[]"},description:""},handleUpdatePeriode:{required:!0,tsType:{name:"signature",type:"function",raw:"(oppdatertPeriode: Planperiode) => void",signature:{arguments:[{type:{name:"Planperiode"},name:"oppdatertPeriode"}],return:{name:"void"}}},description:""},handleDeletePeriode:{required:!0,tsType:{name:"signature",type:"function",raw:"(slettetPeriode: Planperiode) => void",signature:{arguments:[{type:{name:"Planperiode"},name:"slettetPeriode"}],return:{name:"void"}}},description:""},handleDeletePerioder:{required:!0,tsType:{name:"signature",type:"function",raw:"(slettedePerioder: Planperiode[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"Planperiode"}],raw:"Planperiode[]"},name:"slettedePerioder"}],return:{name:"void"}}},description:""}}};export{ye as P};
